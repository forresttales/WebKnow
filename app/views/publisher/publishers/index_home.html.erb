<% provide(:title, 'My Activity') %>

	

			<div class="jqmWindow jqmWindow-1001" id="dialog_1001">
		   		<div class="table-dl-form-1001">
		   			<div class="row">
		   				<div class="cell-100percent">
		   					<div id="close_form1001" class="form-edit-close jqmClose tip-left-center" tabindex="">
		   						<img src="/assets/images/global/x_close_white_w20_h20.png" alt="X" height="20px">
		   					</div>
			                <div class="tip-content">
			                    <div class="tooltiptext">Close</div>
			                </div>																															   					
		   					<div style="clear: both;"></div>
		   				</div>
   					</div>
				</div>				   				
				<div style="width: 100%; text-align: center;">
					<div style="height: 20px;"></div>
					<div id="dialog_1001_content_container" class="">
						<figure id="profile_figure_dialog_1001" class="dialog-user-image">
							<img alt="" src="" />
						</figure>
					</div>
					<div style="height: 50px;"></div>
				</div>
			</div>

			<div class="jqmWindow jqmWindow-101" id="dialog_101">
		   		<div class="table-dl-form-101">
		   			<div class="row">
		   				<div class="cell-100percent">
		   					<div id="close_form101" class="form-edit-close jqmClose tip-left-center" tabindex="">
		   						<img src="/assets/images/global/x_close_white_w20_h20.png" alt="X" height="20px">
		   					</div>
			                <div class="tip-content">
			                    <div class="tooltiptext">Close</div>
			                </div>																															   					
		   					<div style="clear: both;"></div>
		   				</div>
   					</div>
				</div>				   				
				<div style="width: 100%; text-align: center;">
					<div style="height: 20px;"></div>
					<div id="dialog_101_content_container" class="">
						<!-- <figure id="profile_figure_dialog_101" class="dialog-user-image">
							<img alt="" src="" />
						</figure> -->
					</div>
				</div>
			</div>

	
				<!-- logo image - delete 24 -->
			<div class="jqmWindow jqmWindow-104" id="dialog_104">
				<div class="dialog-topbar-1" style="margin-top:0px;">
					<div style="height: 63px; width: 60px; float: left; position: absolute;">
						<img src="../assets_knowstory/knowstory-icon-2-w60-h63.png">
					</div>
					<!-- text goes here -->
   					<div id="close_form104" class="form-edit-close jqmClose tip-left-center" style="height: 20px; width: 20px; float: right;">
   						<img src="/assets/images/global/x_close_w20_h20.png" alt="X" height="20px">
   					</div>
	                <div class="tip-content">
	                    <div class="tooltiptext">Close</div>
	                </div>																															   					   					
   					<div style="clear: both;"></div>
				</div>
				<!-- <div style="height: 20px;"></div> -->
				<div class="background-table-dialog-1">
			   		<div class="table-dialog-1">
						<div class="dialog-msg-container">
							<span>Delete this post?</span>
						</div>
	   				</div>
   				</div>
   				<div style="height: 16px;"></div>
   				<div class="table-dialog-1">
		   			<div class="row">
		   				<div class="cell-100percent" style="text-align: center;">
							<span><input id="btn_dlg_submit_delete_post" class="btn-pop-dialog" type="button" value="Delete" tabindex=""></span>
							&nbsp;&nbsp;&nbsp;&nbsp;
							<span><input id="btn_dlg_cancel_delete_post" class="btn-pop-dialog" type="button" value="Cancel" tabindex=""></span>
		   				</div>
   					</div>
				</div>														   				
				<div style="height: 20px;"></div>
			</div>


			<div class="jqmWindow jqmWindow-105" id="dialog_105">
				<div class="dialog-topbar-1" style="margin-top:0px;">
					<div style="height: 63px; width: 60px; float: left; position: absolute;">
						<img src="../assets_knowstory/knowstory-icon-2-w60-h63.png">
					</div>
					<!-- text goes here -->
   					<div id="close_form105" class="form-edit-close jqmClose tip-left-center" style="height: 20px; width: 20px; float: right;">
   						<img src="/assets/images/global/x_close_w20_h20.png" alt="X" height="20px">
   					</div>
	                <div class="tip-content">
	                    <div class="tooltiptext">Close</div>
	                </div>																															   					   					
   					<div style="clear: both;"></div>
				</div>
				<!-- <div style="height: 20px;"></div> -->
				<div class="background-table-dialog-1">
			   		<div class="table-dialog-1">
						<div class="dialog-msg-container">
							<span>Delete this comment?</span>
						</div>
	   				</div>
   				</div>
   				<div style="height: 16px;"></div>
   				<div class="table-dialog-1">
		   			<div class="row">
		   				<div class="cell-100percent" style="text-align: center;">
							<span><input id="btn_dlg_submit_delete_comment" class="btn-pop-dialog" type="button" value="Delete" tabindex=""></span>
							&nbsp;&nbsp;&nbsp;&nbsp;
							<span><input id="btn_dlg_cancel_delete_comment" class="btn-pop-dialog" type="button" value="Cancel" tabindex=""></span>
		   				</div>
   					</div>
				</div>														   				
				<div style="height: 20px;"></div>
			</div>
	
<% if false %>	
<!-- user image - show 11 -->			
<div class="jqmWindow jqmWindow-11" id="dialog_11">
	<div class="table-dl-form-1">
		<div class="row">
			<div class="cell-100percent">
				<div id="close_form11" class="form-edit-close jqmClose tip-left-center" tabindex="">
					<img src="/assets/images/global/x_close_white_w20_h20.png" alt="X" height="20px">
				</div>
                <div class="tip-content">
                    <div class="tooltiptext">Close</div>
                </div>																															   					
				<div style="clear: both;"></div>
			</div>
		</div>
	</div>				   				
	<div style="width: 100%; text-align: center;">
		<div style="height: 20px;"></div>
		<div class="">
			<figure id="profile_figure_dialog_11" class="dialog-user-image">
				<img alt="" src="" />
			</figure>
		</div>
	</div>
</div>
<% end %>
			
<div class="jqmWindow jqmWindow-overlay" id="dialog_overlay">
	<div id="overlay_loading" class="overlay-loading display-none"></div>
</div>

<div class="jqmWindow jqmWindow-11" id="dialog_11">
	<div class="jqmClose ks-tip-container close-container">
		<div class="ks-tip-target">
			<%= image_tag('jqModal/close_btn_round_white_w60_h60.png', alt: 'X', class: 'x-close-60-60' ) %>
		</div>
	    <div class="ks-tip ks-tip-pos-left-dialog-11 ks-tip-text-dialog-11">
			Close
	    </div>				
	</div>
	<div style="clear: both;"></div>
	<div style="width: 600px; margin: 0 auto;">
		<div class="figure-container" style="width: 100%; background-color: #000;">
			<figure id="figure_dialog_11" class="dialog-user-image-2">
				<figcaption id="figcaption_dialog_11" class="expand-image">												
					<div class="img-2-container image">
						<% if !@publisher_logo_image_primary.nil? %>
						<a rel="gallery" title="" href="<%= @publisher_logo_image_primary.image_url() + '?' + (rand(10..90) * rand(100..900)).to_s if @publisher_logo_image_primary.image? %>">									
							<div id="img_2" class="img-2"></div>
						</a>
						<% end %>
					</div>
				</figcaption>
			</figure>
		</div>
		<div style="width: 100%; min-height: 100px; background-color: #fff;"></div>
	</div>
</div>



<div class="table-profile" style="height: 100%;">
	<div class="row-profile">
		<div class="profile-left-col">
			<div class="title-bar-profile-1 title">
				<div class="tbl-title-bar-profile">
					<div class="row-title-bar-profile">
						<div class="cell-title-bar-profile-left">
							<div style="position: relative;">
								<!-- <span id="span_user_name_first" class="profile-text-1"></span>
								&nbsp;&nbsp;
								<span id="span_user_name_last" class="profile-text-1"></span> -->
							</div>		
						</div>
						<div class="cell-title-bar-profile-center">
							<span></span>
						</div>
						<div class="cell-title-bar-profile-right">
							<div class="btn-opt-edit-container-outer">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>



<div class="table-profile" style="height: 100%;">
	<div class="row-profile">
		<div class="profile-left-col">

			<div class="table margin-0" style="height: 270px;">
				<div class="row" style="height: 260px;">
					<div class="cell-225" id="container_logo_image_primary" style="height: 260px; padding: 0 0 0 1px;">
						<div id="drop_container_logo_image_primary" class="drop">
							<div id="render_publisher_logo_image_primary">
								<%= render 'publishers/publisher_logo_image_primary' %>
					        </div>
						</div>
						<div class="follow-stats-container" style="margin: 0 0 0 10px;">
							<%= render 'publishers/stats' %>
						</div>
						<div style="height: 300px; background-color: #dedede;"></div>						
						
					</div>
					<div class="cell-750">

						<div class="post-column">

							<div class="table margin-0">
								<div class="row">
									<div class="cell-700">
										<span class="font-default-1">Share</span>
									</div>
								</div>
								<div class="row">
									<div class="cell-700">
										<div class="border-line-700"></div>
									</div>
								</div>								
							</div>

							<div class="table margin-0">
								<div class="row">
									<div class="cell-100percent">
										<div style="height: 10px;"></div>
										<div style="padding: 0 0 4px 98px; min-height: 64px;">
											<div style="height: 4px;"></div>
											<div class="edit-story-4 textarea-add-post-user-parent">
												
												<% if false %>
												<%= form_for PostUserComment.new, :url => create_post_user_comment_publisher_users_path(@post_user_comment_new), :html => {:multipart => true, :class => '', :id => 'new_post_user_comment'}, :remote => true do |f| %>
													<%= f.hidden_field :comment_text %>
													<%= f.hidden_field :post_user_id %>
												  	<%= f.submit :id =>'submit_post_user_comment_hidden', :class => 'btn-submit hidden toggle-comment', :value => '' %>
												<% end %>
												<% end %>
												
												<% if false %>
												<%= form_for PostUser.new, :url => create_post_user_publisher_users_path(@post_user_new), :html => {:multipart => true, :class => '', :id => 'new_post_user'}, :remote => true do |f| %>
													<%= f.hidden_field :post_text %>
												  	<%= f.submit :id => 'submit_story_4_hidden', :class => 'btn-submit hidden', :value => '' %>
												<% end %>
												<% end %>
												
												<div class="textarea-add-post-user-container toggle-post-user" tabindex="">
													<div id="render_post_publisher_image" class="render-post-user-image"></div>
													<div id="textarea_add_post_publisher" class="textarea-add-post-user toggle-post-user textarea-add-post-user-inactive" contenteditable="true" tabindex="101"><br></div>
												</div>
													
												<div class="btn-textarea-add-post-user-story-4-container hidden">
													<div style="height: 4px;"></div>
													<div id="drop_container_story_4_attach" class="drop float-left width-200">
														<!-- <#%= render 'publisher_users/post_user_attach_menu' %#> -->
														<%= render 'publishers/post_publisher_attach_menu' %>
				
														<%= form_for PostPublisherImage.new, :url => upload_post_publisher_image_publishers_path(@post_publisher_image_new), :html => {:multipart => true, :class => 'hidden', :id => 'new_post_publisher_image'}, :remote => true do |f| %>
														  <p><%= f.file_field :image, :id => 'new_post_publisher_image_image' %></p>
														  <!-- <#%= f.hidden_field :post_publisher_id, :val => nil %#> -->
														  <p><%= f.submit :id => 'btn_submit_post_publisher_image', :class => 'btn-submit hidden', :value => '' %></p>
														<% end %>
													</div>
													<!-- <div id="submit_story_4" class="btn-submit-story-2 float-right toggle-post-user" tabindex="103"> -->
													<div id="submit_story_4" class="btn-1 float-right toggle-post-user" tabindex="103">
														<!-- <div id="submit_story_4_text" class="submit-edit-story-4-text-2">Add</div> -->
														<div id="submit_story_4_text" class="">Add</div>
														<div id="submit_story_4_loader" class="submit-edit-story-4-loader hidden"></div>
													</div>
													<div class="float-right" style="display: inline-block; width: 6px; height: 1px"></div>
													<div id="cancel_story_4" class="btn-1 float-right toggle-post-user" tabindex="102">
														<div id="cancel_story_4_text" class="">Cancel</div>
														<div id="cancel_story_4_loader" class="submit-edit-story-4-loader hidden"></div>
													</div>
												</div>
												
											</div>
											<div style="clear: both;"></div>
										</div>
									</div>
								</div>
							</div>
							
							<div class="show-story-3">
								<div class="text-align-left">
									<div class="post-user-sub-container" id="sub_container">
										<!-- <div style="margin: 0;">													
											<div class="feed-header">
												<h1>Activity Feed:</h1>
											</div>
											<div id="im_top_sh" style="display: block;"></div>
										</div> -->
										<div id="render_story_4" style="height: auto;"></div>
									</div>
								</div>
							</div>
							
						</div>

					</div>	

					<div class="cell-225">
						<div style="height: 300px; background-color: #dedede;"></div>
					</div>					
					
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	// *****
	// full screen image gallery

	// $(function(){
	// $(window).load( function() {
	$(document).ready(function() {

		// $('.image img').fullscreenslides();
		$('.image div').fullscreenslides();

		var $container = $('#fullscreenSlideshowContainer');
		$container.bind("init", function() {
			$container.append('<div class="ui" id="fs-close">&times;</div>').append('<div class="ui" id="fs-loader">Loading...</div>');
			// .append('<div class="ui" id="fs-prev">&lt;</div>')
			// .append('<div class="ui" id="fs-next">&gt;</div>')
			// .append('<div class="ui" id="fs-caption"><span></span></div>');

			// $('#fs-prev').click(function(){
			// $container.trigger("prevSlide");
			// });
			// $('#fs-next').click(function(){
			// $container.trigger("nextSlide");
			// });
			$('#fs-close').click(function() {
				$container.trigger("close");
			});
		}).bind("startLoading", function() {
			$('#fs-loader').show();
		}).bind("stopLoading", function() {
			$('#fs-loader').hide();
		});
		// .bind("startOfSlide", function(event, slide) {
		// $('#fs-caption span').text(slide.title);
		// $('#fs-caption').show();
		// })
		// .bind("endOfSlide", function(event, slide) {
		// $('#fs-caption').hide();
		// });

	});

</script>

	<script type="text/javascript">
	
		var savedRange,isInFocus;
		function saveSelection()
		{
		    if(window.getSelection)//non IE Browsers
		    {
		        savedRange = window.getSelection().getRangeAt(0);
		    }
		    else if(document.selection)//IE
		    { 
		        savedRange = document.selection.createRange();  
		    } 
		}
		
		function restoreSelection()
		{
		    isInFocus = true;
		    document.getElementById("textarea_add_post_publisher").focus();
		    if (savedRange != null) {
		        if (window.getSelection)//non IE and there is already a selection
		        {
		            var s = window.getSelection();
		            if (s.rangeCount > 0) 
		                s.removeAllRanges();
		            s.addRange(savedRange);
		        }
		        else if (document.createRange)//non IE and no selection
		        {
		            window.getSelection().addRange(savedRange);
		        }
		        else if (document.selection)//IE
		        {
		            savedRange.select();
		        }
		    }
		}
		
		//this part onwards is only needed if you want to restore selection onclick
		var isInFocus = false;
		function onDivBlur()
		{
		    isInFocus = false;
		}
		
		function cancelEvent(e)
		{
		    if (isInFocus == false && savedRange != null) {
		        if (e && e.preventDefault) {
		            //alert("FF");
		            e.stopPropagation(); // DOM style (return false doesn't always work in FF)
		            e.preventDefault();
		        }
		        else {
		            window.event.cancelBubble = true;//IE stopPropagation
		        }
		        restoreSelection();
		        return false; // false = IE style
		    }
		}
		
		function insertTextAtCursor(text) {
		    var sel, range, html;
		    if (window.getSelection) {
		        sel = window.getSelection();
		        if (sel.getRangeAt && sel.rangeCount) {
		            range = sel.getRangeAt(0);
		            range.deleteContents();
		            range.insertNode( document.createTextNode(text) );
		            range.collapse(false);
		        }
		    } else if (document.selection && document.selection.createRange) {
		        document.selection.createRange().text = text;
		    }
		}			  	
			  	
		
	</script>		

	<script>

		// function set_control_required(cntrl, b) {
			// // alert('set_control_required');
			// var s_cntrl = "#required_" + cntrl;
			// if(b) {
				// $(s_cntrl).addClass("check-required").removeClass("display-none");	
			// }
			// else {
				// $(s_cntrl).removeClass("check-required").addClass("display-none");
			// }
		// }

		function set_control_span(cntrl, s, b) {
			var s_cntrl = "#span_" + cntrl;
			$(s_cntrl).html(s);
			if (b) {
				$(s_cntrl).removeClass("color-no-record").addClass("color-record");
			}
			else {
				$(s_cntrl).removeClass("color-record").addClass("color-no-record");				
			}
		}
	  
		function show_control(cntrl) {
			var s_edit = "#edit_" + cntrl;
			var s_show_open = "#show_" + cntrl + ", #open_edit_" + cntrl;		
    		$(s_edit).fadeOut(300, function(){
    			$(s_edit).addClass("hidden");
    			$(s_show_open).fadeIn(200).removeClass("hidden");
    			$(s_show_open).fadeIn(200).removeClass("hidden").removeClass("visibility-hidden");
    		});
		}

		function create_post_publisher_like(id, nlist) {
			// alert("create_post_publisher_like(post_publisher_id)");
			var formData = {post_publisher_id:id, n_list:nlist};
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publishers/create_post_publisher_like',			    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		function delete_post_publisher_like(id, nlist) {
			// alert("delete_post_publisher_like(post_publisher_id)");
			var formData = {post_publisher_id:id, n_list:nlist};
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publishers/destroy_post_publisher_like',			    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		function delete_post_publisher(id) {
			// alert("delete_post_publisher");
			var formData = {post_publisher_id:id};
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publishers/destroy_post_publisher',			    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		function cancel_post_publisher() {
			// alert("delete_post_publisher");
			// var formData = {post_publisher_id:id};
		  	$.ajax({
		    	type: 'POST',
		    	// data : formData,
		    	url: '/publishers/cancel_post_publisher',			    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		function cancel_post_publisher_on_close() {
			var w = $("#render_post_publisher_image").html();
			if ( !( (w == "<br>") || (w == "") ) ) {
				$.ajax({
					type: 'POST',
					url: '/publishers/cancel_post_publisher_on_close',			    	
					dataType: "script",
					async: false,
					beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))} // ,
				});
			}
		}

		function delete_post_publisher_comment() {
			// alert("delete_post_publisher_comment");
			var formData = { post_publisher_comment_id: post_publisher_comment_comment_id_delete, 
							 post_publisher_id: post_publisher_comment_post_publisher_id_delete
						   };
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publishers/destroy_post_publisher_comment',			    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		function reset_post_publisher_comment_delete() {
			post_publisher_comment_comment_id_delete = null;
			post_publisher_comment_post_publisher_id_delete = null;			
		}



		var a_comments = [];
		
		function edit_textarea_comment($t, $b) {
			// textarea_add_comment_<#%= post_publisher.id %#>
			// btn_add_comment_<#%= post_publisher.id %#>
			b_comments = [];
			var is_open = false;
			for ( i = 0; i < a_comments.length; i++ ) {
				var $t_held = a_comments[i][0];
				if ( $t.attr("id") == $t_held.attr("id") ) {
					is_open = true;
				}
				else {
					var $b_held = a_comments[i][1];
					var v = $t_held.html();
					if ((v == "<br>") || (v == "")) {
						$b_held.addClass("hidden");
						$t_held.removeClass("add-comment-container-active").addClass("add-comment-container-inactive");
						$t_held.html("<br>");
					}
					else {
						var b = [];
						b.push($t_held);
						b.push($b_held);
						b_comments.push(b);						
					}
				}
			}			
			var c = [];
			c.push($t);
			c.push($b);
			b_comments.push(c);					
			if (!is_open) {
				$t.removeClass("add-comment-container-inactive").addClass("add-comment-container-active");
				$b.removeClass("hidden");
			}
			a_comments = b_comments;
		}		

		function reset_textarea_comment() {
			b_comments = [];
			for ( i = 0; i < a_comments.length; i++ ) {
				$t = a_comments[i][0];
				$b = a_comments[i][1];
				var v = $t.html();
				if ((v == "<br>") || (v == "")) {
					$b.addClass("hidden");
					$t.removeClass("add-comment-container-active").addClass("add-comment-container-inactive");
					$t.html("<br>");
				}
				else {
					var b = [];
					b.push($t);
					b.push($b);
					b_comments.push(b);					
				}
			}
			a_comments = b_comments;
		}
		
		function reset_textarea_comment_callback( post_publisher_id ) {
			var t_id = "textarea_add_comment_" + post_publisher_id;
			b_comments = [];
			for ( i = 0; i < a_comments.length; i++ ) {
				var $t_held = a_comments[i][0];
				if ( !( t_id == $t_held.attr("id") ) ) {
					var b = [];
					var $b_held = a_comments[i][1];
					b.push($t_held);
					b.push($b_held);
					b_comments.push(b);					
				}
			}			
			a_comments = b_comments;
			var $t = $("#" + t_id);						
			var b_id = "#btn_add_comment_" + post_publisher_id;			
			var $b = $(b_id);
			$b.addClass("hidden");
			$t.removeClass("add-comment-container-active").addClass("add-comment-container-inactive");
			$t.html("<br>");
			$t.focus();
		}



		var b_edit_post_publisher = false;
		
		function edit_textarea_post_publisher() {
			b_edit_post_publisher = true;
			$("#textarea_add_post_publisher").removeClass("textarea-add-post-user-inactive").addClass("textarea-add-post-user-active");
			$(".btn-textarea-add-post-user-story-4-container").removeClass("hidden");
		}		
		function reset_textarea_post_publisher() {
			$("#render_post_publisher_image").html("");
			$("#textarea_add_post_publisher").html("<br>");
			$(".btn-textarea-add-post-user-story-4-container").addClass("hidden");
			$("#textarea_add_post_publisher").removeClass("textarea-add-post-user-active").addClass("textarea-add-post-user-inactive");
			// $("#textarea_add_post_publisher").focus();
			// if ($ttpost != null) {
				b_edit_post_publisher = false;
				// $bbpost.addClass("hidden");
				// $ttpost.removeClass("textarea-add-post-user-active").addClass("textarea-add-post-user-inactive");
				// $ttpost.html("<br>");
				// $ttpost.focus();
				// $ttpost = null;
				// $bbpost = null;				
			// }
		}
		
		
		
		// function getScrollPos() {
			// return $(window).scrollTop();	
		// }
		
		var id_image = null;
		var id_image_logo = null;
		// var gon_crop_x = gon.crop_x;
		// var gon_crop_y = gon.crop_y;
		// var gon_crop_w = gon.crop_w;
		// var gon_crop_h = gon.crop_h; 

		var publisher_slug = <%= @publisher.slug %>;

		var scroll_top = 0;

		var post_publisher_id_delete = null;

		var post_publisher_comment_comment_id_delete = null;
		var post_publisher_comment_post_publisher_id_delete = null;
		
		// var post_publisher_created_id = 0;
			  	




		var drop_story_4_attach_visible = false;
		var btn_1_drop_add_post_publisher_image_clicked = false;

		function drop_story_4_attach_show() {
			$("#drop_story_4_attach").addClass('drop');
			$("#container_drop_story_4_attach").removeClass('hidden');
			$("#drop_story_4_attach div div.dropdownContain div.dropOut").fadeIn(200, function() {
				$(this).css({ 
					'margin-top' : 10
				});
			});
			$("#caret_story_4_attach").removeClass("nav-caret-down").addClass("nav-caret-up");
			drop_story_4_attach_visible = true;			
		}	
		function drop_story_4_attach_hide() {
			// alert('drop_story_4_attach_hide');
			$("#drop_story_4_attach").removeClass('drop');
			$("#container_drop_story_4_attach").addClass('hidden');
			drop_story_4_attach_visible = false;			
			// $("#render_nav_avatar").removeClass("avatar-focus");
			// $("#nav_caret_container").removeClass("nav-caret-focus");
			$("#drop_story_4_attach div div.dropdownContain div.dropOut").css({
				'margin-top' : 0
			});
			$("#caret_story_4_attach").removeClass("nav-caret-up").addClass("nav-caret-down");
			
			if( btn_1_drop_add_post_publisher_image_clicked == true ) {
				btn_1_drop_add_post_publisher_image_clicked = false;
				// alert('btn_1_drop_add_post_publisher_image_clicked == true');
				$("form#new_post_publisher_image input#new_post_publisher_image_image").click();
			}
		}	
		function drop_toggle_story_4_attach() {
			if (drop_story_4_attach_visible) {
				drop_story_4_attach_hide();
			}
			else {
				drop_story_4_attach_show();
			}
		}	




			  	
		// $(window).load( function() {
		$(document).ready(function () {				


			set_control_span("name_company", gon.name_company, gon.b_name_company);
			set_control_span("tagline_logo", gon.tagline_logo, gon.b_tagline_logo);


			$(document).on("click", ".textarea-add-post-user", function() {
				if (!b_edit_post_publisher) {
					// $p = $(this).closest(".textarea-add-post-user-parent");
					// $b = $p.find(".btn-textarea-add-post-user-story-4-container"); // btn-textarea-add-post-user-story-4-container
					// edit_textarea_post_publisher($(this), $b);
					edit_textarea_post_publisher();
				}
			});
			$(document).on("keyup", ".textarea-add-post-user", function() {
				// var v = $(this).html();
				// var $p = $(this).parent();
				// var $q = $p.find(".render-post-user-image");
				// var w = $q.html();
				var v = $("#textarea_add_post_publisher").html();
				var w = $("#render_post_publisher_image").html();
				if ( ((v == "<br>") || (v == "")) && ((w == "<br>") || (w == "")) ) {
					reset_textarea_post_publisher();
				}
			});
			$(document).on("keydown", ".textarea-add-post-user", function() {
				if (!b_edit_post_publisher) {
					// $p = $(this).closest(".textarea-add-post-user-parent");
					// $b = $p.find(".btn-textarea-add-post-user-story-4-container");
					// edit_textarea_post_publisher($(this), $b);
					edit_textarea_post_publisher();					
				}
			});
			$(document).on('click', function(e) {
				var $t = $(e.target);
				var c = ":" + $t.attr("class") + ":";
				if ( (c !== ":undefined:") && (c !== ":btn-submit hidden:") ) {
					if ( !( ($t.hasClass("div-link")) || ($t.hasClass("toggle-post-user"))  || ($t.parents().hasClass("toggle-post-user") ) ) ) {
						var v = $("#textarea_add_post_publisher").html();
						var w = $("#render_post_publisher_image").html();
						if ( ((v == "<br>") || (v == "")) && ((w == "<br>") || (w == "")) ) {
							// alert("triggered by = " + c);
							reset_textarea_post_publisher();
						}
					}
				}
			});


			
			$(document).on("click", ".textarea-add-comment", function() {
				// if (!b_edit_comment) {
					$p = $(this).closest(".textarea-add-comment-parent");
					$b = $p.find(".btn-add-comment-story-4-container");
					edit_textarea_comment($(this), $b);
				// }
			});
			$(document).on("keyup", ".textarea-add-comment", function() {
				// var v = $(this).html();
				// if ((v == "<br>") || (v == "")) {
					reset_textarea_comment();
				// }
			});
			$(document).on("keydown", ".textarea-add-comment", function() {
				// if (!b_edit_comment) {
					$p = $(this).closest(".textarea-add-comment-parent");
					$b = $p.find(".btn-add-comment-story-4-container");
					edit_textarea_comment($(this), $b);					
				// }
			});
			$(document).on('click', function(e) {
				var $t = $(e.target);
				if (!$t.hasClass("toggle-comment")) {
					reset_textarea_comment();
				}
			});
			
			
			
			$(document).on("click", "#btn_dlg_submit_delete_post", function() {
				delete_post_publisher(post_publisher_id_delete);
			});
			$(document).on("click", "#btn_dlg_cancel_delete_post", function() {
				$("#close_form104").trigger('click');
			});
			$(document).on("click", ".post-user-delete", function() {
				post_publisher_id_delete = $(this).find(".post-user-id").attr("name");				
				// $("#dialog_104").jqmShow();
				$(document).trigger('click_104');
				$("#btn_dlg_cancel_delete_post").focus();
			});			


			$(document).on("click", "#btn_dlg_submit_delete_comment", function() {
				// var o_target = $(e.target).parents('.nav-drop-1').attr('id');
				delete_post_publisher_comment();
			});
			$(document).on("click", "#btn_dlg_cancel_delete_comment", function() {
				$("#close_form105").trigger('click');
			});
			$(document).on("click", ".post-user-comment-delete", function() {
				post_publisher_comment_comment_id_delete = $(this).find(".comment-id").attr("name");
				post_publisher_comment_post_publisher_id_delete = $(this).find(".post-user-id").attr("name");
				// $("#dialog_104").jqmShow();
				$(document).trigger('click_105');
				$("#btn_dlg_cancel_delete_comment").focus();
			});			



			document.body.setAttribute('spellcheck', false);
			
			// onblur="onDivBlur();" 
			// onmousedown="return cancelEvent(event);" 
			// onclick="return cancelEvent(event);" 
			// contentEditable="true" 
			// onmouseup="saveSelection();" 
			// onkeyup="saveSelection();" 
			// onfocus="restoreSelection();"

		    $("#textarea_add_post_publisher").on ('blur', function (e) {
				onDivBlur();
		    });
		    $("#textarea_add_post_publisher").on ('mousedown', function (e) {
				return cancelEvent(e);
		    });
		    $("#textarea_add_post_publisher").on ('click', function (e) {
				return cancelEvent(e);
		    });
		    $("#textarea_add_post_publisher").on ('mouseup', function (e) {
				saveSelection();
		    });
		    $("#textarea_add_post_publisher").on ('keyup', function (e) {
				saveSelection();
		    });
		    $("#textarea_add_post_publisher").on ('focus', function (e) {
				restoreSelection();
		    });
		    $("#textarea_add_post_publisher").on ('keydown', function (e) {
		    	if( e.keyCode == 9) {
		    		e.preventDefault();
					insertTextAtCursor("\t");
		    	}
		    });

    		$("#submit_story_4").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_story_4").click();
    		});
			$("#submit_story_4").on('click', function() {
				var c = $("#textarea_add_post_publisher").html().replace(/\t/g, '        '); 
				$("#post_publisher_post_text").val(c);	
				// $("#post_publisher_id").val(post_publisher_created_id);
				$("#submit_story_4_text").addClass("hidden");						
				$("#submit_story_4_loader").removeClass("hidden");
				$("#submit_story_4_hidden").click();
			});

    		$("#cancel_story_4").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_story_4").click();
    		});
			$("#cancel_story_4").on('click', function() {
				cancel_post_publisher();
				// $("#submit_story_4_text").addClass("hidden");						
				// $("#submit_story_4_loader").removeClass("hidden");
			});

	
			$(document).on('click_101', function(e, id) {
				var s = "div#" + id;				
				// scroll_top = $(window).scrollTop();
				var content = $(this).find(s).html();
				$("#dialog_101_content_container").html(content);
				$("#dialog_101").jqmShow();	
			});
			$('#dialog_101').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					// hash.w.css('top', 40 + scroll_top);
					hash.w.css('top', 40);
					hash.w.css('opacity', 1.0).fadeIn(200);
				}
			}); 		


			$(document).on('click_104', function() {
				scroll_top = $(window).scrollTop();
				// var content = $(this).find(s).html();
				// $("#dialog_101_content_container").html(content);
				$("#dialog_104").jqmShow();	
			});
			$('#dialog_104').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', 40 + scroll_top);
					hash.w.css('opacity', 1.0).fadeIn(200);
				}
			}); 		


			$(document).on('click_105', function() {
				scroll_top = $(window).scrollTop();
				// var content = $(this).find(s).html();
				// $("#dialog_101_content_container").html(content);
				$("#dialog_105").jqmShow();	
			});
			$('#dialog_105').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', 40 + scroll_top);
					hash.w.css('opacity', 1.0).fadeIn(200);
				}
			}); 		

			$(document).on('click_2001', function() {
				var s = "#dialog_2001_content";				
				scroll_top = $(window).scrollTop();
				var content = $(this).find(s).html();
				$("#dialog_2001_content_container").html(content);
				$("#dialog_2001").jqmShow();	
			});
			$('#dialog_2001').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', 40 + scroll_top);
					hash.w.css('opacity', 1.0).fadeIn(200);
				}
			}); 		

			$(document).on('click_2002', function() {
				var s = "#dialog_2002_content";				
				scroll_top = $(window).scrollTop();
				var content = $(this).find(s).html();
				$("#dialog_2002_content_container").html(content);
				$("#dialog_2002").jqmShow();	
			});
			$('#dialog_2002').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', 40 + scroll_top);
					hash.w.css('opacity', 1.0).fadeIn(200);
				}
			}); 		



			$(document).on('click_1001', function() {
				scroll_top = $(window).scrollTop();
			});

			// $.ajaxSetup({cache: false});

			$("#render_story_4").html("<%= j render("publishers/story_4") %>");
			$("#render_story_4_post_publishers_count").html("<%= j render("publishers/story_4_post_publishers_count") %>");
			// $("#render_story_4_will_paginate").html("<#%= j render("publishers/story_4_will_paginate") %#>");			
			// $("#render_post_publisher_created_id").html("<#%= j render("publishers/post_publisher_created_id") %#>");

			$(document).on("click", ".btn-submit-post-user-like-create", function() {
				var id = $(this).find("input[name='post_publisher_id_hidden']").attr("value");
				var nlist = $(this).attr("name");
				create_post_publisher_like(id, nlist);
			});
			
			$(document).on("click", ".btn-submit-post-user-like-delete", function() {
				var id = $(this).find("input[name='post_publisher_id_hidden']").attr("value");
				var nlist = $(this).attr("name");
				delete_post_publisher_like(id, nlist);
			});

			


			$('#dialog_12').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_12').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_12').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_22').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_22').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_22').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_13').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_13').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_13').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_23').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_23').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_23').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		
		
			$('#dialog_14').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_14').animate(
						{bottom:'-=210', top:'+=210'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_14').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_24').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_24').animate(
						{bottom:'-=210', top:'+=210'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_24').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		


			


            $('.tip').each(function() {
                var tipContent = $(this).next('.tip-content').html();
                $(this).qtip({
                	style: { classes: 'tooltip-text-1' },
                    content: tipContent,
                    show: 'mouseover',
                    hide: 'mouseout'
                })
            });			
			
            $('.tip-bottom-center').each(function() {
                var tipContent = $(this).next('.tip-content').html();
                $(this).qtip({
                	style: { classes: 'tooltip-text-1' },
                    content: tipContent,
                    show: 'mouseover',
                    hide: 'mouseout',
				    position: {
				        my: 'top center',
				        at: 'bottom center'
				        // target: $('.tip-bottom-center')
    				}                    
                })
            });			

            $('.tip-top-center').each(function() {
                var tipContent = $(this).next('.tip-content').html();
                $(this).qtip({
                	style: { classes: 'tooltip-text-1' },
                    content: tipContent,
                    show: 'mouseover',
                    hide: 'mouseout',
				    position: {
				        my: 'bottom center',
				        at: 'top center'
				        // target: $('.tip-top-center')
    				}                    
                })
            });			
		
		
			// $("#div_pop_dialog_test").on('click', function() {
				// $("#a_pop_dialog_test").click();
			// });	
		
			// // $(".group1").colorbox({rel:'group1'});
			// // $(".group2").colorbox({rel:'group2', transition:"fade"});
			// // $(".group3").colorbox({rel:'group3', transition:"none", width:"75%", height:"75%"});
			// // $(".group4").colorbox({rel:'group4', slideshow:true});
			// // $(".ajax").colorbox();
			// // $(".youtube").colorbox({iframe:true, innerWidth:640, innerHeight:390});
			// // $(".vimeo").colorbox({iframe:true, innerWidth:500, innerHeight:409});
			// // $(".iframe").colorbox({iframe:true, width:"80%", height:"80%"});
			// $(".inline").colorbox({inline:true, width:"400px"});
			// // $(".callbacks").colorbox({
				// // onOpen:function(){ alert('onOpen: colorbox is about to open'); },
				// // onLoad:function(){ alert('onLoad: colorbox has started to load the targeted content'); },
				// // onComplete:function(){ alert('onComplete: colorbox has displayed the loaded content'); },
				// // onCleanup:function(){ alert('onCleanup: colorbox has begun the close process'); },
				// // onClosed:function(){ alert('onClosed: colorbox has completely closed'); }
			// // });
			// // $('.non-retina').colorbox({rel:'group5', transition:'none'})
			// // $('.retina').colorbox({rel:'group5', transition:'none', retinaImage:true, retinaUrl:true});
			// // $("#click").click(function(){ 
				// // $('#click').css({"background-color":"#f00", "color":"#fff", "cursor":"inherit"}).text("Open this window again and this message will still be here.");
				// // return false;
			// // });
		
		
			// $("#btn_pop_dialog_2_test").on('click', function() {
				// $("#dialog_14").jqmShow();
				// // $("#primary").val('true');
			// });			
		});


		$(window).on('beforeunload', function(){
			// cancel_post_publisher_on_close();
		});

	  
	</script>

