
					<% if @publisher_logo_image_primary %>
						<div style="display: inline-block; width: 604px; height: 604px; background-color: #aaa; border: 2px solid #376340;">
							<!-- <#%= image_tag @publisher_user_image_primary.image_url(:user_600_600), id: "cropbox_user" %#> -->
							<img id="cropbox_logo" alt="" src="<%= @publisher_logo_image_primary.image_url(:user_600_600) + '?' + (rand(10..90) * rand(100..900)).to_s if @publisher_logo_image_primary.image? %>" />
						</div>
						<div style="display: inline-block; width: 200px; height: 604px; vertical-align: top; position: relative;">
							<div class="background-table-dialog-2">
						   		<div class="table-dialog-1">
									<div class="dialog-msg-container">
										<span>Preview</span>
									</div>
				   				</div>
			   				</div>
			   				<div style="height: 4px"></div>							
							<div style="width:200px; height:200px; overflow:hidden">
							  <%= image_tag @publisher_logo_image_primary.image_url(:user_600_600), :id => "preview_logo_200" %>
							</div>
							<div style="height: 4px"></div>
							<div style="width:100px; height:100px; overflow:hidden">
							  <%= image_tag @publisher_logo_image_primary.image_url(:user_600_600), :id => "preview_logo_100" %>
							</div>
							<div style="height: 4px"></div>
							<div style="width:50px; height:50px; overflow:hidden">
							  <%= image_tag @publisher_logo_image_primary.image_url(:user_600_600), :id => "preview_logo_50" %>
							</div>
							<div style="height: 4px"></div>
							<div style="width:34px; height:34px; overflow:hidden">
							  <%= image_tag @publisher_logo_image_primary.image_url(:user_600_600), :id => "preview_logo_34" %>
							</div>
							<!-- <div style="height: 4px"></div> -->
							<!-- <#%= form_tag( crop_commit_user_publisher_users_path, :remote => true ) do %#> -->
							  	<%= text_field_tag :crop_x, params["crop_x"], id: "id_crop_x", class: "input-crop hidden" %><br>
							  	<%= text_field_tag :crop_y, params["crop_y"], id: "id_crop_y", class: "input-crop hidden" %><br>
							  	<%= text_field_tag :crop_w, params["crop_w"], id: "id_crop_w", class: "input-crop hidden" %><br>
							  	<%= text_field_tag :crop_h, params["crop_h"], id: "id_crop_h", class: "input-crop hidden" %><br>
								<%= hidden_field_tag "image_id", @publisher_logo_image_primary.id %>
							    <!-- <#%= submit_tag '', :id => 'btn_submit_crop_image_primary', :class => 'hidden' %#> -->
							<!-- <#% end %#> -->	
							
			   				<div style="position: absolute; bottom: 0px; right: 0px;">
								<span><input id="btn_dlg_submit_crop_logo_image_primary" class="btn-pop-dialog-1" type="button" value="Save" tabindex=""></span>
								&nbsp;
								<span><input id="btn_dlg_cancel_crop_logo_image_primary" class="btn-pop-dialog-1" type="button" value="Cancel" tabindex=""></span>
			   				</div>
							
						</div>
					<% else %>
						<div> no @publisher_logo_image_primary</div>
					<% end %>		


	<script>
		
		var insert_crop_x = <%= @crop_x %>;
		var insert_crop_y = <%= @crop_y %>;
		var insert_crop_w = <%= @crop_w %>;
		var insert_crop_h = <%= @crop_h %>;
		
		var insert_crop_x2 = insert_crop_x + insert_crop_w;
		var insert_crop_y2 = insert_crop_y + insert_crop_h;
		
		var max_dim;
		
	
		
        function showPreview(coords)
        {
            if (parseInt(coords.w) > 0)
            {
            	// alert('coords : ' + coords);
            	
                // var rx = 200 / coords.w;
                // var ry = 200 / coords.h;
		    	$('#id_crop_x').val(coords.x);
		    	$('#id_crop_y').val(coords.y);
		    	$('#id_crop_w').val(coords.w);
		    	$('#id_crop_h').val(coords.h);
		    	
					    	

                jQuery('#preview_logo_200').css({
					width: Math.round(200 / max_dim * $('#cropbox_logo').width()) + 'px',
				    height: Math.round(200 / max_dim * $('#cropbox_logo').height()) + 'px',

					// width: Math.round(200 / coords.w * $('#cropbox_logo').width()) + 'px',
				    // height: Math.round(200 / coords.h * $('#cropbox_logo').height()) + 'px',

				    marginLeft: '-' + Math.round(200 / coords.w * coords.x) + 'px',
				    marginTop: '-' + Math.round(200 / coords.h * coords.y) + 'px'
                });                
                // jQuery('#preview_logo_200').css({
					// width: Math.round(200 / coords.w * $('#cropbox_logo').width()) + 'px',
				    // height: Math.round(200 / coords.h * $('#cropbox_logo').height()) + 'px',
				    // marginLeft: '-' + Math.round(200 / coords.w * coords.x) + 'px',
				    // marginTop: '-' + Math.round(200 / coords.h * coords.y) + 'px'
                    // // width: Math.round(rx * 200) + 'px',
                    // // height: Math.round(ry * 200) + 'px',
                    // // marginLeft: '-' + Math.round(rx * coords.x) + 'px',
                    // // marginTop: '-' + Math.round(ry * coords.y) + 'px'
                // });                
                jQuery('#preview_logo_100').css({
					width: Math.round(100 / coords.w * $('#cropbox_logo').width()) + 'px',
				    height: Math.round(100 / coords.h * $('#cropbox_logo').height()) + 'px',
				    marginLeft: '-' + Math.round(100 / coords.w * coords.x) + 'px',
				    marginTop: '-' + Math.round(100 / coords.h * coords.y) + 'px'
                });
                jQuery('#preview_logo_50').css({
					width: Math.round(50 / coords.w * $('#cropbox_logo').width()) + 'px',
				    height: Math.round(50 / coords.h * $('#cropbox_logo').height()) + 'px',
				    marginLeft: '-' + Math.round(50 / coords.w * coords.x) + 'px',
				    marginTop: '-' + Math.round(50 / coords.h * coords.y) + 'px'
                });
                jQuery('#preview_logo_34').css({
					width: Math.round(34 / coords.w * $('#cropbox_logo').width()) + 'px',
				    height: Math.round(34 / coords.h * $('#cropbox_logo').height()) + 'px',
				    marginLeft: '-' + Math.round(34 / coords.w * coords.x) + 'px',
				    marginTop: '-' + Math.round(34 / coords.h * coords.y) + 'px'
                });
                
            }
        }
        
		// jQuery(window).load(function(){
		jQuery(document).ready(function() {
			
			insert_crop_w = <%= @crop_w %>;
			insert_crop_h = <%= @crop_h %>;
			
			if (insert_crop_w > insert_crop_h ) {
				max_dim = insert_crop_w;
			}
			else {
				max_dim = insert_crop_h;
			}
			var image_to_crop = $("#cropbox_logo");
			image_to_crop.Jcrop({
            // jQuery('#cropbox_profile').Jcrop({
                // aspectRatio: 1,
            	setSelect: [insert_crop_x, insert_crop_y, insert_crop_x2, insert_crop_y2],
	            // onSelect: function(coords){showPreview(coords);},
			    // onChange: function(coords){showPreview(coords);}
	            // onSelect: function(coords){showPreview(image_to_crop, coords);},
			    // onChange: function(coords){showPreview(image_to_crop, coords);}
                onSelect: showPreview,
                onChange: showPreview                
            });
        });
		
		
		// $(window).load( function() {
		$(document).ready(function () {				
			
		});

		
	</script>
