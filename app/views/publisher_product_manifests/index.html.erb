<% provide(:title, 'Publisher Product Manifest') %>


	<!-- <script src="/assets/jqModal.js"></script> -->
	<!-- <script src="/assets/jquery.easing.1.3.js"></script> -->
	<!-- <link rel="stylesheet" href="/assets/jqModal.css" /> -->

	<!-- <script type="text/javascript" src="../scripts/jquery_ui_1.10.4.js"></script>
	<script type="text/javascript" src="../scripts/jquery.multiselect.js"></script> -->

	<!-- <script type="text/javascript" src="../multi_select/prettify.js"></script> -->

  	<!-- <link rel="stylesheet" href="/assets/chosen.css">
  	<script src="/assets/chosen.jquery.js" type="text/javascript"></script>
  	<script src="/assets/toucheffects.js" type="text/javascript"></script> -->
  	
  	<!-- <script src="/assets/jquery.qtip.min.js" type="text/javascript"></script> -->
  	<!-- <link rel="stylesheet" href="/assets/jquery.qtip.min.css"> -->

	<!-- <script src="../jcrop/js/jquery.Jcrop.js"></script>
	<script type="text/javascript">
	  jQuery(function($){
	    $('#target').Jcrop();
	  });
	</script> -->
	<!-- <link rel="stylesheet" href="../jcrop/css/jquery.Jcrop.css" type="text/css" /> -->


	<!-- <link rel="stylesheet" href="/assets/publisher-product-manifest.css" type="text/css" /> -->
	
	<!-- <link rel="stylesheet" href="../styles/ks-profile.css" /> -->

	<!-- <link rel="stylesheet" type="text/css" href="../styles/fullscreenstyle.css"></link> -->
	<!-- <script src="../scripts/jquery.fullscreenslides.js"></script> -->
	
	
    <!-- <script src="/assets/dot.js"></script>    
    <script src="/assets/jquery-dropdown-dot.js"></script> -->
	<!-- <script type="text/javascript" src="../scripts/jquery.tmpl.js"></script> -->

	<style>
		.preview-pos-load {
			position: absolute;
			top: -1000px;
			/*top: 0px;*/
		}
		.preview-pos-ready {
			position: relative;
			/*top: 0;*/
		}
		.display-none-listing {
			display: none;	
		}
		
	</style>					


	<style>
		
		/*.add-description-container-active {
			min-height: 52px;
		}
		.add-description-container-inactive {
			min-height: 26px;
			background: url('/assets/background-placeholder-comment-2-w206-h20.png') 3px 4px no-repeat;
		}*/
		.textarea-render-1 {
			position: relative;
			width: 100%;
			/*min-height: 26px;*/
			margin: 0;
			padding: 0 10px 0 0;
		}
		.textarea-render-2 {
		  	font-family: Arial, Helvetica, sans-serif;
		  	font-weight: 400;
		  	/*color: #666;*/
		  	color: #333;
			font-size: 13px;
			width: 579px;
		    white-space: pre-wrap;
		    word-wrap: break-word;
		    overflow-wrap: break-word;		
		    border: 1px solid transparent;
			padding: 6px 5px 5px 5px;	    
		}				
		.textarea-description-container {
			border: 1px solid #49853f; /*#2899A1*/ 
			border-radius: 0px;			
			min-height: 38px;
			width: 660px;			
			background-color: #fff;
			padding: 5px 0px 4px 5px;
			margin: 2px 0 0 20px;
		}
		.textarea-description-container-edit {
			border: 1px solid #fbb040; 
			border-radius: 0px;			
			min-height: 38px;
			width: 660px;			
			background-color: #fff;
			padding: 5px 0px 4px 5px;
			margin: 2px 0 0 20px;
		}
		.textarea-description-empty {
			/*min-height: 26px;*/
			background-image: url('/assets/background-placeholder-description-2-w70-h18.png');
			/*Who are you? Write the Story of what you know.*/
			background-repeat: no-repeat;
			background-position: 3px 5px;
			/*background-color: #fff;*/
		}
		.textarea-description-edit {
			background-color: #eee;
			/*min-height: 38px;*/
		}
		.textarea-description-show {
			background-color: #fff;
			/*min-height: 38px;*/
		}		
		/*.textarea-description-inactive {
			min-height: 26px;
			background-image: url('/assets/background-placeholder-description-1-w115-h18.png');
			background-repeat: no-repeat;
			background-position: 3px 5px;
			background-color: #fff;
		}
		.textarea-description-active {
			background-color: #eee;
			min-height: 38px;
		}*/
		.textarea-description {
			vertical-align: text-top;
			/*overflow: hidden;*/
			font-family: Arial, Helvetica, sans-serif;
			font-weight: 400;
			font-size: 13px;
			color: #1B666B;
			line-height: 100%;
			padding: 7px 5px 5px 5px;
			min-height: 26px;
			width: 648px;			
			/*white-space: pre;*/
		    white-space: pre-wrap;
		    word-wrap: break-word;
		    overflow-wrap: break-word;									
		}
		.textarea-description:focus:hover {
			outline: none;
		}
		.textarea-description:focus {
			outline: none;
		}						
		.textarea-description:hover {
			outline: none;
		}		
		.render-description-image {
			
		}
		.textarea-description-show-text {
			font-family: Arial, Helvetica, sans-serif;
			font-weight: 600;
			font-size: 13px;
			color: #888;
		}
		
		.resize-none {
			resize: none;
		}
				
		.submit-edit-story-2-text {
			margin: 0;
		}				
		.submit-edit-story-2-text-2 {
			margin: 9px 0 0 0;
		}				
		.submit-edit-story-2-loader {
			width: 32px;
			height: 32px;
			background-image: url('/assets/loader_ajax_w32_h32_7.gif');
			background-repeat: no-repeat;
			display: inline-block;
			/*margin: 5px 0 0 0;*/
			margin: 5px 0 0 0;
		}	
		.description-delete {
			width: 20px;
			height: 20px;
			background-image: url('/assets/button_delete_w20_h20.png');
			background-repeat: no-repeat;
			display: inline-block;
			margin: 2px 2px 0 0;			
		}
		.description-delete:hover {
			cursor: pointer;
		}
		.description-delete-blank {
			width: 20px;
			height: 20px;
			display: inline-block;
			margin: 2px 2px 0 0;			
		}
		.story-2-attach {
			font-family: Arial, Helvetica, sans-serif;
			font-weight: 400;
			font-size: 13px;
			color: #888;
		}
		.story-2-attach:hover {
			cursor: pointer;
			text-decoration: underline;
		}
		
	</style>

	<style>
		
		.textarea-topic-container {
			border: 1px solid #49853f; /*#2899A1*/ 
			border-radius: 0px;			
			min-height: 38px;
			/*width: 660px;*/
			width: 314px;			
			background-color: #fff;
			padding: 5px 0px 4px 5px;
			/*margin: 2px 0 0 20px;*/
			margin: 0;
		}
		.textarea-topic-container-edit {
			border: 1px solid #fbb040; 
			border-radius: 0px;			
			min-height: 38px;
			/*width: 660px;*/			
			width: 314px;
			background-color: #fff;
			padding: 5px 0px 4px 5px;
			/*margin: 2px 0 0 20px;*/
			margin: 0px;
		}
		.textarea-topic-empty {
			background-image: url('/assets/background-placeholder-topic-1-w34-h18.png');
			/*Who are you? Write the Story of what you know.*/
			background-repeat: no-repeat;
			background-position: 3px 5px;
		}
		.textarea-topic-edit {
			background-color: #eee;
		}
		.textarea-topic-show {
			background-color: #fff;
		}		
		.textarea-topic {
			vertical-align: text-top;
			font-family: Arial, Helvetica, sans-serif;
			font-weight: 400;
			font-size: 13px;
			color: #1B666B;
			line-height: 100%;
			padding: 7px 5px 5px 5px;
			min-height: 26px;
			/*width: 648px;*/
			width: 302px;			
		    white-space: pre-wrap;
		    word-wrap: break-word;
		    overflow-wrap: break-word;									
		}
		.textarea-topic:focus:hover {
			outline: none;
		}
		.textarea-topic:focus {
			outline: none;
		}						
		.textarea-topic:hover {
			outline: none;
		}		
		.textarea-topic-show-text {
			font-family: Arial, Helvetica, sans-serif;
			font-weight: 600;
			font-size: 13px;
			color: #888;
		}
		
	</style>

	<style>
		
		.textarea-subject-container {
			border: 1px solid #49853f; /*#2899A1*/ 
			border-radius: 0px;			
			min-height: 38px;
			/*width: 660px;*/
			width: 314px;			
			background-color: #fff;
			padding: 5px 0px 4px 5px;
			/*margin: 2px 0 0 20px;*/
			margin: 0;
		}
		.textarea-subject-container-edit {
			border: 1px solid #fbb040; 
			border-radius: 0px;			
			min-height: 38px;
			/*width: 660px;*/			
			width: 314px;
			background-color: #fff;
			padding: 5px 0px 4px 5px;
			/*margin: 2px 0 0 20px;*/
			margin: 0px;
		}
		.textarea-subject-empty {
			background-image: url('/assets/background-placeholder-lesson-plan-subject-1-w123-h18.png');
			/*Who are you? Write the Story of what you know.*/
			background-repeat: no-repeat;
			background-position: 3px 5px;
		}
		.textarea-subject-edit {
			background-color: #eee;
		}
		.textarea-subject-show {
			background-color: #fff;
		}		
		.textarea-subject {
			vertical-align: text-top;
			font-family: Arial, Helvetica, sans-serif;
			font-weight: 400;
			font-size: 13px;
			color: #1B666B;
			line-height: 100%;
			padding: 7px 5px 5px 5px;
			min-height: 26px;
			/*width: 648px;*/
			width: 302px;			
		    white-space: pre-wrap;
		    word-wrap: break-word;
		    overflow-wrap: break-word;									
		}
		.textarea-subject:focus:hover {
			outline: none;
		}
		.textarea-subject:focus {
			outline: none;
		}						
		.textarea-subject:hover {
			outline: none;
		}		
		.textarea-subject-show-text {
			font-family: Arial, Helvetica, sans-serif;
			font-weight: 600;
			font-size: 13px;
			color: #888;
		}
		
	</style>


	
	<style>
		
		.color-record {
			/*color: #593E16;*/
			color: #000;
		}	
		.color-no-record {
			color: #49853f;			
		}	
		span.box-odd {
			color: #593E16;
		}
		span.box-even {
			color: #FBB040;  
		}
		span.box-other {
			color: #A6A6A6;
		}
		span.form-text-12 {
		    font-family: Arial,Helvetica,sans-serif;
		    font-size: 13px;
		    font-weight: 700;
		}
		div.form-text-list-12 span {
		    font-family: Arial,Helvetica,sans-serif;
		    font-size: 13px;
		    font-weight: 700;
		}
		.like-icon {
			height: 22px;
			width: 19px;
			background-image: url("/assets/icon_like_green_w22_h19.png");
			background-repeat: no-repeat;
			background-position: 0px 0px;
			position: relative;
			top: 6px;
		}
		.style-tagline {
			padding: 1px 1px 1px 8px;
		}
		.style-list-field-1 {
			display: inline-block;
			padding: 1px 1px 1px 0px;
		}
		.style-list-field-1-title {
			display: inline-block;
			padding: 1px 1px 1px 8px;
		}
		.style-list-field-2 {
			padding: 1px 1px 1px 0px;
		}
		
		.list-field-title {
		    font-family: Arial,Helvetica,sans-serif;
		    font-size: 13px;
		    font-weight: 700;
		    color: #888;
		}
		.list-field-text {
		    font-family: Arial,Helvetica,sans-serif;
		    font-size: 13px;
		    font-weight: 700;
		}
		
		/*.list-float-right {
			float: right;
			padding-right: 8px;	
		}*/		
		/*.float-clear {
			clear: all;
		}*/
		
		.list-field-cell-1 {
			display: table-cell; 
			width: 210px;
			overflow-x: hidden;
		}
		.list-field-cell-1a {
			/*width: 208px;*/
			width: auto;
			word-wrap: normal;
			white-space: nowrap;
		}
		.list-field-cell-2 {
			display: table-cell; 
			width: 15px;
		}
		.list-field-cell-3 {
			display: table-cell; 
			width: 10px;
		}
		.overflow-hidden-208 {
			width: 208px;
			overflow-x: hidden;
		}
		.hidden {
			display: none !important;
			visibility: hidden !important			
		}
		
	</style>
	
	<!-- <style>
		.tooltip-text-1 {
			font-family:Arial, Helvetica, sans-serif;
			font-size: 12px;
			font-weight: 400;					
			/*color: #37633A;*/
			color: #fff;	
			/*background-color: #FAFF94;*/
			background-color: rgba(0, 0, 0, 0.6);
			/*background-color: #eee;*/
			/*border-color: #37633A;*/
			border-color: rgba(0, 0, 0, 0.6);
			border-radius: 3px;
			box-shadow: 0px 2px 2px #aaa;
		}
		.tip-content { display: none; }
	</style> -->

	<style>

		.list-tip-container {
			position: relative;
		}		
		.list-tip-target:hover + .list-tip-1 span {
		}
		.list-tip-target:hover + .list-tip-1 {
			display: block;
		}
		.list-tip-1 {
			position: absolute;
			/*width: 60px;*/
			height: 24px;
			background-color: rgba(0, 0, 0, 0.8);
			border-color: rgba(0, 0, 0, 0.8);
			/*background-color: rgba(55, 99, 58, 0.9);*/ /*#37633A*/
			/*border-color: rgba(55, 99, 58, 0.9);*/			
			border-radius: 3px;
			box-shadow: 0px 2px 2px #aaa;
			text-align: center;			
			font-family:Arial, Helvetica, sans-serif;
			font-size: 13px;
			font-weight: 400;					
			color: #fff;	
			padding: 4px;
			display: none;			
			width: auto;
			word-wrap: normal;
			white-space: nowrap;							
		}
		.list-tip-1-indicator {
			position: absolute;
			top: 24px;
			left: 4px;
			width: 8px;
			height: 12px;
			background-image: url("/assets/drop-w8-h12.png");
		}		
		.list-tip-34minus {
			top: -34px;
		}
		.list-tip-pos-1 {
			top: -30px;
		}
		.list-tip-target:hover + .list-tip span {
		}
		.list-tip-target:hover + .list-tip {
			display: block;
		}
		.list-tip {
			position: absolute;
			display: none;							
		}		
		.list-tip-delete-post-user-comment {
			position: absolute;
			width: 60px;
			height: 24px;
			background-color: rgba(0, 0, 0, 0.6);
			border-color: rgba(0, 0, 0, 0.6);
			border-radius: 3px;
			box-shadow: 0px 2px 2px #aaa;
			text-align: center;			
			font-family:Arial, Helvetica, sans-serif;
			font-size: 11px;
			font-weight: 400;					
			color: #fff;	
			padding: 6px 0 0 0;
			display: none;
			top: -36px;
			left: -20px;		
			z-index: 1;
		}		
		.list-tip-indicator-delete-post-user-comment {
			position: absolute;
			top: 24px;
			left: 27px;
			width: 8px;
			height: 12px;
			background-image: url("/assets/drop-w8-h12.png");
		}		

		.list-tip-delete-post-user {
			position: absolute;
			width: 60px;
			height: 24px;
			background-color: rgba(0, 0, 0, 0.6);
			border-color: rgba(0, 0, 0, 0.6);
			border-radius: 3px;
			box-shadow: 0px 2px 2px #aaa;
			text-align: center;			
			font-family:Arial, Helvetica, sans-serif;
			font-size: 11px;
			font-weight: 400;					
			color: #fff;	
			padding: 6px 0 0 0;
			display: none;
			top: -36px;
			left: -20px;		
			z-index: 1;
		}		
		.list-tip-indicator-delete-post-user {
			position: absolute;
			top: 24px;
			left: 27px;
			width: 8px;
			height: 12px;
			background-image: url("/assets/drop-w8-h12.png");
		}		

		
	</style>


	<script>

		function set_by_review_listing(b_has_by_review_listing, list_number) {
			var list_id = "#by_review_" + list_number;
			var s = "No";
			// if(b_has_by_review_listing) {
				// s = "Yes"				
			// }
			$(list_id).html(s);
		}

		// function set_field_test(len_col, title, field, field_text, field_text_default, has_field_other, field_other, list_number) {
			// var list_id      = "#" + field + "_" + list_number;
			// var list_id_text = "#" + field + "_" + list_number + " span.list-field-text";
			// var s = "";
			// var s_text = "";
			// var s_text_default = field_text_default;
			// var s_html = "";
			// var length_title = title.length + 2;
			// var length_column_pixels = len_col;
			// var character_size_height = 13;
			// var character_size_width = Math.round(13 * 0.50);
			// var length_column_characters = Math.round(length_column_pixels/character_size_width);
			// var length_allowed = length_column_characters - length_title;
			// var length_subtract = 2;
			// for(var i = 0; i < field_text.length; i++) {
				// s = field_text[i];
				// // s = s.replace(/ /g, "&nbsp;");
				// if(i == 0) {
	 				// s_text = s;
	 			// }
				// if(i > 0) {
	 				// s_text += ', ' + s;
	 			// }
			// }
			// if(has_field_other) {
				// if(s_text.length > 0) {
					// s_text += ', ' + field_other;
				// }
				// else {
					// s_text = field_other;
				// }
			// }
			// if(s_text.length > 0) {
				// if(s_text.length > length_allowed) {
					// s_text = s_text.slice(0, (length_allowed - length_subtract)); 
		 			// s_html += '<span class="list-field-title">' + title + '</span><span class="list-field-text">' + s_text + '</span><span class="list-float-right">...</span>';
		 			// // $(list_id_text).addClass("color-record");
				// }
				// else {
		 			// s_html += '<span class="list-field-title">' + title + '</span><span class="list-field-text">' + s_text + '</span>';
		 			// // $(list_id_text).addClass("color-record");
				// }
			// }
			// else { 
				// s_html += '<span class="list-field-title">' + title + '</span><span class="list-field-text">' + s_text_default + '</span>';
				// // $(list_id_text).addClass("color-no-record");
			// }
			// $(list_id).html(s_html);
			// if(s_text.length > 0) {
				// $(list_id_text).removeClass("color-no-record").addClass("color-record");
			// }
			// else { 
		 		// $(list_id_text).removeClass("color-record").addClass("color-no-record");
			// }
		// }


		function set_field(title, field, field_text, field_text_default, has_field_other, field_other, list_number) {
			var list_id      = "#" + field + "_" + list_number;
			var list_id_text = "#" + field + "_" + list_number + " span.list-field-text";
			var list_id_ellipsi = "#" + field + "_container_" + list_number + " div.list-field-ellipsi";
			var list_id_tip_span = "#render_" + field + "_" + list_number + " div.list-tip-1 span";
			var list_id_tip = "#render_" + field + "_" + list_number + " div.list-tip-1";
			// alert(list_id_tip);
			var s = "";
			var s_text = "";
			var s_text_default = field_text_default;
			var s_html = "";
			for(var i = 0; i < field_text.length; i++) {
				s = field_text[i];
				// s = s.replace(/ /g, "&nbsp;");
				if(i == 0) {
	 				s_text = s;
	 			}
				if(i > 0) {
	 				s_text += ', ' + s;
	 			}
			}
			if(has_field_other) {
				if(s_text.length > 0) {
					s_text += ', ' + field_other;
				}
				else {
					s_text = field_other;
				}
			}
			if(s_text.length > 0) {
		 		s_html += '<span class="list-field-title">' + title + '</span><span class="list-field-text">' + s_text + '</span>';
			}
			else { 
				s_html += '<span class="list-field-title">' + title + '</span><span class="list-field-text">' + s_text_default + '</span>';
			}
			$(list_id).html(s_html);
			if(s_text.length > 0) {
				$(list_id_text).removeClass("color-no-record").addClass("color-record");
			}
			else { 
		 		$(list_id_text).removeClass("color-record").addClass("color-no-record");
			}
			
			var w = $(list_id).width();
			if (w > 210) {
				// alert("w > 210");
				$(list_id).addClass("overflow-hidden-208");
				$(list_id_ellipsi).removeClass("hidden");
				$(list_id_tip_span).html(s_text);
				$(list_id_tip).removeClass("hidden");
			}
		}
		
	</script>







<% if false %>
<div class="container">
	<div class="table-profile">
		<div class="row-profile">
			<div style="display: table-cell; width: 200px; vertical-align: top; margin: 0; padding: 0; height: 100%;">
				<%= render 'share/dir_publishers_left' %>
			</div>
			<div class="col-midd-700-borders">
				<div class="table-profile">
					<div class="row-profile">
						<div class="col-midd-700">
							<%= render 'publisher_product_manifests/index' %>
						</div>
					</div>
				</div>					
			</div>
			<div style="display: table-cell; width: 300px; padding: 0; margin: 0; vertical-align: top; height: 100%;">
				<div class="" style="width: 200px; height: 50px; position: relative;">
					<%= render 'share/dir_publishers_right_user_home' %>
				</div>
			</div>
		</div>
	</div>
</div>
<% end %>
	
<div class="table-profile" style="height: 100%;">
	<div class="row-profile">
		<div class="profile-left-col">
			<div class="table margin-0">
				<div class="row">
					<div class="cell-225">
						<div style="height: 300px; background-color: #dedede;"></div>						
					</div>
					<div class="cell-750">
						<%= render 'publisher_product_manifests/index' %>
					</div>	
					<div class="cell-225">
						<div style="height: 300px; background-color: #dedede;"></div>
					</div>					
				</div>
			</div>
		</div>
	</div>
</div>

	<script>
	 
	 	// *****
	 	// section full screen image gallery
	 	
	   	// $(function(){
		// $(window).load( function() {
		$(document).ready(function () {				
	   		
			// $('.image img').fullscreenslides();
			$('.image div').fullscreenslides();

			var $container = $('#fullscreenSlideshowContainer');
			$container.bind("init", function() {
				$container
				.append('<div class="ui" id="fs-close">&times;</div>')
				.append('<div class="ui" id="fs-loader">Loading...</div>');
				// .append('<div class="ui" id="fs-prev">&lt;</div>')
				// .append('<div class="ui" id="fs-next">&gt;</div>')
				// .append('<div class="ui" id="fs-caption"><span></span></div>');
	
				// $('#fs-prev').click(function(){
					// $container.trigger("prevSlide");
				// });
				// $('#fs-next').click(function(){
					// $container.trigger("nextSlide");
				// });
				$('#fs-close').click(function(){
					$container.trigger("close");
				});
			})
			.bind("startLoading", function() {
				$('#fs-loader').show();
			})
			.bind("stopLoading", function() {
				$('#fs-loader').hide();
			});
			// .bind("startOfSlide", function(event, slide) {
				// $('#fs-caption span').text(slide.title);
				// $('#fs-caption').show();
			// })
			// .bind("endOfSlide", function(event, slide) {
				// $('#fs-caption').hide();
			// });	   		
	     
	   	});

	</script>

	<script>

		// function catchIt(iframe_msg) {
			// alert(iframe_msg);
		// }
		// function cb_set(caller) {
			// alert(caller);
		// }

	</script>

	<script>

		// function openEditProductLogo() {
			// $("#form9").slideDown(400, function(){ $("#form9a").fadeIn( 2000 ) });
		// }
		// function closeEditProductLogo() {
			// $("#form9a").fadeOut(700, function(){ 
				// $("#form9").slideUp(400); 
			// });
		// }

		// function openEditProduct1Image() {
			// $("#form10").slideDown(400, function(){ $("#form10a").fadeIn( 2000 ) });
		// }
		// function closeEditProduct1Image() {
			// $("#form10a").fadeOut(700, function(){ 
				// $("#form10").slideUp(400); 
			// });
		// }

	</script>

	<script>

	 	// *****
	 	// section Product2Image

		function openEditProduct2Image() {
			$("#form11").slideDown(400, function(){ $("#form11a").fadeIn( 2000 ) });
		}

		function closeEditProduct2Image() {
			$("#form11a").fadeOut(700, function(){ 
				$("#form11").slideUp(400); 
			});
		}

	</script>

	<script>

	 	// *****
	 	// section ProductCorporateLogo

		function openEditProductCorporateLogo() {
			$("#form12").slideDown(400, function(){ $("#form12a").fadeIn( 2000 ) });
		}

		function closeEditProductCorporateLogo() {
			$("#form12a").fadeOut(700, function(){ 
				$("#form12").slideUp(400); 
			});
		}

	</script>

	<script>

	 	// *****
	 	// section utilities

		function arraysAreIdentical(arr1, arr2){
		    if (arr1.length !== arr2.length) return false;
		    for (var i = 0, len = arr1.length; i < len; i++){
		        if (arr1[i] !== arr2[i]){
		            return false;
		        }
		    }
		    return true; 
		}

		function set_updated(s_updated) {
			// alert(s_updated);
			$("#render_updated").html(s_updated);
		}
		
		function countChar_1(val) {
	    	var len = val.value.length;
	        if (len > 150) {
	        	val.value = val.value.substring(0, 150);
	        } else {
	        	$('#char_num_1').text(150 - len);
	      	}
		}

		function countChar_2(val) {
	    	var len = val.value.length;
	        if (len > 150) {
	        	val.value = val.value.substring(0, 150);
	        } else {
	        	$('#char_num_2').text(150 - len);
	      	}
		}


		function set_control_required(cntrl, b) {
			// alert('set_control_required');
			var s_cntrl = "#required_" + cntrl;
			if(b) {
				$(s_cntrl).addClass("check-required").removeClass("display-none");	
			}
			else {
				$(s_cntrl).removeClass("check-required").addClass("display-none");
			}
		}

		function set_control_span(cntrl, s, b) {
			var s_cntrl = "#span_" + cntrl;
			$(s_cntrl).html(s);
			if (b) {
				$(s_cntrl).removeClass("color-no-record").addClass("color-record");
			}
			else {
				$(s_cntrl).removeClass("color-record").addClass("color-no-record");				
			}
		}

		function set_control(cntrl, s, b) {
			var s_cntrl = "#" + cntrl;
			$(s_cntrl).html(s);
			// if (b) {
				// $(s_cntrl).removeClass("color-no-record").addClass("color-record");
			// }
			// else {
				// $(s_cntrl).removeClass("color-record").addClass("color-no-record");				
			// }
		}

		// function set_name_product(name_product, b_name_product) {
			// $("#span_name_product").html(name_product);
			// if (b_name_product) {
				// $("#span_name_product").removeClass("color-no-record").addClass("color-record");
			// }
			// else {
				// $("#span_name_product").removeClass("color-record").addClass("color-no-record");				
			// }
		// }

		function show_control(cntrl) {
			var s_edit = "#edit_" + cntrl;
			var s_show_open = "#show_" + cntrl + ", #open_edit_" + cntrl;		
    		$(s_edit).fadeOut(300, function(){
    			$(s_edit).addClass("hidden");
    			$(s_show_open).fadeIn(1300).removeClass("hidden");
    			$(s_show_open).fadeIn(1300).removeClass("hidden").removeClass("visibility-hidden");
    		});
		}

		// box_detail_core_literacy_standard			box-detail-1			box-detail-2
		// box_detail_table_core_literacy_standard		box-detail-table-1		box-detail-table-2
		// cell_outer_core_literacy_standard			cell-325				cell-670
		// cell_inner_core_literacy_standard			cell-265				cell-670 
		function show_control_standard(cntrl) {
			var s_1 = "#box_detail_" + cntrl;
			var s_2 = "#box_detail_table_" + cntrl;
			var s_3 = "#cell_outer_" + cntrl;
			var s_4 = "#cell_inner_" + cntrl;
			$(s_1).removeClass("box-detail-2").addClass("box-detail");
			$(s_2).removeClass("box-detail-table-2").addClass("box-detail-table-1");
			$(s_3).removeClass("cell-670").addClass("cell-325");
			$(s_4).removeClass("cell-670").addClass("cell-265");			
		}
		function show_control_standard_edit(cntrl) {
			var s_1 = "#box_detail_" + cntrl;
			var s_2 = "#box_detail_table_" + cntrl;
			var s_3 = "#cell_outer_" + cntrl;
			var s_4 = "#cell_inner_" + cntrl;
			$(s_1).removeClass("box-detail").addClass("box-detail-2");
			$(s_2).removeClass("box-detail-table-1").addClass("box-detail-table-2");
			$(s_3).removeClass("cell-325").addClass("cell-670");
			$(s_4).removeClass("cell-265").addClass("cell-670");			
		}

	    // $("#open_edit_content_type").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");

		// function show_edit_control(cntrl, side) {
			// var s_edit_cntrl = "#open_edit_" + cntrl;
			// var s_icon = "edit-icon-" + side;
	    	// $(s_edit_cntrl).addClass(s_icon).addClass("pop-info").addClass("tip").removeClass("edit-icon-blank");
		// }

		function show_control_dbl(cntrl, cntrl1, cntrl2) {
    		// $("#edit_description_1, #edit_description_2").fadeOut(300, function(){
    			// $("#edit_description_1, #edit_description_2").addClass("hidden");
    			// $("#show_description_1, #show_description_2").fadeIn(1300).removeClass("hidden");
    			// $("#open_edit_description").fadeIn(1300).removeClass("visibility-hidden");
    		// });
			var s_edit = "#edit_" + cntrl1 + ", #edit_" + cntrl2;
			var s_show = "#show_" + cntrl1 + ", #show_" + cntrl2;		
			var s_open = "#open_edit_" + cntrl;		
    		$(s_edit).fadeOut(300, function(){
    			$(s_edit).addClass("hidden");
    			$(s_show).fadeIn(1300).removeClass("hidden");
    			$(s_open).fadeIn(1300).removeClass("visibility-hidden");
    		});
		}

	</script>

	<script>

	 	// *****
	 	// section content_type

		function other_selected_content_type(sel, des) {
			if (sel == 12) {
				$("#other_content_type").fadeIn(2000).removeClass("hidden");				
			}
			if (des == 12) {
				$("#publisher_product_content_type_other").val("");			
				$("#other_content_type").fadeOut(2000, function() {
					$(this).addClass("hidden");
				});	
			}
		}

		function set_content_type(content_type, has_content_type_other) {
			// document.getElementById("publisher_product_content_type").selectedIndex = "-1";			
			var e = document.getElementById("publisher_product_content_type");			
			// e.selectedIndex = "-1";
			for(var i = 0; i < content_type.length; i++) {
				if (content_type[i]) {
					e.options[i].setAttribute('selected','selected');
				}
			}
			if (has_content_type_other) {
				e.options[11].setAttribute('selected','selected');
			}
			else {
				e.options[11].selected = false;
				$("#other_content_type").addClass("hidden");
			}
			$("#publisher_product_content_type").trigger("chosen:updated");
		}

		function set_content_type_text(content_type_text, has_content_type_other, content_type_other) {
			var s = "";
			var s_html = "";
			for(var i = 0; i < content_type_text.length; i++) {
				s = content_type_text[i];
				s = s.replace(/ /g, "&nbsp;");
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			if (has_content_type_other) {
				s_html += '<span class="box-other">' + content_type_other.replace(/ /g, "&nbsp;") + '</span> ';
				$("#other_content_type").removeClass("hidden");
			}
			$("#box_content_type").html(s_html);
			if (s_html.length > 0) {					
				$("#box_content_type").addClass("box-detail-padding");
			}
			else {
				$("#box_content_type").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section category_subject

		function other_selected_category_subject(sel, des) {
			if (sel == 40) {
				$("#other_category_subject").fadeIn(2000).removeClass("hidden");				
			}
			if (des == 40) {
				$("#publisher_product_category_subject_other").val("");			
				$("#other_category_subject").fadeOut(2000, function() {
					$(this).addClass("hidden");
				});	
			}
		}

		function set_category_subject(category_subject, has_category_subject_other) {
			var e = document.getElementById("publisher_product_category_subject");			
			for(var i = 0; i < category_subject.length; i++) {
				if (category_subject[i]) {
					e.options[i].setAttribute('selected','selected');
				}
			}
			if (has_category_subject_other) {
				e.options[39].setAttribute('selected','selected');
			}
			else {
				e.options[39].selected = false;
				$("#other_category_subject").addClass("hidden");
			}
			$("#publisher_product_category_subject").trigger("chosen:updated");
		}

		function set_category_subject_text(category_subject_text, has_category_subject_other, category_subject_other) {
			var s = "";
			var s_html = "";
			var s_html_default = "Subject";
			for(var i = 0; i < category_subject_text.length; i++) {
				s = category_subject_text[i];
				s = s.replace(/ /g, "&nbsp;");
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			if (has_category_subject_other) {
				s_html += '<span class="box-other">' + category_subject_other.replace(/ /g, "&nbsp;") + '</span> ';
				$("#other_category_subject").removeClass("hidden");
			}
			$("#box_category_subject").html(s_html);
			if (s_html.length > 0) {					
				$("#box_category_subject").addClass("box-detail-padding");
			}
			else {
				$("#box_category_subject").removeClass("box-detail-padding");
			}
		}
		
	</script>

	<script>

	 	// *****
	 	// section platform
		
		// function set_platform(platform) {
			// var e = document.getElementById("publisher_product_platform");
			// for(var i = 0; i < platform.length; i++) {
				// if( platform[i] ) {
					// e.options[i].setAttribute('selected','selected');
				// }
			// }
			// $("#publisher_product_platform").trigger("chosen:updated");
		// }
// 
		// function set_platform_text(platform_text) {
			// // if (category_subject_text.length > 0) {
				// s = "";
				// s_html = "";
				// // span_id = "";
				// for(var i = 0; i < platform_text.length; i++) {
					// s = platform_text[i];
					// s = s.replace(/ /g, "&nbsp;");
					// // span_id = "id_span_box_2_" + i.toString();
		 			// if (i%2 == 0 ? true : false) {
		 				// s_html += '<span class="box-odd">' + s + '</span> ';
		 			// }
		 			// else {
		 				// s_html += '<span class="box-even">' + s + '</span> ';
		 			// }
				// }
				// $("#box_platform").html(s_html);
				// if (platform_text.length > 0) {
					// $("#box_platform").addClass("box-detail-padding");
				// }
				// else {
					// $("#box_platform").removeClass("box-detail-padding");
				// }
// 				
			// // }
		// }

		function other_selected_platform(sel, des) {
			if (sel == 14) {
				$("#other_platform").fadeIn(2000).removeClass("hidden");				
			}
			if (des == 14) {
				$("#publisher_product_platform_other").val("");			
				$("#other_platform").fadeOut(2000, function() {
					$(this).addClass("hidden");
				});	
			}
		}

		function set_platform(platform, has_platform_other) {
			var e = document.getElementById("publisher_product_platform");			
			for(var i = 0; i < platform.length; i++) {
				if (platform[i]) {
					e.options[i].setAttribute('selected','selected');
				}
			}
			if (has_platform_other) {
				e.options[13].setAttribute('selected','selected');
			}
			else {
				e.options[13].selected = false;
				$("#other_platform").addClass("hidden");
			}
			$("#publisher_product_platform").trigger("chosen:updated");
		}

		function set_platform_text(platform_text, has_platform_other, platform_other) {
			var s = "";
			var s_html = "";
			var s_html_default = "Platform";
			for(var i = 0; i < platform_text.length; i++) {
				s = platform_text[i];
				s = s.replace(/ /g, "&nbsp;");
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			if (has_platform_other) {
				s_html += '<span class="box-other">' + platform_other.replace(/ /g, "&nbsp;") + '</span> ';
				$("#other_platform").removeClass("hidden");
			}
			$("#box_platform").html(s_html);
			if (s_html.length > 0) {					
				$("#box_platform").addClass("box-detail-padding");
			}
			else {
				$("#box_platform").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section file_type

		function other_selected_file_type(sel, des) {
			if (sel == 22) {
				$("#other_file_type").fadeIn(2000).removeClass("hidden");				
			}
			if (des == 22) {
				$("#publisher_product_file_type_other").val("");			
				$("#other_file_type").fadeOut(2000, function() {
					$(this).addClass("hidden");
				});	
			}
		}
		
		function set_file_type(file_type, has_file_type_other) {
			var e = document.getElementById("publisher_product_file_type");			
			for(var i = 0; i < file_type.length; i++) {
				if (file_type[i]) {
					e.options[i].setAttribute('selected','selected');
				}
			}
			if (has_file_type_other) {
				e.options[21].setAttribute('selected','selected');
			}
			else {
				e.options[21].selected = false;
				$("#other_file_type").addClass("hidden");
			}
			$("#publisher_product_file_type").trigger("chosen:updated");
		}

		function set_file_type_text(file_type_text, has_file_type_other, file_type_other) {
			var s = "";
			var s_html = "";
			var s_html_default = "File Type";
			for(var i = 0; i < file_type_text.length; i++) {
				s = file_type_text[i];
				s = s.replace(/ /g, "&nbsp;");
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			if (has_file_type_other) {
				s_html += '<span class="box-other">' + file_type_other.replace(/ /g, "&nbsp;") + '</span> ';
				$("#other_file_type").removeClass("hidden");
			}
			$("#box_file_type").html(s_html);
			if (s_html.length > 0) {					
				$("#box_file_type").addClass("box-detail-padding");
			}
			else {
				$("#box_file_type").removeClass("box-detail-padding");
			}
		}
		
	</script>

	<script>

	 	// *****
	 	// section by_review
		
		function other_selected_by_review(sel, des) {
			if (sel == 3) {
				$("#other_by_review").fadeIn(2000).removeClass("hidden");				
			}
			if (des == 3) {
				$("#publisher_product_by_review_other").val("");			
				$("#other_by_review").fadeOut(2000, function() {
					$(this).addClass("hidden");
				});	
			}
		}
		
		function set_by_review(by_review, has_by_review_other) {
			var e = document.getElementById("publisher_product_by_review");			
			for(var i = 0; i < by_review.length; i++) {
				if (by_review[i]) {
					e.options[i].setAttribute('selected','selected');
				}
			}
			if (has_by_review_other) {
				e.options[2].setAttribute('selected','selected');
			}
			else {
				e.options[2].selected = false;
				$("#other_by_review").addClass("hidden");
			}
			$("#publisher_product_by_review").trigger("chosen:updated");
		}

		function set_by_review_text(by_review_text, has_by_review_other, by_review_other) {
			var s = "";
			var s_html = "";
			for(var i = 0; i < by_review_text.length; i++) {
				s = by_review_text[i];
				s = s.replace(/ /g, "&nbsp;");
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			if (has_by_review_other) {
				s_html += '<span class="box-other">' + by_review_other.replace(/ /g, "&nbsp;") + '</span> ';
				$("#other_by_review").removeClass("hidden");
			}
			$("#box_by_review").html(s_html);
			if (s_html.length > 0) {					
				$("#box_by_review").addClass("box-detail-padding");
			}
			else {
				$("#box_by_review").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section enhancement

		function other_selected_enhancement(sel, des) {
			if (sel == 13) {
				$("#other_enhancement").fadeIn(2000).removeClass("hidden");				
			}
			if (des == 13) {
				$("#publisher_product_enhancement_other").val("");			
				$("#other_enhancement").fadeOut(2000, function() {
					$(this).addClass("hidden");
				});	
			}
		}
		
		function set_enhancement(enhancement, has_enhancement_other) {
			var e = document.getElementById("publisher_product_enhancement");			
			for(var i = 0; i < enhancement.length; i++) {
				if (enhancement[i]) {
					e.options[i].setAttribute('selected','selected');
				}
			}
			if (has_enhancement_other) {
				e.options[12].setAttribute('selected','selected');
			}
			else {
				e.options[12].selected = false;
				$("#other_enhancement").addClass("hidden");
			}
			$("#publisher_product_enhancement").trigger("chosen:updated");
		}

		function set_enhancement_text(enhancement_text, has_enhancement_other, enhancement_other) {
			var s = "";
			var s_html = "";
			var s_html_default = "Enhancement";
			for(var i = 0; i < enhancement_text.length; i++) {
				s = enhancement_text[i];
				s = s.replace(/ /g, "&nbsp;");
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			if (has_enhancement_other) {
				s_html += '<span class="box-other">' + enhancement_other.replace(/ /g, "&nbsp;") + '</span> ';
				$("#other_enhancement").removeClass("hidden");
			}
			$("#box_enhancement").html(s_html);
			if (s_html.length > 0) {					
				$("#box_enhancement").addClass("box-detail-padding");
			}
			else {
				$("#box_enhancement").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section from_age

		function set_from_age(from_age) {
			var elmnt = document.getElementById("publisher_product_from_age");
			for(var i = 0; i < from_age.length; i++) {
				if( from_age[i] ) {
					k = i + 1;
					for(var j = 0; j < elmnt.options.length; j++) {
				      if(elmnt.options[j].value == k)
				        elmnt.selectedIndex = j;
				    }			
					// var j = i + 1;
					// e.options[j].setAttribute('selected','selected');
				}
			}
			$("#publisher_product_from_age").trigger("chosen:updated");
		}
		
		function set_from_age_text(from_age_text) {
			s = "";
			s_html = "";
			s_html_default = "Age Range";
			for(var i = 0; i < from_age_text.length; i++) {
				s = from_age_text[i];
				s = s.replace(/ /g, "&nbsp;");
				// span_id = "id_span_box_2_" + i.toString();
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">Ages: ' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			$("#box_from_age").html(s_html);
			if (from_age_text.length > 0) {
				$("#box_from_age").addClass("box-detail-padding");
			}
			else {
				$("#box_from_age").removeClass("box-detail-padding");
			}
		}

		function set_age_range_text(from_age_text, to_age_text) {
			var s = "";
			var s_html = "";
			s_html_default = "";
			var s_from_age = "";
			var s_to_age = "";
			for(var i = 0; i < from_age_text.length; i++) {
				s = from_age_text[i];
				// s = s.replace(/ /g, "&nbsp;");
				if (s != "") {
					s_from_age = s;
				}
			}
			for(var i = 0; i < to_age_text.length; i++) {
				s = to_age_text[i];
				// s = s.replace(/ /g, "&nbsp;");
				if (s != "") {
					s_to_age = s;
				}
			}

			if ((s_from_age.length > 0) && (s_to_age.length > 0)) {
				s_html = '<span class="box-odd">Ages: ' + s_from_age + ' to ' + s_to_age + '</span> ';
				$("#box_age_range").addClass("box-detail-padding");
				$("#box_age_range").html(s_html);
			}
			else if ((s_from_age.length > 0) && !(s_to_age.length > 0)) {
				s_html = '<span class="box-odd">Ages: ' + s_from_age + '</span> ';
				$("#box_age_range").html(s_html);
				$("#box_age_range").addClass("box-detail-padding");
			}
			else {
				$("#box_age_range").html(s_html_default);
				$("#box_age_range").removeClass("box-detail-padding");
			}	
		}

	</script>

	<script>

	 	// *****
	 	// section to_age

		function set_to_age(to_age) {
			var b_zero = true;			
			var elmnt = document.getElementById("publisher_product_to_age");
			for(var i = 0; i < to_age.length; i++) {
				if( to_age[i] ) {
					k = i + 1;
					for(var j = 0; j < elmnt.options.length; j++) {
				      if(elmnt.options[j].value == k)
				        elmnt.selectedIndex = j;
				    }		
				    b_zero = false;	
					// var j = i + 1;
					// e.options[j].setAttribute('selected','selected');
				}
			}
			if (b_zero) {
				elmnt.selectedIndex = 0;
			}
			$("#publisher_product_to_age").trigger("chosen:updated");
		}
		
		function set_to_age_text(to_age_text) {
			s = "";
			s_html = "";
			s_html_default = "Age Range";
			for(var i = 0; i < to_age_text.length; i++) {
				s = to_age_text[i];
				s = s.replace(/ /g, "&nbsp;");
				// span_id = "id_span_box_2_" + i.toString();
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd"> to ' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			$("#box_to_age").html(s_html);
			if (to_age_text.length > 0) {
				$("#box_to_age").addClass("box-detail-padding");
			}
			else {
				$("#box_to_age").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section from_grade
		
		function set_from_grade(from_grade) {
			var elmnt = document.getElementById("publisher_product_from_grade");
			for(var i = 0; i < from_grade.length; i++) {
				if( from_grade[i] ) {
					k = i + 1;
					for(var j = 0; j < elmnt.options.length; j++) {
				      if(elmnt.options[j].value == k)
				        elmnt.selectedIndex = j;
				    }			
				}
			}
			$("#publisher_product_from_grade").trigger("chosen:updated");
		}
		
		function set_from_grade_text(from_grade_text) {
			s = "";
			s_html = "";
			s_html_default = "Grade Range";
			for(var i = 0; i < from_grade_text.length; i++) {
				s = from_grade_text[i];
				s = s.replace(/ /g, "&nbsp;");
				// span_id = "id_span_box_2_" + i.toString();
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			$("#box_from_grade").html(s_html);
			if (from_grade_text.length > 0) {
				$("#box_from_grade").addClass("box-detail-padding");
			}
			else {
				$("#box_from_grade").removeClass("box-detail-padding");
			}
		}

		function set_grade_range_text(from_grade_text, to_grade_text) {
			var s = "";
			var s_html = "";
			var s_html_default = "";
			var s_from_grade = "";
			var s_to_grade = "";
			for(var i = 0; i < from_grade_text.length; i++) {
				s = from_grade_text[i];
				// s = s.replace(/ /g, "&nbsp;");
				if (s != "") {
					s_from_grade = s;
				}
			}
			for(var i = 0; i < to_grade_text.length; i++) {
				s = to_grade_text[i];
				// s = s.replace(/ /g, "&nbsp;");
				if (s != "") {
					s_to_grade = s;
				}
			}

			if ((s_from_grade.length > 0) && (s_to_grade.length > 0)) {
				s_html = '<span class="box-odd">Grades: ' + s_from_grade + ' to ' + s_to_grade + '</span> ';
				$("#box_grade_range").addClass("box-detail-padding");
				$("#box_grade_range").html(s_html);
			}
			else if ((s_from_grade.length > 0) && !(s_to_grade.length > 0)) {
				s_html = '<span class="box-odd">Grades: ' + s_from_grade + '</span> ';
				$("#box_grade_range").html(s_html);
				$("#box_grade_range").addClass("box-detail-padding");
			}
			else {
				$("#box_grade_range").html(s_html_default);
				$("#box_grade_range").removeClass("box-detail-padding");
			}	
		}

	</script>

	<script>

	 	// *****
	 	// section to_grade
		
		function set_to_grade(to_grade) {
			var b_zero = true;
			var elmnt = document.getElementById("publisher_product_to_grade");
			for(var i = 0; i < to_grade.length; i++) {
				if( to_grade[i] ) {
					k = i + 1;
					for(var j = 0; j < elmnt.options.length; j++) {
				      if(elmnt.options[j].value == k)
				        elmnt.selectedIndex = j;
				    }			
				    b_zero = false;					    
				}
			}
			if (b_zero) {
				elmnt.selectedIndex = 0;
			}			
			$("#publisher_product_to_grade").trigger("chosen:updated");
		}
		
		function set_to_grade_text(to_grade_text) {
			s = "";
			s_html = "";
			s_html_default = "Grade Range";
			for(var i = 0; i < to_grade_text.length; i++) {
				s = to_grade_text[i];
				s = s.replace(/ /g, "&nbsp;");
				// span_id = "id_span_box_2_" + i.toString();
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			$("#box_to_grade").html(s_html);
			if (to_grade_text.length > 0) {
				$("#box_to_grade").addClass("box-detail-padding");
			}
			else {
				$("#box_to_grade").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section market_target

		// function set_market_target(market_target) {
			// var e = document.getElementById("publisher_product_manifest_market_target_index");
			// for(var i = 1; i < 3; i++) {
				// if( market_target[i] ) {
					// e.options[i].setAttribute('selected','selected');
				// }
			// }
			// $("#publisher_product_manifest_market_target_index").trigger("chosen:updated");
		// }


		function set_market_target(market_target) {
			var e = document.getElementById("publisher_product_market_target");
			for(var i = 0; i < market_target.length; i++) {
				if( market_target[i] ) {
					e.options[i].setAttribute('selected','selected');
				}
			}
			$("#publisher_product_market_target").trigger("chosen:updated");
		}
		
		function set_market_target_text(market_target_text) {
			s = "";
			s_html = "";
			s_html_default = "Market";
			for(var i = 0; i < market_target_text.length; i++) {
				s = market_target_text[i];
				s = s.replace(/ /g, "&nbsp;");
				// span_id = "id_span_box_2_" + i.toString();
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			$("#box_market_target").html(s_html);
			if (market_target_text.length > 0) {
				$("#box_market_target").addClass("box-detail-padding");
			}
			else {
				$("#box_market_target").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section pricing_model

		function set_pricing_model(pricing_model) {
			var e = document.getElementById("publisher_product_pricing_model");
			for(var i = 0; i < pricing_model.length; i++) {
				if( pricing_model[i] ) {
					e.options[i].setAttribute('selected','selected');
				}
			}
			$("#publisher_product_pricing_model").trigger("chosen:updated");
		}
		
		function set_pricing_model_text(pricing_model_text) {
			s = "";
			s_html = "";
			s_html_default = "Pricing Model";
			for(var i = 0; i < pricing_model_text.length; i++) {
				s = pricing_model_text[i];
				s = s.replace(/ /g, "&nbsp;");
				// span_id = "id_span_box_2_" + i.toString();
	 			if (i%2 == 0 ? true : false) {
	 				s_html += '<span class="box-odd">' + s + '</span> ';
	 			}
	 			else {
	 				s_html += '<span class="box-even">' + s + '</span> ';
	 			}
			}
			$("#box_pricing_model").html(s_html);
			if (pricing_model_text.length > 0) {
				$("#box_pricing_model").addClass("box-detail-padding");
			}
			else {
				$("#box_pricing_model").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section price

		// function format_to_currency(n, currency) {
		    // return currency + " " + n.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,");
		// }

		var val_input_price_1_saved = 0;
		var val_input_price_2_saved = 0;
		var val_input_price_3_saved = 0;
		var val_input_price_4_saved = 0;
		var val_input_price_5_saved = 0;
		var val_input_price_6_saved = 0;
		var val_input_price_7_saved = 0;
		var val_input_price_8_saved = 0;
		var val_input_price_9_saved = 0;
		var val_input_price_10_saved = 0;
		
		function set_price(price) {
			val_input_price_1_saved = price[1][1];
			val_input_price_2_saved = price[2][1];
			val_input_price_3_saved = price[3][1];
			val_input_price_4_saved = price[4][1];
			val_input_price_5_saved = price[5][1];
			val_input_price_6_saved = price[6][1];
			val_input_price_7_saved = price[7][1];
			val_input_price_8_saved = price[8][1];
			val_input_price_9_saved = price[9][1];
			val_input_price_10_saved = price[10][1];
			for( var i = 1; i < 11; i++ ) {
				var s_ch = "#ch_price_" + i.toString();
				var s_cb = "#cb_price_" + i.toString();
				var s_input = "#publisher_product_price_price_" + i.toString() + "_dec";
				var s_text = "#price_" + i.toString() + "_dec";
				var s_row = "#row_price_" + i.toString();

				if (price[i][0]) {
					$(s_ch).attr('checked', true);
					$(s_cb).addClass("cb-background");
					$(s_input).removeAttr('disabled');
					$(s_input).val(Number(price[i][1]).toFixed(2));

					$(s_text).html(Number(price[i][1]).toFixed(2));
					$(s_row).removeClass("hidden");					
				}
				else {
					$(s_ch).attr('checked', false);
					$(s_cb).removeClass("cb-background");
					$(s_input).val('');
					$(s_input).attr('disabled', 'disabled');
					$(s_row).addClass("hidden");
				}
			}
			if (price[11][0]) {
				$("#ch_price_11").attr('checked', true);
				$("#cb_price_11").addClass("cb-background");
				$("#row_price_11").removeClass("hidden");
			}
			else {
				$("#ch_price_11").attr('checked', false);
				$("#cb_price_11").removeClass("cb-background");
				$("#row_price_11").addClass("hidden");
			}
		}
		
		function verify_price_numeric() {
			var val_ch_price_1 = $("#ch_price_1").is(':checked');
			var input_publisher_product_price_price_1_dec = $("#publisher_product_price_price_1_dec").val();
			var val_ch_price_2 = $("#ch_price_2").is(':checked');
			var input_publisher_product_price_price_2_dec = $("#publisher_product_price_price_2_dec").val();
			var val_ch_price_3 = $("#ch_price_3").is(':checked');
			var input_publisher_product_price_price_3_dec = $("#publisher_product_price_price_3_dec").val();
			var val_ch_price_4 = $("#ch_price_4").is(':checked');
			var input_publisher_product_price_price_4_dec = $("#publisher_product_price_price_4_dec").val();
			var val_ch_price_5 = $("#ch_price_5").is(':checked');
			var input_publisher_product_price_price_5_dec = $("#publisher_product_price_price_5_dec").val();
			var val_ch_price_6 = $("#ch_price_6").is(':checked');
			var input_publisher_product_price_price_6_dec = $("#publisher_product_price_price_6_dec").val();
			var val_ch_price_7 = $("#ch_price_7").is(':checked');
			var input_publisher_product_price_price_7_dec = $("#publisher_product_price_price_7_dec").val();
			var val_ch_price_8 = $("#ch_price_8").is(':checked');
			var input_publisher_product_price_price_8_dec = $("#publisher_product_price_price_8_dec").val();
			var val_ch_price_9 = $("#ch_price_9").is(':checked');
			var input_publisher_product_price_price_9_dec = $("#publisher_product_price_price_9_dec").val();
			var val_ch_price_10 = $("#ch_price_10").is(':checked');
			var input_publisher_product_price_price_10_dec = $("#publisher_product_price_price_10_dec").val();

			var b_verify_price_1_dec = false;
			if (val_ch_price_1) {
				if ($.isNumeric( input_publisher_product_price_price_1_dec )) {
					if ( input_publisher_product_price_price_1_dec > 0.009 ) {
						b_verify_price_1_dec = true;
						$("#render_price_1").removeClass("check-required");
					}
				} 
			}
			else {
				$("#render_price_1").removeClass("check-required");
				b_verify_price_1_dec = true;
			}
			var b_verify_price_2_dec = false;
			if (val_ch_price_2) {
				if ($.isNumeric( input_publisher_product_price_price_2_dec )) {
					if ( input_publisher_product_price_price_2_dec > 0.009 ) {
						b_verify_price_2_dec = true;
						$("#render_price_2").removeClass("check-required");						
					}
				} 
			}
			else {
				$("#render_price_2").removeClass("check-required");
				b_verify_price_2_dec = true;
			}
			var b_verify_price_3_dec = false;
			if (val_ch_price_3) {
				if ($.isNumeric( input_publisher_product_price_price_3_dec )) {
					if ( input_publisher_product_price_price_3_dec > 0.009 ) {
						b_verify_price_3_dec = true;
						$("#render_price_3").removeClass("check-required");
					}
				} 
			}
			else {
				$("#render_price_3").removeClass("check-required");
				b_verify_price_3_dec = true;
			}
			var b_verify_price_4_dec = false;
			if (val_ch_price_4) {
				if ($.isNumeric( input_publisher_product_price_price_4_dec )) {
					if ( input_publisher_product_price_price_4_dec > 0.009 ) {
						b_verify_price_4_dec = true;
						$("#render_price_4").removeClass("check-required");
					}
				} 
			}
			else {
				$("#render_price_4").removeClass("check-required");
				b_verify_price_4_dec = true;
			}
			var b_verify_price_5_dec = false;
			if (val_ch_price_5) {
				if ($.isNumeric( input_publisher_product_price_price_5_dec )) {
					if ( input_publisher_product_price_price_5_dec > 0.009 ) {
						b_verify_price_5_dec = true;
						$("#render_price_5").removeClass("check-required");
					}
				} 
			}
			else {
				$("#render_price_5").removeClass("check-required");
				b_verify_price_5_dec = true;
			}
			var b_verify_price_6_dec = false;
			if (val_ch_price_6) {
				if ($.isNumeric( input_publisher_product_price_price_6_dec )) {
					if ( input_publisher_product_price_price_6_dec > 0.009 ) {
						b_verify_price_6_dec = true;
						$("#render_price_6").removeClass("check-required");
					}
				} 
			}
			else {
				$("#render_price_6").removeClass("check-required");
				b_verify_price_6_dec = true;
			}
			var b_verify_price_7_dec = false;
			if (val_ch_price_7) {
				if ($.isNumeric( input_publisher_product_price_price_7_dec )) {
					if ( input_publisher_product_price_price_7_dec > 0.009 ) {
						b_verify_price_7_dec = true;
						$("#render_price_7").removeClass("check-required");
					}
				} 
			}
			else {
				$("#render_price_7").removeClass("check-required");
				b_verify_price_7_dec = true;
			}
			var b_verify_price_8_dec = false;
			if (val_ch_price_8) {
				if ($.isNumeric( input_publisher_product_price_price_8_dec )) {
					if ( input_publisher_product_price_price_8_dec > 0.009 ) {
						b_verify_price_8_dec = true;
						$("#render_price_8").removeClass("check-required");
					}
				} 
			}
			else {
				$("#render_price_8").removeClass("check-required");
				b_verify_price_8_dec = true;
			}
			var b_verify_price_9_dec = false;
			if (val_ch_price_9) {
				if ($.isNumeric( input_publisher_product_price_price_9_dec )) {
					if ( input_publisher_product_price_price_9_dec > 0.009 ) {
						b_verify_price_9_dec = true;
						$("#render_price_9").removeClass("check-required");
					}
				} 
			}
			else {
				$("#render_price_9").removeClass("check-required");
				b_verify_price_9_dec = true;
			}
			var b_verify_price_10_dec = false;
			if (val_ch_price_10) {
				if ($.isNumeric( input_publisher_product_price_price_10_dec )) {
					if ( input_publisher_product_price_price_10_dec > 0.009 ) {
						b_verify_price_10_dec = true;
						$("#render_price_10").removeClass("check-required");
					}
				} 
			}
			else {
				$("#render_price_10").removeClass("check-required");
				b_verify_price_10_dec = true;
			}

			if (b_verify_price_1_dec &&
				b_verify_price_2_dec &&
				b_verify_price_3_dec &&
				b_verify_price_4_dec &&
				b_verify_price_5_dec &&
				b_verify_price_6_dec &&
				b_verify_price_7_dec &&
				b_verify_price_8_dec &&
				b_verify_price_9_dec &&
				b_verify_price_10_dec) {
				$("#price_error_msg").addClass("display-hidden");
			}
		}
		
	</script>

	<script>

	 	// *****
	 	// section updating_refresh_rate
		
	  	// jQuery.fn['any'] = function() {
	    	// return (this.length > 0);
	  	// };
		// function isRealValue(obj){
 			// return obj && obj !== "null" && obj!== "undefined";
		// }
    	// if(typeof(foo) !== 'undefined' && foo != null) {
    		// //you can use foo!
    	// }			  	
			  	
		function set_updating_refresh_rate(updating_refresh_rate) {
			var e = document.getElementById("publisher_product_manifest_updating_refresh_rate");
			var n_option;
			for(var i = 0; i < updating_refresh_rate.length; i++) {
				if (updating_refresh_rate[i] !== 'null' ) {
					alert(updating_refresh_rate[i]);
					n_option = updating_refresh_rate[i];
					e.options[n_option].setAttribute('selected','selected');
				}
			}
			$("#publisher_product_manifest_updating_refresh_rate").trigger("chosen:updated");
		}

	</script>

	<script>

	 	// *****
	 	// section updating_type

		function set_updating_type(updating_type) {
			var e = document.getElementById("publisher_product_manifest_updating_type");
			var n_option;
			for(var i = 0; i < updating_type.length; i++) {
				if (updating_type[i] !== 'null' ) {
					alert(updating_type[i]);
					n_option = updating_type[i];
					e.options[n_option].setAttribute('selected','selected');
				}
			}
			$("#publisher_product_manifest_updating_type").trigger("chosen:updated");
		}

	</script>

	<script>

	 	// *****
	 	// section character

		function set_character(character) {
			var e = document.getElementById("publisher_product_manifest_character");
			for(var i = 1; i < character.length; i++) {
				if( character[i] ) {
					e.options[i].setAttribute('selected','selected');
				}
			}
			$("#publisher_product_manifest_character").trigger("chosen:updated");
		}

	</script>

	<script>

	 	// *****
	 	// section core_literacy_standard

		function set_core_literacy_standard(standard) {
			// alert(standard.length);
			var e = "";
			var s = "";
			var sb = "";
			for(var i = 0; i < standard.length; i++) {
				// alert(standard[i]);
				s = "ch_core_literacy_standard_" + standard[i].toString();
				sb = "#cb_core_literacy_standard_" + standard[i].toString();
				e = document.getElementById(s);
				e.setAttribute('checked','checked');
				$(sb).addClass("cb-background");
			}
		}	
		
		function set_core_literacy_standard_text(core_literacy_standard_text) {
			// alert("set_core_literacy_standard_text");
			// if (category_subject_text.length > 0) {
				s = "";
				s_html = "";
				// span_id = "";
				for(var i = 0; i < core_literacy_standard_text.length; i++) {
					s = core_literacy_standard_text[i];
					// s = s.replace(/ /g, "&nbsp;");
					// span_id = "id_span_box_2_" + i.toString();
		 			if (i%2 == 0 ? true : false) {
		 				s_html += '<span class="box-odd">' + s + '</span><br> ';
		 			}
		 			else {
		 				s_html += '<span class="box-even">' + s + '</span><br> ';
		 			}
				}
				
				$("#box_core_literacy_standard").html(s_html);
				
				if (core_literacy_standard_text.length > 0) {
					$("#box_core_literacy_standard").addClass("box-detail-padding");
				}
				else {
					$("#box_core_literacy_standard").removeClass("box-detail-padding");
				}
				
			// }
		}

	</script>

	<script>

	 	// *****
	 	// section core_math_standard

		function set_core_math_standard(standard) {
			// alert(standard.length);
			var e = "";
			var s = "";
			var sb = "";
			for(var i = 0; i < standard.length; i++) {
				// alert(standard[i]);
				s = "ch_core_math_standard_" + standard[i].toString();
				sb = "#cb_core_math_standard_" + standard[i].toString();
				e = document.getElementById(s);
				e.setAttribute('checked','checked');
				$(sb).addClass("cb-background");
			}
		}	
		
		function set_core_math_standard_text(core_math_standard_text) {
			// alert("set_core_math_standard_text");
			// if (category_subject_text.length > 0) {
				s = "";
				s_html = "";
				// span_id = "";
				for(var i = 0; i < core_math_standard_text.length; i++) {
					s = core_math_standard_text[i];
					// s = s.replace(/ /g, "&nbsp;");
					// span_id = "id_span_box_2_" + i.toString();
		 			if (i%2 == 0 ? true : false) {
		 				s_html += '<span class="box-odd">' + s + '</span><br> ';
		 			}
		 			else {
		 				s_html += '<span class="box-even">' + s + '</span><br> ';
		 			}
				}
				
				$("#box_core_math_standard").html(s_html);
				
				if (core_math_standard_text.length > 0) {
					$("#box_core_math_standard").addClass("box-detail-padding");
				}
				else {
					$("#box_core_math_standard").removeClass("box-detail-padding");
				}
				
			// }
		}

	</script>

	<script>

	 	// *****
	 	// section allow_teacher_rating

		function set_allow_teacher_rating(b_allow_teacher_rating) {
			var s_html ="";
			if(b_allow_teacher_rating) {
				s_html = "Yes";
			}
			else {
				s_html = "No";
			}
			$("#box_allow_teacher_rating span").html(s_html);
			if (s_html.length > 0) {
				$("#box_allow_teacher_rating").addClass("box-detail-padding");
			}
			else {
				$("#box_allow_teacher_rating").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section allow_student_likes

		function set_allow_student_likes(b_allow_student_likes) {
			var s_html ="";
			if(b_allow_student_likes) {
				s_html = "Yes";
			}
			else {
				s_html = "No";
			}
			$("#box_allow_student_likes span").html(s_html);
			if (s_html.length > 0) {
				$("#box_allow_student_likes").addClass("box-detail-padding");
			}
			else {
				$("#box_allow_student_likes").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section allow_comments

		function set_allow_comments(b_allow_comments) {
			var s_html ="";
			if(b_allow_comments) {
				s_html = "Yes";
			}
			else {
				s_html = "No";
			}
			$("#box_allow_comments span").html(s_html);
			if (s_html.length > 0) {
				$("#box_allow_comments").addClass("box-detail-padding");
			}
			else {
				$("#box_allow_comments").removeClass("box-detail-padding");
			}
		}

	</script>

	<script>

	 	// *****
	 	// section poster_print_purchase

		function set_poster_print_purchase(b_poster_print_purchase) {
			var s_html ="";
			if(b_poster_print_purchase) {
				s_html = "Yes";
			}
			else {
				s_html = "No";
			}
			$("#box_poster_print_purchase span").html(s_html);
			if (s_html.length > 0) {
				$("#box_poster_print_purchase").addClass("box-detail-padding");
			}
			else {
				$("#box_poster_print_purchase").removeClass("box-detail-padding");
			}
			
			
			var s_purchased = "n/a";
			var s_public = "n/a";
			var s_options = "n/a";
			if(b_poster_print_purchase) {
				//
			}
			else {
				//
			}
			$("#box_status_square").html(s_html);		
			$("#box_status_square_purchased").html(s_purchased);
			$("#box_status_square_public").html(s_public);
			$("#box_status_square_options").html(s_options);
		}

	</script>

	<script>

	 	// *****
	 	// section poster_pin_web

		function set_poster_pin_web(b_poster_pin_web) {
			var s_html ="";
			if(b_poster_pin_web) {
				s_html = "Yes";
			}
			else {
				s_html = "No";
			}
			$("#box_poster_pin_web span").html(s_html);
			if (s_html.length > 0) {
				$("#box_poster_pin_web").addClass("box-detail-padding");
			}
			else {
				$("#box_poster_pin_web").removeClass("box-detail-padding");
			}
			
			var s_purchased = "n/a";
			var s_public = "n/a";
			var s_options = "n/a";
			if(b_poster_pin_web) {
				//
			}
			else {
				//
			}
			$("#box_status_pin_web").html(s_html);		
			$("#box_status_pin_web_purchased").html(s_purchased);
			$("#box_status_pin_web_public").html(s_public);
			$("#box_status_pin_web_options").html(s_options);			
		}

	</script>

	<script>

	 	// *****
	 	// section poster_pin_purchase

		function set_poster_pin_purchase(b_poster_pin_purchase) {
			var s_html ="";
			if(b_poster_pin_purchase) {
				s_html = "Yes";
			}
			else {
				s_html = "No";
			}
			$("#box_poster_pin_purchase span").html(s_html);
			if (s_html.length > 0) {
				$("#box_poster_pin_purchase").addClass("box-detail-padding");
			}
			else {
				$("#box_poster_pin_purchase").removeClass("box-detail-padding");
			}
			
			var s_purchased = "n/a";
			var s_public = "n/a";
			var s_options = "n/a";
			if(b_poster_pin_purchase) {
				//
			}
			else {
				//
			}
			$("#box_status_pin_print").html(s_html);		
			$("#box_status_pin_print_purchased").html(s_purchased);
			$("#box_status_pin_print_public").html(s_public);
			$("#box_status_pin_print_options").html(s_options);						
		}

	</script>

	<script>

	 	// *****
	 	// section lesson_time

		function set_lesson_time(time_per_lesson, lesson_time_hours, lesson_time_minutes) {
			var s_hours = "";
			var s_minutes = "";
			var s_html =  "";
			if( time_per_lesson ) {
				$("#number_lesson_time_hours").val(lesson_time_hours);
				$("#number_lesson_time_minutes").val(lesson_time_minutes);
				var s_hours = lesson_time_hours.toString();
				var s_minutes = lesson_time_minutes.toString();
				var s_html =  '<div style="height: 4px;"></div>' +
							  '<div class="box-lesson-time">' +
								'<div class="box-lesson-time-1"><span>Lesson Time</span></div>' +
								'<div class="box-lesson-time-2"><span>Hours:</span></div>' +
								'<div class="box-lesson-time-3"><span>' + s_hours + '</span></div>' +
								'<div class="box-lesson-time-4"><span>Minutes:</span></div>' +
								'<div class="box-lesson-time-5"><span>' + s_minutes + '</span></div>' +
							  '</div>';
			}
			$("#box_lesson_time").html(s_html);
		}

	</script>

	<script>

	 	// *****
	 	// section course_time

		function set_course_time(time_per_course, course_time_months, course_time_days) {
			var s_months = "";
			var s_days = "";
			var s_html =  "";
			if( time_per_course ) {
				$("#number_course_time_months").val(course_time_months);
				$("#number_course_time_days").val(course_time_days);
				var s_months = course_time_months.toString();
				var s_days = course_time_days.toString();
				var s_html =  '<div style="height: 4px;"></div>' +
							  '<div class="box-course-time">' +
								'<div class="box-course-time-1"><span>Course Time</span></div>' +
								'<div class="box-course-time-2"><span>Months:</span></div>' +
								'<div class="box-course-time-3"><span>' + s_months + '</span></div>' +
								'<div class="box-course-time-4"><span>Days:</span></div>' +
								'<div class="box-course-time-5"><span>' + s_days + '</span></div>' +
							  '</div>';
			}
			$("#box_course_time").html(s_html);
		}
				
	</script>

	<script>

	 	// *****
	 	// section user_rating
				
		function set_user_rating(user_rating) {
			var ii = 0;
			for(var i = 0; i < user_rating.length; i++) {
				ii = i + 1;
				if( user_rating[i] ) {
					$("#publisher_product_manifest_user_rating option[value='"+ ii.toString() +"']").prop("selected", true);
				}
				else {
					$("#publisher_product_manifest_user_rating option[value='"+ ii.toString() +"']").prop("selected", false);
				}
			}
			$("#publisher_product_manifest_user_rating").trigger("chosen:updated");
			// if( $("#ch_publisher_product_manifest_allow_teacher_rating").is(':checked') ) {
				// // $("#publisher_product_manifest_user_rating").prop('disabled', false).trigger("chosen:updated");	
				// $("#publisher_product_manifest_user_rating").prop('disabled', false);	
			// }
			// else {
				// $("#publisher_product_manifest_user_rating").prop('disabled', true);						
			// }
		}
		
	</script>

	<script>

	 	// *****
	 	// section research
		
		function set_research(research) {
			// alert(research); 
			var ii = 0;
			for(var i = 0; i < research.length; i++) {
				ii = i + 1;
				if( research[i] ) {
					$("#publisher_product_manifest_research option[value='"+ ii.toString() +"']").prop("selected", true);
				}
				else {
					$("#publisher_product_manifest_research option[value='"+ ii.toString() +"']").prop("selected", false);
				}
			}
			$("#publisher_product_manifest_research").trigger("chosen:updated");
		}
		
	</script>

	<script>

	 	// *****
	 	// section public_relations
		
		function set_public_relations(public_relations) {
			// alert("public_relations");
			var s = "";
			var ii = 0;
			for(var i = 0; i < public_relations.length; i++) {
				ii = i + 1;
				s = "#ch_publisher_product_manifest_pr_updates_" + ii.toString();
				$(s).attr('checked', public_relations[i]);
			}
		}		
		
	</script>

	<script>

	 	// *****
	 	// section metrics
		
		function set_metrics(metrics) {
			// alert("public_relations");
			var s = "";
			var ii = 0;
			for(var i = 0; i < metrics.length; i++) {
				ii = i + 1;
				s = "#ch_publisher_product_manifest_metrics_" + ii.toString();
				$(s).attr('checked', metrics[i]);
			}
		}		

	</script>

	<script>

	 	// *****
	 	// section general checkboxes

		function set_cb_init(cb, cc) {
			var sb = "#" + cb;
			var sc = "#" + cc;
			if($(sb).is(':checked')) {
				$(sc).addClass("cb-background");
			}
			else {
				$(sc).removeClass("cb-background");
			}					
		}
		
		function set_cb(cb, cc) {
			var sb = "#" + cb;
			var sc = "#" + cc;
			if($(sb).is(':checked')) {
				$(sb).prop('checked', false);
				$(sc).removeClass("cb-background");
			}
			else {
				$(sb).prop('checked', true);
				$(sc).addClass("cb-background");
			}					
		}
		
	</script>

	<script>

	 	// *****
	 	// section images

		function closeCropImage_1() {
			$("#close_form15").trigger('click');
			$("#dvLoading_15").addClass("dvLoading-display-none");			
		};	  

		
		function closeAddProductLogo() {
			$("#close_form1").trigger('click');
		};	  
		
		function closeShowImage() {
			$("#close_form5").trigger('click');
		};	  

		function closeShowProduct1Image() {
			$("#close_form22").trigger('click');			
		};	  		


		function closeShowProduct2Image() {
			$("#close_form32").trigger('click');			
		};	  		
		function closeAddProduct1Image() {
			$("#close_form31").trigger('click');
			$("#dvLoading_31").addClass("dvLoading-display-none");			
		};	  
		
		function closeShowCorporateLogo() {
			$("#close_form82").trigger('click');			
		};	  		
		function closeAddCorporateLogo() {
			$("#close_form81").trigger('click');
			$("#dvLoading_81").addClass("dvLoading-display-none");			
		};	  
		
	</script>

	<script>


		function renderListingPreview(cntrl) {
			var path = '/publisher_product_manifests/update_listing_preview';
			if(cntrl == null) {
				cntrl = 0;				
			}

			var formData = { publisher_product_id: <%= @publisher_product_id %>,
							 control: cntrl 
						   };
						   
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: path,	
		    	// cache: false,		    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
            	},
            	success: function(data) {
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		

	 	// *****
	 	// section ready / load

		$(window).load( function() {
		// $(document).ready(function(){


			$("#form_listing").removeClass("preview-pos-load").addClass("preview-pos-ready").addClass("display-none-listing");

			$("#close_listing").click(function(){
		    	$("#form_listing").slideUp(400, function(){
		    		$("#close_listing").addClass("hidden");
		    		$("#open_listing").removeClass("hidden");
		    	});				
		  	});
		  	$("#open_listing").click(function(){
		    	$("#form_listing").slideDown(400, function(){
		    		$("#open_listing").addClass("hidden");
		    		$("#close_listing").removeClass("hidden");
		    	});
		  	});	



			// $(".chosen-select").chosen(); 
			// $(".chosen-select").chosen({
				// no_results_text: "no results found" 
			// }); 

			$(".chosen-select").chosen({
				disable_search_threshold: 100
			});


		 	// *****
		 	// section dialogs

			$('#dialog_12').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_12').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_12').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_13').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_13').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_13').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_14').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_14').animate(
						{bottom:'-=210', top:'+=210'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_14').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		


			$('#dialog_22').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_22').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_22').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_23').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_23').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_23').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_24').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_24').animate(
						{bottom:'-=210', top:'+=210'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_24').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		


			$('#dialog_32').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_32').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_32').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_33').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_33').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_33').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_34').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_34').animate(
						{bottom:'-=210', top:'+=210'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_34').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_42').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_42').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_42').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_43').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-220px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_43').animate(
						{bottom:'-=230', top:'+=230'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_43').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			$('#dialog_44').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_44').animate(
						{bottom:'-=210', top:'+=210'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_44').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
						}
					);
				}
			}); 		

			// $(".figure-logo-generic").on('click', function() {
				// $(".dialog-1").trigger('click');
			// });
			$(".dialog-1").on('click', function() {
				$("#dialog_1").focus();				
				$("#dialog_1").jqmShow();
			});
			$('#dialog_1').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-740px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					hash.w.show();
					$('#dialog_1').animate(
						{bottom:'-=800', top:'+=800'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_1').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
							// $('#dl_email').focus();
						}
					);
				}
			}); 		

			$(".dialog-2").on('click', function() {
				$("#dialog_2").jqmShow();
			});
			$('#dialog_2').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-740px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_2').animate(
						{bottom:'-=800', top:'+=800'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_2').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
							// $('#dl_email').focus();
						}
					);
				}
			}); 		

			$(".dialog-5-figure").on('click', function(e) {
				if ( e.target.nodeName == "IMG" ) {
					var this_src = $(this).find("input.x-container-hidden").attr("value");
					$("#profile_figure_dialog").find("img").attr("src", this_src );
					var this_delete = $(this).find("div.tip-top-center").html();
					$("#profile_figure_dialog").find("div.tip-top-center").html(this_delete);
					$("#dialog_5").jqmShow();	
				}
			});
			$('#dialog_5').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '60px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					var img = $("#profile_figure_dialog img");
					$("<img/>")
			    		.attr("src", $(img).attr("src"))
			    		.load(function() {
			        		img_width = this.width; 
			        		$("#profile_figure_dialog").css({
			        			width : this.width
			        	});	        		
			    	});		
				}
			}); 		

			$(".dialog-5-figure-listing").on('click', function(e) {
				if ( e.target.nodeName == "IMG" ) {
					var this_src = $(this).find("input.x-container-hidden").attr("value");
					$("#profile_figure_dialog_listing").find("img").attr("src", this_src );
					// $(this).find("img").attr("src", this_src );
					// var this_delete = $(this).find("div.tip-top-center").html();
					// $("#profile_figure_dialog_listing").find("div.tip-top-center").html(this_delete);
					$("#dialog_5_listing").jqmShow();	
				}
			});
			$('#dialog_5_listing').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '60px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					var img = $("#profile_figure_dialog_listing img");
					$("<img/>")
			    		.attr("src", $(img).attr("src"))
			    		.load(function() {
			        		img_width = this.width; 
			        		$("#profile_figure_dialog_listing").css({
			        			width : this.width
			        	});	        		
			    	});		
				}
			}); 		

			// section dialogs
		 	// *****



		 	// *****
		 	// section price

    		$("#span_price_1").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_1").click();
    		});				
			$("#span_price_1").on('click', function() {
				// $("#ch_price_1");
			});

			// section price
		 	// *****


		 	// *****
		 	// section images

			$("#new_publisher_product_logo").on('submit', function() {
				$("#dvLoading_1").removeClass("dvLoading-display-none");
				// $('#dvLoading').fadeOut(2000);				
			});	

			$("#new_publisher_product1_image").on('submit', function() {
				$("#dvLoading_21").removeClass("dvLoading-display-none");
			});	

			$("#new_publisher_product2_image").on('submit', function() {
				$("#dvLoading_31").removeClass("dvLoading-display-none");
			});	

			// $("#new_publisher_product_pdf_image").on('submit', function() {
				// $("#dvLoading_51").removeClass("dvLoading-display-none");
			// });	
			// $("#new_publisher_product_pdf").on('submit', function() {
				// $("#dvLoading_52").removeClass("dvLoading-display-none");
			// });	

			$("#new_publisher_product_corporate_logo").on('submit', function() {
				$("#dvLoading_81").removeClass("dvLoading-display-none");
			});	

			// section images
		 	// *****

			var gon_updating_refresh_rate = gon.updating_refresh_rate;
			set_updating_refresh_rate(gon_updating_refresh_rate);

			var gon_updating_type = gon.updating_type;
			set_updating_type(gon_updating_type);

			var gon_character = gon.character;
			set_character(gon_character);

			var gon_reselling = gon.reselling;
			$("#ch_publisher_product_manifest_reselling").attr('checked', gon_reselling);

			var gon_evaluation = gon.evaluation;
			$("#ch_publisher_product_manifest_evaluation").attr('checked', gon_evaluation);
			
			var gon_user_rating = gon.user_rating;
			set_user_rating(gon_user_rating);
			
			var gon_research = gon.research;
			set_research(gon_research);

			var gon_public_relations = gon.public_relations;
			set_public_relations(gon_public_relations);

			var gon_metrics = gon.metrics;
			set_metrics(gon_metrics);
			
			if(<%= @b_source_url %>) {
				$("#render_source_url").html("");
			}
			else {
				$("#render_source_url").addClass("check-required");
			}
			if(<%= @b_updating_refresh_rate %>) {
				$("#render_updating_refresh_rate").html("");
			}
			else {
				$("#render_updating_refresh_rate").addClass("check-required");
			}
			if(<%= @b_updating_type %>) {
				$("#render_updating_type").html("");
			}
			else {
				$("#render_updating_type").addClass("check-required");
			}
			if(<%= @b_character %>) {
				$("#render_character").html("");
			}
			else {
				$("#render_character").addClass("check-required");
			}
			if(<%= @b_research %>) {
				$("#render_research").html("");
			}
			else {
				$("#render_research").addClass("check-required");
			}
    		
    		$("#submit_source_url").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_source_url").click();
    		});				
    		$("#submit_updating_refresh_rate").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_updating_refresh_rate").click();
    		});				
    		$("#submit_updating_type").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_updating_type").click();
    		});				
    		$("#submit_character").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_character").click();
    		});				
    		$("#submit_reselling").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_reselling").click();
    		});				
    		$("#submit_evaluation").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_evaluation").click();
    		});				
    		$("#submit_research").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_research").click();
    		});				
    		$("#submit_public_relations").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_public_relations").click();
    		});				
    		$("#submit_metrics").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_metrics").click();
    		});				
    					
    		$("#submit_word_description").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_word_description").click();
    		});				


			set_control_span("name_product", gon.name_product, gon.b_name_product);
			set_control_required("name_product", gon.b_required_name_product);

			set_control_span("product_tagline", gon.product_tagline, gon.b_product_tagline);
			set_control_required("product_tagline", gon.b_required_product_tagline);

			set_control_span("versions", gon.versions, gon.b_versions);
			set_control_required("versions", gon.b_required_versions);




  			$("#publisher_product_content_type").on('change', function(evt, params) {
  				other_selected_content_type(params.selected, params.deselected);
  			});
			var gon_content_type = gon.content_type;
			set_content_type(gon.content_type, gon.has_content_type_other);
			var gon_content_type_text = gon.content_type_text;
			set_content_type_text(gon_content_type_text, gon.has_content_type_other, gon.content_type_other);
			set_control_required("content_type", gon.b_required_content_type);			
			$("#open_edit_content_type").click(function(){
		    	$("#publisher_product_content_type_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_content_type, #open_edit_content_type").fadeOut(300, function(){
	    			$("#show_content_type").addClass("hidden");
	    			$("#open_edit_content_type").addClass("visibility-hidden");
	    			$("#edit_content_type").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_content_type").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_content_type").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_content_type").click();
    		});		
    		$("#cancel_content_type").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_content_type").click();
    		});		
			$("#cancel_content_type").on('click', function() {
				show_control("content_type");
			});
			$("#close_info_content_type").click(function(){
		    	$("#form_info_content_type_a").fadeOut(700, function(){ $("#form_info_content_type").slideUp(400) });
		  	});
		  	$("#open_info_content_type").click(function(){
		    	$("#form_info_content_type").slideDown(400, function(){ $("#form_info_content_type_a").fadeIn( 2000 ) });
		  	});	    
			$("#submit_content_type").on('click', function() {
				var input_publisher_product_content_type = $("#publisher_product_content_type").val();
				var input_publisher_product_content_type_other = $("#publisher_product_content_type_other").val();
				var content_type_other_b = false;
				if (input_publisher_product_content_type_other.length > 0) {
					content_type_other_b = true;
				}
				var obj_list = '{  "publisher_product_id":' + <%= @publisher_product_id %> +  
							   ',  "content_type":"' + input_publisher_product_content_type + 
							   '", "content_type_other_b":' + content_type_other_b + 
							   ',  "content_type_other":"' + input_publisher_product_content_type_other +
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_content_type',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_content_type(data.content_type, data.has_content_type_other);
						set_content_type_text(data.content_type_text, data.has_content_type_other, data.content_type_other);
						show_control("content_type");
						set_control_required("content_type", data.b_required);						
						// $("#focus_30").focus();
						// set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});


  			$("#publisher_product_category_subject").on('change', function(evt, params) {
  				other_selected_category_subject(params.selected, params.deselected);
  			});
			var gon_category_subject = gon.category_subject;
			set_category_subject(gon.category_subject, gon.has_category_subject_other);
			var gon_category_subject_text = gon.category_subject_text;
			set_category_subject_text(gon_category_subject_text, gon.has_category_subject_other, gon.category_subject_other);
			set_control_required("category_subject", gon.b_required_category_subject);			
			$("#open_edit_category_subject").click(function(){
		    	$("#publisher_product_category_subject_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_category_subject, #open_edit_category_subject").fadeOut(300, function(){
	    			$("#show_category_subject").addClass("hidden");
	    			$("#open_edit_category_subject").addClass("visibility-hidden");
	    			$("#edit_category_subject").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_category_subject").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_category_subject").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_category_subject").click();
    		});		
    		$("#cancel_category_subject").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_category_subject").click();
    		});	
			$("#cancel_category_subject").on('click', function() {
				show_control("category_subject");
			});    			
			$("#close_info_category_subject").click(function(){
		    	$("#form_info_category_subject_a").fadeOut(700, function(){ $("#form_info_category_subject").slideUp(400) });
		  	});
		  	$("#open_info_category_subject").click(function(){
		    	$("#form_info_category_subject").slideDown(400, function(){ $("#form_info_category_subject_a").fadeIn( 2000 ) });
		  	});	    		
			$("#submit_category_subject").on('click', function() {
				var input_publisher_product_category_subject = $("#publisher_product_category_subject").val();
				var input_publisher_product_category_subject_other = $("#publisher_product_category_subject_other").val();
				var category_subject_other_b = false;
				if (input_publisher_product_category_subject_other.length > 0) {
					category_subject_other_b = true;
				}				
				var obj_list = '{  "publisher_product_id":' + <%= @publisher_product_id %> +  
							   ',  "category_subject":"' + input_publisher_product_category_subject +
							   '", "category_subject_other_b":' + category_subject_other_b + 
							   ',  "category_subject_other":"' + input_publisher_product_category_subject_other +
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_category_subject',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_category_subject(data.category_subject, data.has_category_subject_other);
						set_category_subject_text(data.category_subject_text, data.has_category_subject_other, data.category_subject_other);
						show_control("category_subject");
						set_control_required("category_subject", data.b_required);		
						renderListingPreview("category_subject");
						// $("#focus_27").focus();	
						// set_updated(data.updated);												
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});



			// if(<#%= @b_topic %#>) {
				// $("#render_topic").html("");
			// }
			// else {
				// $("#render_topic").addClass("check-required");
			// }
    		// $("#submit_topic").keypress(function(e){
      			// if(e.keyCode==13)
      			// $("#submit_topic").click();
    		// });				
    		// $("#submit_topic").on('click', function() {
    			// $("#submit_topic_hidden").trigger("click");
    		// });
			set_control_required("topic", <%= @b_required_topic %>);
			// if(<#%= @b_topic %#>) {
				// $("#render_topic").html("");
			// }
			// else {
				// $("#render_topic").addClass("check-required");
			// }
    		$("#submit_topic").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_topic").click();
    		});	
			// $("#submit_topic").on('click', function() {
				// $("#submit_topic_hidden").trigger('click');
			// });
    		$("#cancel_topic").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_topic").click();
    		});
			$("#cancel_topic").on('click', function() {
				show_control("topic");
			});
			$("#open_edit_topic").click(function(){
	    		$("#show_topic, #open_edit_topic").fadeOut(300, function(){
	    			$("#show_topic").addClass("hidden");
	    			$("#open_edit_topic").addClass("visibility-hidden");
	    			$("#edit_topic").fadeIn(1300).removeClass("hidden");
					showEditStory11();	    			
	    			$("#topic").focus();
	    		});
		  	});
			$("#close_info_topic").click(function(){
		    	$("#form_info_topic_a").fadeOut(700, function(){ $("#form_info_topic").slideUp(400) });
		  	});
		  	$("#open_info_topic").click(function(){
		    	$("#form_info_topic").slideDown(400, function(){ $("#form_info_topic_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_topic").on('click', function() {
				var input_publisher_product_topic = $("#textarea_topic_edit").html().replace(/\t/g, '\\t');				
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "topic":"' + input_publisher_product_topic + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_topic',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						story_11_topic_html = data.topic;
						initRenderTextareaStory11();
						show_control("topic");
						set_control_required("topic", data.b_required);						
	            		
	            		
						// if (data.topic.length > 0) {      		
							// $("#publisher_product_manifest_topic").attr("value", data.topic);
							// $("#render_topic").removeClass("check-required");
							// $("#render_topic").addClass("check-affirm");
						// }
						// else {
							// $("#publisher_product_manifest_topic").attr("value", "");
							// $("#render_topic").addClass("check-required");
							// $("#render_topic").removeClass("check-affirm");
						// }							
						// $("#focus_15").focus();
						// set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});




			// if(<#%= @b_lesson_plan_subject %#>) {
				// $("#render_lesson_plan_subject").html("");
			// }
			// else {
				// $("#render_lesson_plan_subject").addClass("check-required");
			// }
			// set_control_required("lesson_plan_subject", <#%= @b_required_lesson_plan_subject %#>);
    		$("#submit_lesson_plan_subject").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_lesson_plan_subject").click();
    		});
    		// $("#submit_lesson_plan_subject").on('click', function() {
    			// $("#submit_lesson_plan_subject_hidden").trigger("click");
    		// });
    		$("#cancel_lesson_plan_subject").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_lesson_plan_subject").click();
    		});	
			$("#cancel_lesson_plan_subject").on('click', function() {
				show_control("lesson_plan_subject");
			});
			$("#open_edit_lesson_plan_subject").click(function(){
	    		$("#show_lesson_plan_subject, #open_edit_lesson_plan_subject").fadeOut(300, function(){
	    			$("#show_lesson_plan_subject").addClass("hidden");
	    			$("#open_edit_lesson_plan_subject").addClass("visibility-hidden");
	    			$("#edit_lesson_plan_subject").fadeIn(1300).removeClass("hidden");
	    			showEditStory12();	    			
	    			$("#lesson_plan_subject").focus();
	    		});
		  	});    		
			$("#close_info_lesson_plan_subject").click(function(){
		    	$("#form_info_lesson_plan_subject_a").fadeOut(700, function(){ $("#form_info_lesson_plan_subject").slideUp(400) });
		  	});
		  	$("#open_info_lesson_plan_subject").click(function(){
		    	$("#form_info_lesson_plan_subject").slideDown(400, function(){ $("#form_info_lesson_plan_subject_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_lesson_plan_subject").on('click', function() {
				var input_publisher_product_subject = $("#textarea_lesson_plan_subject_edit").html().replace(/\t/g, '\\t');				
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "subject":"' + input_publisher_product_subject + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_lesson_plan_subject',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						story_12_lesson_plan_subject_html = data.subject;
						initRenderTextareaStory12();
						show_control("lesson_plan_subject");
						// set_control_required("lesson_plan_subject", data.b_required);						
						// if (data.lesson_plan_subject.length > 0) {      		
							// $("#publisher_product_manifest_lesson_plan_subject").attr("value", data.lesson_plan_subject);
							// $("#render_lesson_plan_subject").removeClass("check-required");
							// $("#render_lesson_plan_subject").addClass("check-affirm");
						// }
						// else {
							// $("#publisher_product_manifest_lesson_plan_subject").attr("value", "");
							// $("#render_lesson_plan_subject").removeClass("check-affirm");
							// $("#render_lesson_plan_subject").addClass("check-required");
						// }							
						// $("#focus_51").focus();
						// set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});
			
















			// set_control_required("lesson_time", <#%= @b_required_lesson_time %#>);
    		// $("#submit_lesson_time").keypress(function(e){
      			// if(e.keyCode==13)
      			// $("#submit_lesson_time").click();
    		// });
    		// $("#submit_lesson_time").on('click', function() {
    			// $("#submit_lesson_time_hidden").trigger("click");
    		// });
    		// $("#cancel_lesson_time").keypress(function(e){
      			// if(e.keyCode==13)
      			// $("#cancel_lesson_time").click();
    		// });	
			$("#cancel_lesson_time").on('click', function() {
				show_control("lesson_time");
			});
			$("#open_edit_lesson_time").click(function(){
	    		$("#show_lesson_time, #open_edit_lesson_time").fadeOut(300, function(){
	    			$("#show_lesson_time").addClass("hidden");
	    			$("#open_edit_lesson_time").addClass("visibility-hidden");
	    			$("#edit_lesson_time").fadeIn(1300).removeClass("hidden");
	    		});
		  	});    		
			$("#close_info_lesson_time").click(function(){
		    	$("#form_info_lesson_time_a").fadeOut(700, function(){ $("#form_info_lesson_time").slideUp(400) });
		  	});
		  	$("#open_info_lesson_time").click(function(){
		    	$("#form_info_lesson_time").slideDown(400, function(){ $("#form_info_lesson_time_a").fadeIn( 2000 ) });
		  	});	



			var gon_time_per_lesson = gon.time_per_lesson;
			var gon_lesson_time_hours = gon.lesson_time_hours;
			var gon_lesson_time_minutes = gon.lesson_time_minutes;
			set_lesson_time(gon_time_per_lesson, gon_lesson_time_hours, gon_lesson_time_minutes);
			$("#cb_publisher_product_manifest_time_per_lesson").attr('checked', gon_time_per_lesson);
			set_cb_init("cb_publisher_product_manifest_time_per_lesson", "cb_time_per_lesson");			

			if( !gon_time_per_lesson) {
				$("#label_lesson_time_hours").removeClass("label-lesson-time-enabled").addClass("label-lesson-time-disabled");
				$("#label_lesson_time_minutes").removeClass("label-lesson-time-enabled").addClass("label-lesson-time-disabled");	
				$("#number_lesson_time_hours").removeClass("number-lesson-time-enabled").addClass("number-lesson-time-disabled");
				$("#number_lesson_time_minutes").removeClass("number-lesson-time-enabled").addClass("number-lesson-time-disabled");				
				$("#number_lesson_time_hours").attr("disabled", true);
				$("#number_lesson_time_minutes").attr("disabled", true);
				$("#number_lesson_time_hours").val(0);
				$("#number_lesson_time_minutes").val(0);				
			}

			var gon_time_per_course = gon.time_per_course;
			var gon_course_time_months = gon.course_time_months;
			var gon_course_time_days = gon.course_time_days;
			set_course_time(gon_time_per_course, gon_course_time_months, gon_course_time_days);
			$("#cb_publisher_product_manifest_time_per_course").attr('checked', gon_time_per_course);
			set_cb_init("cb_publisher_product_manifest_time_per_course", "cb_time_per_course");			

			if( !gon_time_per_course) {
				$("#label_course_time_months").removeClass("label-lesson-time-enabled").addClass("label-lesson-time-disabled");
				$("#label_course_time_days").removeClass("label-lesson-time-enabled").addClass("label-lesson-time-disabled");	
				$("#number_course_time_months").removeClass("number-lesson-time-enabled").addClass("number-lesson-time-disabled");
				$("#number_course_time_days").removeClass("number-lesson-time-enabled").addClass("number-lesson-time-disabled");				
				$("#number_course_time_months").attr("disabled", true);
				$("#number_course_time_days").attr("disabled", true);
				$("#number_course_time_months").val(0);
				$("#number_course_time_days").val(0);				
			}

			// $("#open_edit_allow_teacher_rating").click(function(){
		    	// // $("#publisher_product_allow_teacher_rating_chosen").css({
		    		// // 'width':'314px'
		    	// // });				
	    		// $("#show_allow_teacher_rating, #open_edit_allow_teacher_rating").fadeOut(300, function(){
	    			// $("#show_allow_teacher_rating").addClass("hidden");
	    			// $("#open_edit_allow_teacher_rating").addClass("visibility-hidden");
	    			// // $("#open_edit_allow_teacher_rating").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// // $("#open_edit_allow_teacher_rating").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			// $("#edit_allow_teacher_rating").fadeIn(1300).removeClass("hidden");
	    			// $("#publisher_product_allow_teacher_rating").trigger("chosen:updated");
	    		// });
		  	// });
    		// $("#submit_allow_teacher_rating").keypress(function(e){
      			// if(e.keyCode==13)
      			// $("#submit_allow_teacher_rating").click();
    		// });		
    		// $("#cancel_allow_teacher_rating").keypress(function(e){
      			// if(e.keyCode==13)
      			// $("#cancel_allow_teacher_rating").click();
    		// });		
			// $("#cancel_allow_teacher_rating").on('click', function() {
				// show_control("allow_teacher_rating");
				// // show_edit_control("allow_teacher_rating", "right");
			// });
			// $("#close_info_allow_teacher_rating").click(function(){
		    	// $("#form_info_allow_teacher_rating_a").fadeOut(700, function(){ $("#form_info_allow_teacher_rating").slideUp(400) });
		  	// });
		  	// $("#open_info_allow_teacher_rating").click(function(){
		    	// $("#form_info_allow_teacher_rating").slideDown(400, function(){ $("#form_info_allow_teacher_rating_a").fadeIn( 2000 ) });
		  	// });	    		


			$("#cb_container_time_per_lesson").on('click', function() {
				set_cb("cb_publisher_product_manifest_time_per_lesson", "cb_time_per_lesson");
				if( $("#cb_time_per_lesson").hasClass("cb-background") ) {
					$("#label_lesson_time_hours").removeClass("label-lesson-time-disabled").addClass("label-lesson-time-enabled");
					$("#label_lesson_time_minutes").removeClass("label-lesson-time-disabled").addClass("label-lesson-time-enabled");	
					$("#number_lesson_time_hours").removeClass("number-lesson-time-disabled").addClass("number-lesson-time-enabled");
					$("#number_lesson_time_minutes").removeClass("number-lesson-time-disabled").addClass("number-lesson-time-enabled");
					$("#number_lesson_time_hours").attr("disabled", false);
					$("#number_lesson_time_minutes").attr("disabled", false);
				}
				else {
					$("#label_lesson_time_hours").removeClass("label-lesson-time-enabled").addClass("label-lesson-time-disabled");
					$("#label_lesson_time_minutes").removeClass("label-lesson-time-enabled").addClass("label-lesson-time-disabled");
					$("#number_lesson_time_hours").removeClass("number-lesson-time-enabled").addClass("number-lesson-time-disabled");
					$("#number_lesson_time_minutes").removeClass("number-lesson-time-enabled").addClass("number-lesson-time-disabled");
					$("#number_lesson_time_hours").attr("disabled", true);
					$("#number_lesson_time_minutes").attr("disabled", true);
					$("#number_lesson_time_hours").val(0);
					$("#number_lesson_time_minutes").val(0);
				}
			});

			$("#cb_container_time_per_course").on('click', function() {
				set_cb("cb_publisher_product_manifest_time_per_course", "cb_time_per_course");
				if( $("#cb_time_per_course").hasClass("cb-background") ) {
					$("#label_course_time_months").removeClass("label-lesson-time-disabled").addClass("label-lesson-time-enabled");
					$("#label_course_time_days").removeClass("label-lesson-time-disabled").addClass("label-lesson-time-enabled");	
					$("#number_course_time_months").removeClass("number-lesson-time-disabled").addClass("number-lesson-time-enabled");
					$("#number_course_time_days").removeClass("number-lesson-time-disabled").addClass("number-lesson-time-enabled");
					$("#number_course_time_months").attr("disabled", false);
					$("#number_course_time_days").attr("disabled", false);
				}
				else {
					$("#label_course_time_months").removeClass("label-lesson-time-enabled").addClass("label-lesson-time-disabled");
					$("#label_course_time_days").removeClass("label-lesson-time-enabled").addClass("label-lesson-time-disabled");
					$("#number_course_time_months").removeClass("number-lesson-time-enabled").addClass("number-lesson-time-disabled");
					$("#number_course_time_days").removeClass("number-lesson-time-enabled").addClass("number-lesson-time-disabled");
					$("#number_course_time_months").attr("disabled", true);
					$("#number_course_time_days").attr("disabled", true);
					$("#number_course_time_months").val(0);
					$("#number_course_time_days").val(0);
				}
			});



			// $("#ch_publisher_product_manifest_allow_teacher_rating").on('click', function() {
				// if( $("#ch_publisher_product_manifest_allow_teacher_rating").is(':checked') ) {
					// $("#publisher_product_manifest_user_rating").prop('disabled', false).trigger("chosen:updated");	
				// }
				// else {
					// $("#publisher_product_manifest_user_rating").prop('disabled', true).trigger("chosen:updated");						
				// }
			// });


			$("#submit_lesson_time").on('click', function() {

				// var b_allow_teacher_rating_changed = false;
				// var b_user_rating_changed = false;
				// var s_user_rating = "";
				// var obj_list = "";
				// var obj = "";
				// var obj_1 = "";
				// var obj_2 = "";
				// var cb_publisher_product_manifest_allow_teacher_rating = $("#cb_publisher_product_manifest_allow_teacher_rating").is(':checked');
				// var input_publisher_product_manifest_user_rating = $("#publisher_product_manifest_user_rating").val();
				// var ar_publisher_product_manifest_user_rating = [];
				// for( var i = 1; i < 4; i++ ) {
					// if( $.inArray( i.toString(), input_publisher_product_manifest_user_rating) !== -1 ) {
						// ar_publisher_product_manifest_user_rating.push(true);
					// }
					// else {
						// ar_publisher_product_manifest_user_rating.push(false);
					// }
				// }
				// if(cb_publisher_product_manifest_allow_teacher_rating !== gon_allow_teacher_rating) {
					// // alert('allow_teacher_rating changed');
					// b_allow_teacher_rating_changed = true;
					// // gon_allow_teacher_rating = ch_publisher_product_manifest_allow_teacher_rating;
				// }
		  		// else {
		  			// // alert('not changed');
		  			// $("#render_allow_teacher_rating").removeClass("check-affirm");
		  			// $("#render_allow_teacher_rating").removeClass("check-required");
		  		// }
				// // alert(ar_publisher_product_manifest_user_rating);
				// // alert(gon_user_rating);
				// if(arraysAreIdentical(ar_publisher_product_manifest_user_rating, gon_user_rating)) {
		  			// // alert('not changed');
		  			// $("#render_user_rating").removeClass("check-affirm");
		  			// $("#render_user_rating").removeClass("check-required");
				// }
		  		// else {
					// // alert('changed');
					// b_user_rating_changed = true;
					// // gon_user_rating = input_publisher_product_manifest_user_rating;
		  		// }
				// // alert(b_allow_teacher_rating_changed);
				// // alert(b_user_rating_changed);


				var b_time_per_lesson = $("#cb_publisher_product_manifest_time_per_lesson").is(':checked');
				var input_lesson_time_hours = 0;
				var input_lesson_time_minutes = 0;
				if( b_time_per_lesson) {
					input_lesson_time_hours = $("#number_lesson_time_hours").val();
					input_lesson_time_minutes = $("#number_lesson_time_minutes").val();					
				}


				var b_time_per_course = $("#cb_publisher_product_manifest_time_per_course").is(':checked');
				var input_course_time_months = 0;
				var input_course_time_days = 0;
				if( b_time_per_course) {
					input_course_time_months = $("#number_course_time_months").val();
					input_course_time_days = $("#number_course_time_days").val();					
				}

				
				// alert(b_time_per_lesson);
				
				// if(b_allow_teacher_rating_changed || b_user_rating_changed) {
				// if(b_time_per_lesson) {
					// var input_lesson_time_hours = $("#number_lesson_time_hours").val();
					// var input_lesson_time_minutes = $("#number_lesson_time_minutes").val();
				// }
				// else {
					// var input_lesson_time_hours = $("#number_lesson_time_hours").val();
					// var input_lesson_time_minutes = $("#number_lesson_time_minutes").val();
				// }
					
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "time_per_lesson":' + b_time_per_lesson +
							   ', "lesson_time_hours":' + input_lesson_time_hours +
							   ', "lesson_time_minutes":' + input_lesson_time_minutes +
							   ', "time_per_course":' + b_time_per_course +
							   ', "course_time_months":' + input_course_time_months +
							   ', "course_time_days":' + input_course_time_days +
							   '}';      								    
				obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_lesson_time',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						// if (b_allow_teacher_rating_changed) {
							// $("#render_lesson_time").addClass("check-affirm");
						// }
						set_lesson_time(data.time_per_lesson, data.lesson_time_hours, data.lesson_time_minutes);
						set_course_time(data.time_per_course, data.course_time_months, data.course_time_days);
						show_control("lesson_time");
						// gon_allow_teacher_rating = data.allow_teacher_rating;
						// set_allow_teacher_rating(gon_allow_teacher_rating);
						// set_user_rating(data.user_rating);
						// gon_user_rating = data.user_rating;
						// $("#focus_21").focus();
						// set_updated(data.updated);		
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});

  			$("#publisher_product_platform").on('change', function(evt, params) {
  				other_selected_platform(params.selected, params.deselected);
  			});
			var gon_platform = gon.platform;
			set_platform(gon.platform, gon.has_platform_other);
			var gon_platform_text = gon.platform_text;
			set_platform_text(gon_platform_text, gon.has_platform_other, gon.platform_other);
			set_control_required("platform", gon.b_required_platform);			
			$("#open_edit_platform").click(function(){
		    	$("#publisher_product_platform_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_platform, #open_edit_platform").fadeOut(300, function(){
	    			$("#show_platform").addClass("hidden");
	    			$("#open_edit_platform").addClass("visibility-hidden");
	    			$("#edit_platform").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_platform").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_platform").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_platform").click();
    		});				
    		$("#cancel_platform").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_platform").click();
    		});		
			$("#cancel_platform").on('click', function() {
				show_control("platform");
			});
			$("#close_info_platform").click(function(){
		    	$("#form_info_platform_a").fadeOut(700, function(){ $("#form_info_platform").slideUp(400) });
		  	});
		  	$("#open_info_platform").click(function(){
		    	$("#form_info_platform").slideDown(400, function(){ $("#form_info_platform_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_platform").on('click', function() {
				var input_publisher_product_platform = $("#publisher_product_platform").val();
				var input_publisher_product_platform_other = $("#publisher_product_platform_other").val();
				var platform_other_b = false;
				if (input_publisher_product_platform_other.length > 0) {
					platform_other_b = true;
				}				
				var obj_list = '{  "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ',  "platform":"' + input_publisher_product_platform + 
							   '", "platform_other_b":' + platform_other_b + 
							   ',  "platform_other":"' + input_publisher_product_platform_other + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_platform',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_platform(data.platform, data.has_platform_other);
						set_platform_text(data.platform_text, data.has_platform_other, data.platform_other);
						show_control("platform");
						set_control_required("platform", data.b_required);		
						renderListingPreview("platform");
						// $("#focus_30").focus();
						// set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});




  			$("#publisher_product_file_type").on('change', function(evt, params) {
  				other_selected_file_type(params.selected, params.deselected);
  			});
			var gon_file_type = gon.file_type;
			set_file_type(gon.file_type, gon.has_file_type_other);
			var gon_file_type_text = gon.file_type_text;
			set_file_type_text(gon_file_type_text, gon.has_file_type_other, gon.file_type_other);
			set_control_required("file_type", gon.b_required_file_type);			
			$("#open_edit_file_type").click(function(){
		    	$("#publisher_product_file_type_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_file_type, #open_edit_file_type").fadeOut(300, function(){
	    			$("#show_file_type").addClass("hidden");
	    			$("#open_edit_file_type").addClass("visibility-hidden");
	    			// $("#open_edit_file_type").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_file_type").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_file_type").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_file_type").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_file_type").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_file_type").click();
    		});				
    		$("#cancel_file_type").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_file_type").click();
    		});		
			$("#cancel_file_type").on('click', function() {
				show_control("file_type");
			});
			$("#close_info_file_type").click(function(){
		    	$("#form_info_file_type_a").fadeOut(700, function(){ $("#form_info_file_type").slideUp(400) });
		  	});
		  	$("#open_info_file_type").click(function(){
		    	$("#form_info_file_type").slideDown(400, function(){ $("#form_info_file_type_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_file_type").on('click', function() {
				var input_publisher_product_file_type = $("#publisher_product_file_type").val();
				var input_publisher_product_file_type_other = $("#publisher_product_file_type_other").val();
				var file_type_other_b = false;
				if (input_publisher_product_file_type_other.length > 0) {
					file_type_other_b = true;
				}				
				var obj_list = '{  "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ',  "file_type":"' + input_publisher_product_file_type + 
							   '", "file_type_other_b":' + file_type_other_b + 
							   ',  "file_type_other":"' + input_publisher_product_file_type_other + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_file_type',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_file_type(data.file_type, data.has_file_type_other);
						set_file_type_text(data.file_type_text, data.has_file_type_other, data.file_type_other);
						show_control("file_type");
						set_control_required("file_type", data.b_required);	
						renderListingPreview("file_type");											
						// $("#focus_30").focus();
						// set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});


  			$("#publisher_product_by_review").on('change', function(evt, params) {
  				other_selected_by_review(params.selected, params.deselected);
  			});
			var gon_by_review = gon.by_review;
			set_by_review(gon.by_review, gon.has_by_review_other);
			var gon_by_review_text = gon.by_review_text;
			set_by_review_text(gon_by_review_text, gon.has_by_review_other, gon.by_review_other);
			set_control_required("by_review", gon.b_required_by_review);			
			$("#open_edit_by_review").click(function(){
		    	$("#publisher_product_by_review_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_by_review, #open_edit_by_review").fadeOut(300, function(){
	    			$("#show_by_review").addClass("hidden");
	    			$("#open_edit_by_review").addClass("visibility-hidden");
	    			$("#edit_by_review").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_by_review").trigger("chosen:updated");
	    		});
		  	});
			$("#cancel_by_review").on('click', function() {
				show_control("by_review");
			});
    		$("#submit_by_review").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_by_review").click();
    		});		
    		$("#cancel_by_review").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_by_review").click();
    		});		
			$("#close_info_by_review").click(function(){
		    	$("#form_info_by_review_a").fadeOut(700, function(){ $("#form_info_by_review").slideUp(400) });
		  	});
		  	$("#open_info_by_review").click(function(){
		    	$("#form_info_by_review").slideDown(400, function(){ $("#form_info_by_review_a").fadeIn( 2000 ) });
		  	});	    		
			$("#submit_by_review").on('click', function() {
				var input_publisher_product_by_review = $("#publisher_product_by_review").val();
				var input_publisher_product_by_review_other = $("#publisher_product_by_review_other").val();
				var by_review_other_b = false;
				if (input_publisher_product_by_review_other.length > 0) {
					by_review_other_b = true;
				}				
				var obj_list = '{  "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ',  "by_review":"' + input_publisher_product_by_review + 
							   '", "by_review_other_b":' + by_review_other_b + 
							   ',  "by_review_other":"' + input_publisher_product_by_review_other + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_by_review',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_by_review(data.by_review, data.has_by_review_other);
						set_by_review_text(data.by_review_text, data.has_by_review_other, data.by_review_other);
						show_control("by_review");
						set_control_required("by_review", data.b_required);			
						renderListingPreview("by_review");			
						// $("#focus_30").focus();
						// set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});



  			$("#publisher_product_enhancement").on('change', function(evt, params) {
  				other_selected_enhancement(params.selected, params.deselected);
  			});
			var gon_enhancement = gon.enhancement;
			set_enhancement(gon.enhancement, gon.has_enhancement_other);
			var gon_enhancement_text = gon.enhancement_text;
			set_enhancement_text(gon_enhancement_text, gon.has_enhancement_other, gon.enhancement_other);
			set_control_required("enhancement", gon.b_required_enhancement);			
			$("#open_edit_enhancement").click(function(){
		    	$("#publisher_product_enhancement_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_enhancement, #open_edit_enhancement").fadeOut(300, function(){
	    			$("#show_enhancement").addClass("hidden");
	    			$("#open_edit_enhancement").addClass("visibility-hidden");
	    			$("#edit_enhancement").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_enhancement").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_enhancement").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_enhancement").click();
    		});			
			$("#cancel_enhancement").on('click', function() {
				show_control("enhancement");
			});
    		$("#cancel_enhancement").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_enhancement").click();
    		});		
			$("#close_info_enhancement").click(function(){
		    	$("#form_info_enhancement_a").fadeOut(700, function(){ $("#form_info_enhancement").slideUp(400) });
		  	});
		  	$("#open_info_enhancement").click(function(){
		    	$("#form_info_enhancement").slideDown(400, function(){ $("#form_info_enhancement_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_enhancement").on('click', function() {
				var input_publisher_product_enhancement = $("#publisher_product_enhancement").val();
				var input_publisher_product_enhancement_other = $("#publisher_product_enhancement_other").val();
				var enhancement_other_b = false;
				if (input_publisher_product_enhancement_other.length > 0) {
					enhancement_other_b = true;
				}				
				var obj_list = '{  "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ',  "enhancement":"' + input_publisher_product_enhancement + 
							   '", "enhancement_other_b":' + enhancement_other_b + 
							   ',  "enhancement_other":"' + input_publisher_product_enhancement_other + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_enhancement',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_enhancement(data.enhancement, data.has_enhancement_other);
						set_enhancement_text(data.enhancement_text, data.has_enhancement_other, data.enhancement_other);
						show_control("enhancement");
						set_control_required("enhancement", data.b_required);		
						renderListingPreview("enhancement");										
						// $("#focus_30").focus();
						// set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});



			var gon_from_age = gon.from_age;
			set_from_age(gon_from_age);
			var gon_from_age_text = gon.from_age_text;
			// set_from_age_text(gon_from_age_text);
			var gon_to_age = gon.to_age;
			set_to_age(gon_to_age);
			var gon_to_age_text = gon.to_age_text;
			// set_to_age_text(gon_to_age_text);
			set_age_range_text(gon_from_age_text, gon_to_age_text);
			set_control_required("age_range", (gon.b_required_from_age || gon.b_required_to_age));

			$("#open_edit_age_range").click(function(){
		    	$("#publisher_product_from_age_chosen").css({
		    		'width':'314px'
		    	});				
		    	$("#publisher_product_to_age_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_age_range, #open_edit_age_range").fadeOut(300, function(){
	    			$("#show_from_age").addClass("hidden");
	    			$("#show_to_age").addClass("hidden");
	    			$("#open_edit_age_range").addClass("visibility-hidden");
	    			$("#edit_age_range").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_from_age").trigger("chosen:updated");
	    			$("#publisher_product_to_age").trigger("chosen:updated");	    			
	    		});
		  	});

    		$("#submit_from_age").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_from_age").click();
    		});			
			$("#cancel_age_range").on('click', function() {
				show_control("age_range");
				// show_edit_control("from_age", "right");
			});
    		$("#cancel_age_range").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_age_range").click();
    		});		
			$("#close_info_age_range").click(function(){
		    	$("#form_info_age_range_a").fadeOut(700, function(){ $("#form_info_age_range").slideUp(400) });
		  	});
		  	$("#open_info_age_range").click(function(){
		    	$("#form_info_age_range").slideDown(400, function(){ $("#form_info_age_range_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_age_range").on('click', function() {
				var input_publisher_product_from_age = $("#publisher_product_from_age").val();
				var input_publisher_product_to_age = $("#publisher_product_to_age").val();
				var obj_list = '{ "from_age":"' + input_publisher_product_from_age +
							   '", "to_age":"' + input_publisher_product_to_age + 
							   '", "publisher_product_id":' + <%= @publisher_product_id %> + 							   
							   '}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_age_range',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_from_age(data.g_from_age);
						// set_from_age_text(data.g_from_age_text);
						set_to_age(data.g_to_age);
						// set_to_age_text(data.g_to_age_text);						
						show_control("age_range");
						set_age_range_text(data.g_from_age_text, data.g_to_age_text);
						set_control_required("age_range", (data.b_required_from_age || data.b_required_to_age));
						renderListingPreview("age_range");
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});


			var gon_from_grade = gon.from_grade;
			set_from_grade(gon_from_grade);
			var gon_from_grade_text = gon.from_grade_text;
			// set_from_grade_text(gon_from_grade_text);
			var gon_to_grade = gon.to_grade;
			set_to_grade(gon_to_grade);
			var gon_to_grade_text = gon.to_grade_text;
			// set_to_grade_text(gon_to_grade_text);
			set_grade_range_text(gon_from_grade_text, gon_to_grade_text);
			set_control_required("grade_range", (gon.b_required_from_grade || gon.b_required_to_grade));
			
			$("#open_edit_grade_range").click(function(){
		    	$("#publisher_product_from_grade_chosen").css({
		    		'width':'314px'
		    	});				
		    	$("#publisher_product_to_grade_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_grade_range, #open_edit_grade_range").fadeOut(300, function(){
	    			$("#show_from_grade").addClass("hidden");
	    			$("#show_to_grade").addClass("hidden");
	    			$("#open_edit_grade_range").addClass("visibility-hidden");
	    			$("#edit_grade_range").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_from_grade").trigger("chosen:updated");
	    			$("#publisher_product_to_grade").trigger("chosen:updated");	    			
	    		});
		  	});
    		$("#submit_from_grade").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_from_grade").click();
    		});			
			$("#cancel_grade_range").on('click', function() {
				show_control("grade_range");
			});
    		$("#cancel_grade_range").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_grade_range").click();
    		});		
			$("#close_info_grade_range").click(function(){
		    	$("#form_info_grade_range_a").fadeOut(700, function(){ $("#form_info_grade_range").slideUp(400) });
		  	});
		  	$("#open_info_grade_range").click(function(){
		    	$("#form_info_grade_range").slideDown(400, function(){ $("#form_info_grade_range_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_grade_range").on('click', function() {
				var input_publisher_product_from_grade = $("#publisher_product_from_grade").val();
				// alert(input_publisher_product_from_grade);
				var input_publisher_product_to_grade = $("#publisher_product_to_grade").val();
				var obj_list = '{ "from_grade":"' + input_publisher_product_from_grade + 
							   '", "to_grade":"' + input_publisher_product_to_grade + 				
							   '", "publisher_product_id":' + <%= @publisher_product_id %> + 							   							   
							   '}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_grade_range',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_from_grade(data.g_from_grade);
						// set_from_grade_text(data.g_from_grade_text);
						set_to_grade(data.g_to_grade);
						// set_to_grade_text(data.g_to_grade_text);						
						show_control("grade_range");
						set_grade_range_text(data.g_from_grade_text, data.g_to_grade_text);
						set_control_required("grade_range", (data.b_required_from_grade || data.b_required_to_grade));
						renderListingPreview("grade_range");
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});




			var gon_market_target = gon.market_target;
			set_market_target(gon_market_target);
			var gon_market_target_text = gon.market_target_text;
			set_market_target_text(gon_market_target_text);
			set_control_required("market_target", gon.b_required_market_target);			
			$("#open_edit_market_target").click(function(){
		    	$("#publisher_product_market_target_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_market_target, #open_edit_market_target").fadeOut(300, function(){
	    			$("#show_market_target").addClass("hidden");
	    			$("#open_edit_market_target").addClass("visibility-hidden");
	    			// $("#open_edit_market_target").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_market_target").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_market_target").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_market_target").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_market_target").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_market_target").click();
    		});			
			$("#cancel_market_target").on('click', function() {
				show_control("market_target");
				// show_edit_control("market_target", "right");
			});
    		$("#cancel_market_target").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_market_target").click();
    		});		
			$("#close_info_market_target").click(function(){
		    	$("#form_info_market_target_a").fadeOut(700, function(){ $("#form_info_market_target").slideUp(400) });
		  	});
		  	$("#open_info_market_target").click(function(){
		    	$("#form_info_market_target").slideDown(400, function(){ $("#form_info_market_target_a").fadeIn(2000) });
		  	});	
			$("#submit_market_target").on('click', function() {
				var input_publisher_product_market_target = $("#publisher_product_market_target").val();
				// alert(input_publisher_product_manifest_market_target);
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "market_target":"' + input_publisher_product_market_target + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_market_target',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_market_target(data.g_market_target);
						set_market_target_text(data.g_market_target_text);
						show_control("market_target");
						set_control_required("market_target", data.b_required);			
						renderListingPreview("market_target");									
						// $("#focus_30").focus();
						// set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});




			var gon_pricing_model = gon.pricing_model;
			set_pricing_model(gon_pricing_model);
			var gon_pricing_model_text = gon.pricing_model_text;
			set_pricing_model_text(gon_pricing_model_text);
			set_control_required("pricing_model", gon.b_required_pricing_model);			
			$("#open_edit_pricing_model").click(function(){
		    	$("#publisher_product_pricing_model_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_pricing_model, #open_edit_pricing_model").fadeOut(300, function(){
	    			$("#show_pricing_model").addClass("hidden");
	    			$("#open_edit_pricing_model").addClass("visibility-hidden");
	    			// $("#open_edit_pricing_model").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_pricing_model").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_pricing_model").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_pricing_model").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_pricing_model").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_pricing_model").click();
    		});			
			$("#cancel_pricing_model").on('click', function() {
				show_control("pricing_model");
				// show_edit_control("pricing_model", "right");
			});
    		$("#cancel_pricing_model").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_pricing_model").click();
    		});		
			$("#close_info_pricing_model").click(function(){
		    	$("#form_info_pricing_model_a").fadeOut(700, function(){ $("#form_info_pricing_model").slideUp(400) });
		  	});
		  	$("#open_info_pricing_model").click(function(){
		    	$("#form_info_pricing_model").slideDown(400, function(){ $("#form_info_pricing_model_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_pricing_model").on('click', function() {
				var input_publisher_product_pricing_model = $("#publisher_product_pricing_model").val();
				// alert(input_publisher_product_pricing_model);
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "pricing_model":"' + input_publisher_product_pricing_model + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_pricing_model',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						set_pricing_model(data.g_pricing_model);
						set_pricing_model_text(data.g_pricing_model_text);
						show_control("pricing_model");
						set_control_required("pricing_model", data.b_required);
						renderListingPreview("pricing_model");												
						// $("#focus_30").focus();
						// set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});

			var gon_price = gon.price;
			set_price(gon_price);

    		$("#span_price_1").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_1").click();
    		});			
			$("#span_price_1").on('click', function() {
				$("#cb_price_1").click();
			});
			$("#cb_price_1").on('click', function() {
				set_cb("ch_price_1", "cb_price_1");
				if ( ($("#ch_price_1").is(':checked')) ) {
					$("#publisher_product_price_price_1_dec").removeAttr('disabled');
					$("#publisher_product_price_price_1_dec").focus();
				}
				else {
					$("#publisher_product_price_price_1_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});
			
    		$("#span_price_2").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_2").click();
    		});			
			$("#span_price_2").on('click', function() {
				$("#cb_price_2").click();
			});
			$("#cb_price_2").on('click', function() {
				set_cb("ch_price_2", "cb_price_2");
				if ( ($("#ch_price_2").is(':checked')) ) {
					$("#publisher_product_price_price_2_dec").removeAttr('disabled');
					$("#publisher_product_price_price_2_dec").focus();
				}
				else {
					$("#publisher_product_price_price_2_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});

    		$("#span_price_3").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_3").click();
    		});			
			$("#span_price_3").on('click', function() {
				$("#cb_price_3").click();
			});
			$("#cb_price_3").on('click', function() {
				set_cb("ch_price_3", "cb_price_3");
				if ( ($("#ch_price_3").is(':checked')) ) {
					$("#publisher_product_price_price_3_dec").removeAttr('disabled');
					$("#publisher_product_price_price_3_dec").focus();
				}
				else {
					$("#publisher_product_price_price_3_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});

    		$("#span_price_4").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_4").click();
    		});			
			$("#span_price_4").on('click', function() {
				$("#cb_price_4").click();
			});
			$("#cb_price_4").on('click', function() {
				set_cb("ch_price_4", "cb_price_4");
				if ( ($("#ch_price_4").is(':checked')) ) {
					$("#publisher_product_price_price_4_dec").removeAttr('disabled');
					$("#publisher_product_price_price_4_dec").focus();
				}
				else {
					$("#publisher_product_price_price_4_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});

    		$("#span_price_5").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_5").click();
    		});			
			$("#span_price_5").on('click', function() {
				$("#cb_price_5").click();
			});
			$("#cb_price_5").on('click', function() {
				set_cb("ch_price_5", "cb_price_5");
				if ( ($("#ch_price_5").is(':checked')) ) {
					$("#publisher_product_price_price_5_dec").removeAttr('disabled');
					$("#publisher_product_price_price_5_dec").focus();
				}
				else {
					$("#publisher_product_price_price_5_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});

    		$("#span_price_6").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_6").click();
    		});			
			$("#span_price_6").on('click', function() {
				$("#cb_price_6").click();
			});
			$("#cb_price_6").on('click', function() {
				set_cb("ch_price_6", "cb_price_6");
				if ( ($("#ch_price_6").is(':checked')) ) {
					$("#publisher_product_price_price_6_dec").removeAttr('disabled');
					$("#publisher_product_price_price_6_dec").focus();
				}
				else {
					$("#publisher_product_price_price_6_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});

    		$("#span_price_7").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_7").click();
    		});			
			$("#span_price_7").on('click', function() {
				$("#cb_price_7").click();
			});
			$("#cb_price_7").on('click', function() {
				set_cb("ch_price_7", "cb_price_7");
				if ( ($("#ch_price_7").is(':checked')) ) {
					$("#publisher_product_price_price_7_dec").removeAttr('disabled');
					$("#publisher_product_price_price_7_dec").focus();
				}
				else {
					$("#publisher_product_price_price_7_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});

    		$("#span_price_8").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_8").click();
    		});			
			$("#span_price_8").on('click', function() {
				$("#cb_price_8").click();
			});
			$("#cb_price_8").on('click', function() {
				set_cb("ch_price_8", "cb_price_8");
				if ( ($("#ch_price_8").is(':checked')) ) {
					$("#publisher_product_price_price_8_dec").removeAttr('disabled');
					$("#publisher_product_price_price_8_dec").focus();
				}
				else {
					$("#publisher_product_price_price_8_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});

    		$("#span_price_9").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_9").click();
    		});			
			$("#span_price_9").on('click', function() {
				$("#cb_price_9").click();
			});
			$("#cb_price_9").on('click', function() {
				set_cb("ch_price_9", "cb_price_9");
				if ( ($("#ch_price_9").is(':checked')) ) {
					$("#publisher_product_price_price_9_dec").removeAttr('disabled');
					$("#publisher_product_price_price_9_dec").focus();
				}
				else {
					$("#publisher_product_price_price_9_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});

    		$("#span_price_10").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_10").click();
    		});			
			$("#span_price_10").on('click', function() {
				$("#cb_price_10").click();
			});
			$("#cb_price_10").on('click', function() {
				set_cb("ch_price_10", "cb_price_10");
				if ( ($("#ch_price_10").is(':checked')) ) {
					$("#publisher_product_price_price_10_dec").removeAttr('disabled');
					$("#publisher_product_price_price_10_dec").focus();
				}
				else {
					$("#publisher_product_price_price_10_dec").attr('disabled', 'disabled');
				}
				verify_price_numeric();
			});

    		$("#span_price_11").keypress(function(e){
      			if(e.keyCode==13)
      			$("#span_price_11").click();
    		});			
			$("#span_price_11").on('click', function() {
				$("#cb_price_11").click();
			});
			$("#cb_price_11").on('click', function() {
				set_cb("ch_price_11", "cb_price_11");
			});

			
			// var gon_price_text = gon.price_text;
			// set_price_text(gon_price_text);
			set_control_required("price", gon.b_required_price);			
			$("#open_edit_price").click(function(){
		    	$("#span_price_1").focus();	
	    		$("#show_price_model, #open_edit_price").fadeOut(300, function(){
	    			$("#show_price").addClass("hidden");
	    			$("#open_edit_price").addClass("visibility-hidden");
	    			// $("#open_edit_price_model").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_price_model").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_price").fadeIn(1300).removeClass("hidden");
	    			// $("#publisher_product_price").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_price").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_price").click();
    		});			
			$("#cancel_price").on('click', function() {
				show_control("price");
				// show_edit_control("price", "right");
			});
    		$("#cancel_price").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_price").click();
    		});		
			$("#close_info_price").click(function(){
		    	$("#form_info_price_a").fadeOut(700, function(){ $("#form_info_price").slideUp(400) });
		  	});
		  	$("#open_info_price").click(function(){
		    	$("#form_info_price").slideDown(400, function(){ $("#form_info_price_a").fadeIn( 2000 ) });
		  	});	


			// $("#submit_price").on('click', function() {
				// var price = $("#publisher_product_price_price_1_dec").val();
				// alert(price);
				// // var re = new RegExp("^(?!0\.00)\d{1,3}(,\d{3})*(\.\d\d)?$");
				// var re = new RegExp("[.]$");
				// b = re.test(price);
				// alert(b);									
				// price = price.replace(/[.]$/, ".00");
				// // price = price.replace("a", "b");
				// alert(price);
				// // var b = price.test(/[.*+?^${}()|[\]\\]/g, price);
			// });

			$("#submit_price").on('click', function() {
				
				$("#render_price_1").removeClass("check-required").removeClass("check-affirm");
				$("#render_price_2").removeClass("check-required").removeClass("check-affirm");				
				$("#render_price_3").removeClass("check-required").removeClass("check-affirm");
				$("#render_price_4").removeClass("check-required").removeClass("check-affirm");
				$("#render_price_5").removeClass("check-required").removeClass("check-affirm");
				$("#render_price_6").removeClass("check-required").removeClass("check-affirm");
				$("#render_price_7").removeClass("check-required").removeClass("check-affirm");
				$("#render_price_8").removeClass("check-required").removeClass("check-affirm");
				$("#render_price_9").removeClass("check-required").removeClass("check-affirm");
				$("#render_price_10").removeClass("check-required").removeClass("check-affirm");
				$("#render_price_11").removeClass("check-required").removeClass("check-affirm");

				$("#price_error_msg").addClass("display-hidden");

				var val_ch_price_1 = $("#ch_price_1").is(':checked');
				var input_publisher_product_price_price_1_dec = $("#publisher_product_price_price_1_dec").val();
				var val_ch_price_2 = $("#ch_price_2").is(':checked');
				var input_publisher_product_price_price_2_dec = $("#publisher_product_price_price_2_dec").val();
				var val_ch_price_3 = $("#ch_price_3").is(':checked');
				var input_publisher_product_price_price_3_dec = $("#publisher_product_price_price_3_dec").val();
				var val_ch_price_4 = $("#ch_price_4").is(':checked');
				var input_publisher_product_price_price_4_dec = $("#publisher_product_price_price_4_dec").val();
				var val_ch_price_5 = $("#ch_price_5").is(':checked');
				var input_publisher_product_price_price_5_dec = $("#publisher_product_price_price_5_dec").val();
				var val_ch_price_6 = $("#ch_price_6").is(':checked');
				var input_publisher_product_price_price_6_dec = $("#publisher_product_price_price_6_dec").val();
				var val_ch_price_7 = $("#ch_price_7").is(':checked');
				var input_publisher_product_price_price_7_dec = $("#publisher_product_price_price_7_dec").val();
				var val_ch_price_8 = $("#ch_price_8").is(':checked');
				var input_publisher_product_price_price_8_dec = $("#publisher_product_price_price_8_dec").val();
				var val_ch_price_9 = $("#ch_price_9").is(':checked');
				var input_publisher_product_price_price_9_dec = $("#publisher_product_price_price_9_dec").val();
				var val_ch_price_10 = $("#ch_price_10").is(':checked');
				var input_publisher_product_price_price_10_dec = $("#publisher_product_price_price_10_dec").val();
				var val_ch_price_11 = $("#ch_price_11").is(':checked');

				var val_ch_price_1_saved = gon.price[1][0];
				var val_input_price_1_saved_fixed = Number(val_input_price_1_saved).toFixed(2);
				var val_ch_price_2_saved = gon.price[2][0];
				var val_input_price_2_saved_fixed = Number(val_input_price_2_saved).toFixed(2);
				var val_ch_price_3_saved = gon.price[3][0];
				var val_input_price_3_saved_fixed = Number(val_input_price_3_saved).toFixed(2);
				var val_ch_price_4_saved = gon.price[4][0];
				var val_input_price_4_saved_fixed = Number(val_input_price_4_saved).toFixed(2);
				var val_ch_price_5_saved = gon.price[5][0];
				var val_input_price_5_saved_fixed = Number(val_input_price_5_saved).toFixed(2);
				var val_ch_price_6_saved = gon.price[6][0];
				var val_input_price_6_saved_fixed = Number(val_input_price_6_saved).toFixed(2);
				var val_ch_price_7_saved = gon.price[7][0];
				var val_input_price_7_saved_fixed = Number(val_input_price_7_saved).toFixed(2);
				var val_ch_price_8_saved = gon.price[8][0];
				var val_input_price_8_saved_fixed = Number(val_input_price_8_saved).toFixed(2);
				var val_ch_price_9_saved = gon.price[9][0];
				var val_input_price_9_saved_fixed = Number(val_input_price_9_saved).toFixed(2);
				var val_ch_price_10_saved = gon.price[10][0];
				var val_input_price_10_saved_fixed = Number(val_input_price_10_saved).toFixed(2);
				var val_ch_price_11_saved = gon.price[11][0];

				// price 1
				var price_1_dec_changed = false;
				if (val_input_price_1_saved_fixed !== input_publisher_product_price_price_1_dec) {
					price_1_dec_changed = true;
				}
				var b_verify_price_1_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_1_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_1_dec = input_publisher_product_price_price_1_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_1_dec > 0.009 ) {
						b_verify_price_1_dec = true;
					}
				} 
				var b_verified_1 = false;
				if (val_ch_price_1 && !b_verify_price_1_dec) {
					b_verified_1 = false;
					$("#render_price_1").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_1 && b_verify_price_1_dec) {
					b_verified_1 = true;
				}
				if (!val_ch_price_1) {
					input_publisher_product_price_price_1_dec = 0;
					b_verified_1 = true;	
				}

				// price 2
				var price_2_dec_changed = false;
				if (val_input_price_2_saved_fixed !== input_publisher_product_price_price_2_dec) {
					price_2_dec_changed = true;
				}
				var b_verify_price_2_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_2_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_2_dec = input_publisher_product_price_price_2_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_2_dec > 0.009 ) {
						b_verify_price_2_dec = true;
					}
				} 
				var b_verified_2 = false;
				if (val_ch_price_2 && !b_verify_price_2_dec) {
					b_verified_2 = false;
					$("#render_price_2").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_2 && b_verify_price_2_dec) {
					b_verified_2 = true;
				}
				if (!val_ch_price_2) {
					input_publisher_product_price_price_2_dec = 0;
					b_verified_2 = true;	
				}

				// price 3
				var price_3_dec_changed = false;
				if (val_input_price_3_saved_fixed !== input_publisher_product_price_price_3_dec) {
					price_3_dec_changed = true;
				}
				var b_verify_price_3_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_3_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_3_dec = input_publisher_product_price_price_3_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_3_dec > 0.009 ) {
						b_verify_price_3_dec = true;
					}
				} 
				var b_verified_3 = false;
				if (val_ch_price_3 && !b_verify_price_3_dec) {
					b_verified_3 = false;
					$("#render_price_3").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_3 && b_verify_price_3_dec) {
					b_verified_3 = true;
				}
				if (!val_ch_price_3) {
					input_publisher_product_price_price_3_dec = 0;
					b_verified_3 = true;	
				}

				// price 4
				var price_4_dec_changed = false;
				if (val_input_price_4_saved_fixed !== input_publisher_product_price_price_4_dec) {
					price_4_dec_changed = true;
				}
				var b_verify_price_4_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_4_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_4_dec = input_publisher_product_price_price_4_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_4_dec > 0.009 ) {
						b_verify_price_4_dec = true;
					}
				} 
				var b_verified_4 = false;
				if (val_ch_price_4 && !b_verify_price_4_dec) {
					b_verified_4 = false;
					$("#render_price_4").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_4 && b_verify_price_4_dec) {
					b_verified_4 = true;
				}
				if (!val_ch_price_4) {
					input_publisher_product_price_price_4_dec = 0;
					b_verified_4 = true;	
				}

				// price 5
				var price_5_dec_changed = false;
				if (val_input_price_5_saved_fixed !== input_publisher_product_price_price_5_dec) {
					price_5_dec_changed = true;
				}
				var b_verify_price_5_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_5_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_5_dec = input_publisher_product_price_price_5_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_5_dec > 0.009 ) {
						b_verify_price_5_dec = true;
					}
				} 
				var b_verified_5 = false;
				if (val_ch_price_5 && !b_verify_price_5_dec) {
					b_verified_5 = false;
					$("#render_price_5").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_5 && b_verify_price_5_dec) {
					b_verified_5 = true;
				}
				if (!val_ch_price_5) {
					input_publisher_product_price_price_5_dec = 0;
					b_verified_5 = true;	
				}

				// price 6
				var price_6_dec_changed = false;
				if (val_input_price_6_saved_fixed !== input_publisher_product_price_price_6_dec) {
					price_6_dec_changed = true;
				}
				var b_verify_price_6_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_6_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_6_dec = input_publisher_product_price_price_6_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_6_dec > 0.009 ) {
						b_verify_price_6_dec = true;
					}
				} 
				var b_verified_6 = false;
				if (val_ch_price_6 && !b_verify_price_6_dec) {
					b_verified_6 = false;
					$("#render_price_6").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_6 && b_verify_price_6_dec) {
					b_verified_6 = true;
				}
				if (!val_ch_price_6) {
					input_publisher_product_price_price_6_dec = 0;
					b_verified_6 = true;	
				}

				// price 7
				var price_7_dec_changed = false;
				if (val_input_price_7_saved_fixed !== input_publisher_product_price_price_7_dec) {
					price_7_dec_changed = true;
				}
				var b_verify_price_7_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_7_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_7_dec = input_publisher_product_price_price_7_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_7_dec > 0.009 ) {
						b_verify_price_7_dec = true;
					}
				} 
				var b_verified_7 = false;
				if (val_ch_price_7 && !b_verify_price_7_dec) {
					b_verified_7 = false;
					$("#render_price_7").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_7 && b_verify_price_7_dec) {
					b_verified_7 = true;
				}
				if (!val_ch_price_7) {
					input_publisher_product_price_price_7_dec = 0;
					b_verified_7 = true;	
				}

				// price 8
				var price_8_dec_changed = false;
				if (val_input_price_8_saved_fixed !== input_publisher_product_price_price_8_dec) {
					price_8_dec_changed = true;
				}
				var b_verify_price_8_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_8_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_8_dec = input_publisher_product_price_price_8_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_8_dec > 0.009 ) {
						b_verify_price_8_dec = true;
					}
				} 
				var b_verified_8 = false;
				if (val_ch_price_8 && !b_verify_price_8_dec) {
					b_verified_8 = false;
					$("#render_price_8").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_8 && b_verify_price_8_dec) {
					b_verified_8 = true;
				}
				if (!val_ch_price_8) {
					input_publisher_product_price_price_8_dec = 0;
					b_verified_8 = true;	
				}

				// price 9
				var price_9_dec_changed = false;
				if (val_input_price_9_saved_fixed !== input_publisher_product_price_price_9_dec) {
					price_9_dec_changed = true;
				}
				var b_verify_price_9_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_9_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_9_dec = input_publisher_product_price_price_9_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_9_dec > 0.009 ) {
						b_verify_price_9_dec = true;
					}
				} 
				var b_verified_9 = false;
				if (val_ch_price_9 && !b_verify_price_9_dec) {
					b_verified_9 = false;
					$("#render_price_9").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_9 && b_verify_price_9_dec) {
					b_verified_9 = true;
				}
				if (!val_ch_price_9) {
					input_publisher_product_price_price_9_dec = 0;
					b_verified_9 = true;	
				}

				// price 10
				var price_10_dec_changed = false;
				if (val_input_price_10_saved_fixed !== input_publisher_product_price_price_10_dec) {
					price_10_dec_changed = true;
				}
				var b_verify_price_10_dec = false;
				if ($.isNumeric( input_publisher_product_price_price_10_dec )) {
					var re = new RegExp("[.]$");
					input_publisher_product_price_price_10_dec = input_publisher_product_price_price_10_dec.replace(/[.]$/, ".00");
					if ( input_publisher_product_price_price_10_dec > 0.009 ) {
						b_verify_price_10_dec = true;
					}
				} 
				var b_verified_10 = false;
				if (val_ch_price_10 && !b_verify_price_10_dec) {
					b_verified_10 = false;
					$("#render_price_10").addClass("check-required").removeClass("check-affirm");
				}
				if (val_ch_price_10 && b_verify_price_10_dec) {
					b_verified_10 = true;
				}
				if (!val_ch_price_10) {
					input_publisher_product_price_price_10_dec = 0;
					b_verified_10 = true;	
				}

				var b_verified = false;
				if( b_verified_1 &&
					b_verified_2 &&
					b_verified_3 &&
					b_verified_4 &&
					b_verified_5 &&
					b_verified_6 &&
					b_verified_7 &&
					b_verified_8 &&
					b_verified_9 &&
					b_verified_10 ) {
						
					b_verified = true;
				}
				
				if (b_verified) {

					if (price_1_dec_changed && val_ch_price_1) {					
						$("#render_price_1").removeClass("check-required").addClass("check-affirm");
					}
					if (price_2_dec_changed && val_ch_price_2) {					
						$("#render_price_2").removeClass("check-required").addClass("check-affirm");
					}
					if (price_3_dec_changed && val_ch_price_3) {					
						$("#render_price_3").removeClass("check-required").addClass("check-affirm");
					}
					if (price_4_dec_changed && val_ch_price_4) {					
						$("#render_price_4").removeClass("check-required").addClass("check-affirm");
					}
					if (price_5_dec_changed && val_ch_price_5) {					
						$("#render_price_5").removeClass("check-required").addClass("check-affirm");
					}
					if (price_6_dec_changed && val_ch_price_6) {					
						$("#render_price_6").removeClass("check-required").addClass("check-affirm");
					}
					if (price_7_dec_changed && val_ch_price_7) {					
						$("#render_price_7").removeClass("check-required").addClass("check-affirm");
					}
					if (price_8_dec_changed && val_ch_price_8) {					
						$("#render_price_8").removeClass("check-required").addClass("check-affirm");
					}
					if (price_9_dec_changed && val_ch_price_9) {					
						$("#render_price_9").removeClass("check-required").addClass("check-affirm");
					}
					if (price_10_dec_changed && val_ch_price_10) {					
						$("#render_price_10").removeClass("check-required").addClass("check-affirm");
					}
					
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "price_1":' + val_ch_price_1 + 
								   ', "price_1_dec":' + input_publisher_product_price_price_1_dec + 
								   ', "price_2":' + val_ch_price_2 + 
								   ', "price_2_dec":' + input_publisher_product_price_price_2_dec + 
								   ', "price_3":' + val_ch_price_3 + 
								   ', "price_3_dec":' + input_publisher_product_price_price_3_dec + 
								   ', "price_4":' + val_ch_price_4 + 
								   ', "price_4_dec":' + input_publisher_product_price_price_4_dec + 
								   ', "price_5":' + val_ch_price_5 + 
								   ', "price_5_dec":' + input_publisher_product_price_price_5_dec + 
								   ', "price_6":' + val_ch_price_6 + 
								   ', "price_6_dec":' + input_publisher_product_price_price_6_dec + 
								   ', "price_7":' + val_ch_price_7 + 
								   ', "price_7_dec":' + input_publisher_product_price_price_7_dec + 
								   ', "price_8":' + val_ch_price_8 + 
								   ', "price_8_dec":' + input_publisher_product_price_price_8_dec + 
								   ', "price_9":' + val_ch_price_9 + 
								   ', "price_9_dec":' + input_publisher_product_price_price_9_dec + 
								   ', "price_10":' + val_ch_price_10 + 
								   ', "price_10_dec":' + input_publisher_product_price_price_10_dec + 
								   ', "price_11":' + val_ch_price_11 + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';              
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_price',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							set_price(data.g_price);
							// set_pricing_model_text(data.g_pricing_model_text);
							show_control("price");
							set_control_required("price", data.b_required);				
							// set_price(data.g_updated);
							// $("#focus_30").focus();
							// set_updated(data.updated);													
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
			  }
			  else {
			  	$("#price_error_msg").removeClass("display-hidden");
			  }
			});



			show_control_standard("core_literacy_standard");
			var gon_core_literacy_standard = gon.core_literacy_standard;
			set_core_literacy_standard(gon_core_literacy_standard);
			var gon_core_literacy_standard_text = gon.core_literacy_standard_text;
			set_core_literacy_standard_text(gon_core_literacy_standard_text);
			// set_control_required("core_literacy_standard", gon.b_required_core_literacy_standard);			
			
			
			
			// $(".core-literacy-standard").on('click', function() {
				// var cb = $(this).attr("id");
				// var ch = "ch_" + $(this).attr("name");
				// set_cb(ch, cb);
			// });
			
			
			// var cb = "";
			// var ch = "";
			// var sb = "";
			// var core_literacy_standards_count = <#%= @core_literacy_standards.count %#>;
			// for(var i = 1; i < core_literacy_standards_count + 1; i++ )
			// {
				// cb = "cb_core_literacy_standard_" + i.toString();
				// ch = "ch_core_literacy_standard_" + i.toString();				
				// sb = "#cb_core_literacy_standard_" + i.toString();
				// $(sb).on('click', function() {
					// alert(cb);
					// set_cb(ch, cb);
				// });
			// }
			
			$("#open_edit_core_literacy_standard").click(function(){
				show_control_standard_edit("core_literacy_standard");
		    	$("#publisher_product_core_literacy_standard_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_core_literacy_standard, #open_edit_core_literacy_standard").fadeOut(300, function(){
	    			$("#show_core_literacy_standard").addClass("hidden");
	    			$("#open_edit_core_literacy_standard").addClass("visibility-hidden");
	    			// $("#open_edit_core_literacy_standard").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_core_literacy_standard").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_core_literacy_standard").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_core_literacy_standard").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_core_literacy_standard").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_core_literacy_standard").click();
    		});			
			$("#cancel_core_literacy_standard").on('click', function() {
				show_control_standard("core_literacy_standard");
				show_control("core_literacy_standard");
			});
    		$("#cancel_core_literacy_standard").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_core_literacy_standard").click();
    		});		
			$("#close_info_core_literacy_standard").click(function(){
		    	$("#form_info_core_literacy_standard_a").fadeOut(700, function(){ $("#form_info_core_literacy_standard").slideUp(400) });
		  	});
		  	$("#open_info_core_literacy_standard").click(function(){
		    	$("#form_info_core_literacy_standard").slideDown(400, function(){ $("#form_info_core_literacy_standard_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_core_literacy_standard").on('click', function() {
				// submit_core_literacy_standards
				// alert("submit");
				var val = "";
				var s = "";				
				var core_literacy_standards_count = <%= @core_literacy_standards.count %>;
				
				for(var i = 1; i < core_literacy_standards_count + 1; i++ )
				{
					s = "#ch_core_literacy_standard_" + i.toString();
					if ($(s).is(':checked')) {
						val += "," + i.toString();
					}
				}
				if (val.length > 1) {
					val = val.slice(1, val.length);
					// .substr(0, myString.length-4);
				}
				
				// alert(val);
				
				// var input_publisher_product_manifest_core_literacy_standard = $("#publisher_product_manifest_core_literacy_standard").val();
				// alert(input_publisher_product_manifest_core_literacy_standard);
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "core_literacy_standard":"' + val + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_core_literacy_standard',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
	            		// alert("success");
						show_control_standard("core_literacy_standard");	            		
						set_core_literacy_standard(data.g_core_literacy_standard);
						set_core_literacy_standard_text(data.g_core_literacy_standard_text);
						show_control("core_literacy_standard");
						//$("#focus_30").focus();
						// if(data.b_updated) {
							// set_updated(data.updated);
						// }													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});






			show_control_standard("core_math_standard");
			var gon_core_math_standard = gon.core_math_standard;
			set_core_math_standard(gon_core_math_standard);
			var gon_core_math_standard_text = gon.core_math_standard_text;
			set_core_math_standard_text(gon_core_math_standard_text);
			// set_control_required("core_math_standard", gon.b_required_core_math_standard);			
			
			
			
			// $(".core-math-standard").on('click', function() {
				// var cb = $(this).attr("id");
				// var ch = "ch_" + $(this).attr("name");
				// set_cb(ch, cb);
			// });
			
			
			// var cb = "";
			// var ch = "";
			// var sb = "";
			// var core_math_standards_count = <#%= @core_math_standards.count %#>;
			// for(var i = 1; i < core_math_standards_count + 1; i++ )
			// {
				// cb = "cb_core_math_standard_" + i.toString();
				// ch = "ch_core_math_standard_" + i.toString();				
				// sb = "#cb_core_math_standard_" + i.toString();
				// $(sb).on('click', function() {
					// alert(cb);
					// set_cb(ch, cb);
				// });
			// }
			
			$("#open_edit_core_math_standard").click(function(){
				show_control_standard_edit("core_math_standard");
		    	$("#publisher_product_core_math_standard_chosen").css({
		    		'width':'314px'
		    	});				
	    		$("#show_core_math_standard, #open_edit_core_math_standard").fadeOut(300, function(){
	    			$("#show_core_math_standard").addClass("hidden");
	    			$("#open_edit_core_math_standard").addClass("visibility-hidden");
	    			// $("#open_edit_core_math_standard").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_core_math_standard").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_core_math_standard").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_core_math_standard").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_core_math_standard").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_core_math_standard").click();
    		});			
			$("#cancel_core_math_standard").on('click', function() {
				show_control_standard("core_math_standard");
				show_control("core_math_standard");
			});
    		$("#cancel_core_math_standard").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_core_math_standard").click();
    		});		
			$("#close_info_core_math_standard").click(function(){
		    	$("#form_info_core_math_standard_a").fadeOut(700, function(){ $("#form_info_core_math_standard").slideUp(400) });
		  	});
		  	$("#open_info_core_math_standard").click(function(){
		    	$("#form_info_core_math_standard").slideDown(400, function(){ $("#form_info_core_math_standard_a").fadeIn( 2000 ) });
		  	});	
			$("#submit_core_math_standard").on('click', function() {
				// submit_core_math_standards
				// alert("submit");
				var val = "";
				var s = "";				
				var core_math_standards_count = <%= @core_math_standards.count %>;
				
				for(var i = 1; i < core_math_standards_count + 1; i++ )
				{
					s = "#ch_core_math_standard_" + i.toString();
					if ($(s).is(':checked')) {
						val += "," + i.toString();
					}
				}
				if (val.length > 1) {
					val = val.slice(1, val.length);
					// .substr(0, myString.length-4);
				}
				
				// alert(val);
				
				// var input_publisher_product_manifest_core_math_standard = $("#publisher_product_manifest_core_math_standard").val();
				// alert(input_publisher_product_manifest_core_math_standard);
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "core_math_standard":"' + val + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';     
			  	             
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_core_math_standard',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
	            		// alert("success");
						show_control_standard("core_math_standard");	            		
						set_core_math_standard(data.g_core_math_standard);
						set_core_math_standard_text(data.g_core_math_standard_text);
						show_control("core_math_standard");
						//$("#focus_30").focus();
						// if(data.b_updated) {
							// set_updated(data.updated);
						// }													
	            	},
	            	error: function(xhr){ alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});


			$("#submit_source_url").on('click', function() {
				var input_publisher_product_manifest_source_url = $("#publisher_product_manifest_source_url").val();
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "source_url":"' + input_publisher_product_manifest_source_url + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_source_url',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
						if (data.source_url.length > 0) {      		
							$("#publisher_product_manifest_source_url").attr("value", data.source_url);
							$("#render_source_url").removeClass("check-required");
							$("#render_source_url").addClass("check-affirm");
						}
						else {
							$("#publisher_product_manifest_source_url").attr("value", "");
							$("#render_source_url").removeClass("check-affirm");
							$("#render_source_url").addClass("check-required");
						}							
						$("#focus_24").focus();	
						set_updated(data.updated);												
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});


			$("#submit_updating_refresh_rate").on('click', function() {
				var input_publisher_product_manifest_updating_refresh_rate = $("#publisher_product_manifest_updating_refresh_rate").val();
				// alert(input_publisher_product_manifest_updating_refresh_rate);
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "updating_refresh_rate":"' + input_publisher_product_manifest_updating_refresh_rate + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_updating_refresh_rate',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
	            		
	            		// alert("success");
	            		// // // alert("len = " + data.len)
						if (data.b_has_updating_refresh_rate) {
							$("#render_updating_refresh_rate").removeClass("check-required");
							$("#render_updating_refresh_rate").addClass("check-affirm");
						}
						else {
							$("#render_updating_refresh_rate").removeClass("check-affirm");
							$("#render_updating_refresh_rate").addClass("check-required");
						}
						set_updating_refresh_rate(data.g_updated);
						$("#focus_30").focus();
						set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});


			$("#submit_updating_type").on('click', function() {
				var input_publisher_product_manifest_updating_type = $("#publisher_product_manifest_updating_type").val();
				// alert(input_publisher_product_manifest_updating_type);
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "updating_type":"' + input_publisher_product_manifest_updating_type + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_updating_type',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
	            		
	            		// alert("success");
	            		// // // alert("len = " + data.len)
						if (data.b_has_updating_type) {
							$("#render_updating_type").removeClass("check-required");
							$("#render_updating_type").addClass("check-affirm");
						}
						else {
							$("#render_updating_type").removeClass("check-affirm");
							$("#render_updating_type").addClass("check-required");
						}
						set_updating_type(data.g_updated);
						$("#focus_30").focus();
						set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});


			$("#submit_character").on('click', function() {
				var input_publisher_product_manifest_character = $("#publisher_product_manifest_character").val();
				// alert(input_publisher_product_manifest_character);
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "character":"' + input_publisher_product_manifest_character + 
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/publisher_product_manifests/update_character',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
	            		
	            		// alert("success");
	            		// // // alert("len = " + data.len)
						if (data.b_has_character) {
							$("#render_character").removeClass("check-required");
							$("#render_character").addClass("check-affirm");
						}
						else {
							$("#render_character").removeClass("check-affirm");
							$("#render_character").addClass("check-required");
						}
						set_character(data.g_updated);
						$("#focus_30").focus();
						set_updated(data.updated);													
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});






			$("#submit_reselling").on('click', function() {
				var ch_publisher_product_manifest_reselling = $("#ch_publisher_product_manifest_reselling").is(':checked');
				if( ch_publisher_product_manifest_reselling !== gon_reselling ) {
					gon_reselling = ch_publisher_product_manifest_reselling;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "reselling":' + ch_publisher_product_manifest_reselling + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_reselling',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							$("#render_reselling").addClass("check-affirm");
							$("#focus_21").focus();
							set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
			});


			$("#submit_evaluation").on('click', function() {
				var ch_publisher_product_manifest_evaluation = $("#ch_publisher_product_manifest_evaluation").is(':checked');
				if( ch_publisher_product_manifest_evaluation !== gon_evaluation ) {
					gon_evaluation = ch_publisher_product_manifest_evaluation;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "evaluation":' + ch_publisher_product_manifest_evaluation + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_evaluation',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							$("#render_evaluation").addClass("check-affirm");
							$("#focus_21").focus();
							set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
		  		else {
		  			$("#render_evaluation").removeClass("check-affirm");
		  			$("#render_evaluation").removeClass("check-required");
		  		}
			});





			// var gon_appropriate_grade = gon.appropriate_grade;
			// set_appropriate_grade(gon_appropriate_grade);
			// var gon_appropriate_grade_text = gon.appropriate_grade_text;
			// set_appropriate_grade_text(gon_appropriate_grade_text);
			// set_control_required("appropriate_grade", gon.b_required_appropriate_grade);			

			// if(<#%= @b_content_type %#>) {
				// $("#render_content_type").html("");
			// }
			// else {
				// $("#render_content_type").addClass("check-required");
			// }
			// $("#publisher_product_content_type").trigger("chosen:updated");
			// var gon_allow_teacher_rating = gon.allow_teacher_rating;
			// var gon_allow_teacher_rating_text = gon.allow_teacher_rating_text;
			// set_allow_teacher_rating_text(gon_allow_teacher_rating_text);
			// set_control_required("allow_teacher_rating", gon.b_required_allow_teacher_rating);		
			var gon_allow_teacher_rating = gon.allow_teacher_rating;
			set_allow_teacher_rating(gon_allow_teacher_rating);
			$("#cb_publisher_product_manifest_allow_teacher_rating").attr('checked', gon_allow_teacher_rating);
			set_cb_init("cb_publisher_product_manifest_allow_teacher_rating", "cb_allow_teacher_rating");			
			$("#open_edit_allow_teacher_rating").click(function(){
		    	// $("#publisher_product_allow_teacher_rating_chosen").css({
		    		// 'width':'314px'
		    	// });				
	    		$("#show_allow_teacher_rating, #open_edit_allow_teacher_rating").fadeOut(300, function(){
	    			$("#show_allow_teacher_rating").addClass("hidden");
	    			$("#open_edit_allow_teacher_rating").addClass("visibility-hidden");
	    			// $("#open_edit_allow_teacher_rating").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_allow_teacher_rating").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_allow_teacher_rating").fadeIn(1300).removeClass("hidden");
	    			$("#publisher_product_allow_teacher_rating").trigger("chosen:updated");
	    		});
		  	});
    		$("#submit_allow_teacher_rating").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_allow_teacher_rating").click();
    		});		
    		$("#cancel_allow_teacher_rating").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_allow_teacher_rating").click();
    		});		
			$("#cancel_allow_teacher_rating").on('click', function() {
				show_control("allow_teacher_rating");
				// show_edit_control("allow_teacher_rating", "right");
			});
			$("#close_info_allow_teacher_rating").click(function(){
		    	$("#form_info_allow_teacher_rating_a").fadeOut(700, function(){ $("#form_info_allow_teacher_rating").slideUp(400) });
		  	});
		  	$("#open_info_allow_teacher_rating").click(function(){
		    	$("#form_info_allow_teacher_rating").slideDown(400, function(){ $("#form_info_allow_teacher_rating_a").fadeIn( 2000 ) });
		  	});	    		

			$("#cb_container_allow_teacher_rating").on('click', function() {
				// cb_publisher_product_manifest_allow_teacher_rating
				set_cb("cb_publisher_product_manifest_allow_teacher_rating", "cb_allow_teacher_rating");
			});

		    	// $("#publisher_product_manifest_user_type_chosen").css({
		    		// 'width':'314px'
		    	// });

			// $("#ch_publisher_product_manifest_allow_teacher_rating").on('click', function() {
				// if( $("#ch_publisher_product_manifest_allow_teacher_rating").is(':checked') ) {
					// $("#publisher_product_manifest_user_rating").prop('disabled', false).trigger("chosen:updated");	
				// }
				// else {
					// $("#publisher_product_manifest_user_rating").prop('disabled', true).trigger("chosen:updated");						
				// }
			// });


			$("#submit_allow_teacher_rating").on('click', function() {
				var b_allow_teacher_rating_changed = false;
				var b_user_rating_changed = false;
				var s_user_rating = "";
				var obj_list = "";
				var obj = "";
				var obj_1 = "";
				var obj_2 = "";
				
				var cb_publisher_product_manifest_allow_teacher_rating = $("#cb_publisher_product_manifest_allow_teacher_rating").is(':checked');
				var input_publisher_product_manifest_user_rating = $("#publisher_product_manifest_user_rating").val();

				var ar_publisher_product_manifest_user_rating = [];
				for( var i = 1; i < 4; i++ ) {
					if( $.inArray( i.toString(), input_publisher_product_manifest_user_rating) !== -1 ) {
						ar_publisher_product_manifest_user_rating.push(true);
					}
					else {
						ar_publisher_product_manifest_user_rating.push(false);
					}
				}
				
				if(cb_publisher_product_manifest_allow_teacher_rating !== gon_allow_teacher_rating) {
					// alert('allow_teacher_rating changed');
					b_allow_teacher_rating_changed = true;
					// gon_allow_teacher_rating = ch_publisher_product_manifest_allow_teacher_rating;
				}
		  		else {
		  			// alert('not changed');
		  			$("#render_allow_teacher_rating").removeClass("check-affirm");
		  			$("#render_allow_teacher_rating").removeClass("check-required");
		  		}

				if(arraysAreIdentical(ar_publisher_product_manifest_user_rating, gon_user_rating)) {
		  			// alert('not changed');
		  			$("#render_user_rating").removeClass("check-affirm");
		  			$("#render_user_rating").removeClass("check-required");
				}
		  		else {
					// alert('changed');
					b_user_rating_changed = true;
					// gon_user_rating = input_publisher_product_manifest_user_rating;
		  		}

				if(b_allow_teacher_rating_changed || b_user_rating_changed) {
					
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "allow_teacher_rating":' + cb_publisher_product_manifest_allow_teacher_rating + 
								   ', "user_rating":"' + input_publisher_product_manifest_user_rating + 
								   '"}';      
					obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';

				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_allow_teacher_rating',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							if (b_allow_teacher_rating_changed) {
								$("#render_allow_teacher_rating").addClass("check-affirm");
							}
							if (b_user_rating_changed) {
								$("#render_user_rating").addClass("check-affirm");
							}
							gon_allow_teacher_rating = data.allow_teacher_rating;
							set_allow_teacher_rating(gon_allow_teacher_rating);
							// set_user_rating(data.user_rating);
							// gon_user_rating = data.user_rating;
							// $("#focus_21").focus();
							// set_updated(data.updated);		
							show_control("allow_teacher_rating");										
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
				}
			});


			var gon_allow_student_likes = gon.allow_student_likes;
			set_allow_student_likes(gon_allow_student_likes);
			$("#cb_publisher_product_manifest_allow_student_likes").attr('checked', gon_allow_student_likes);
			set_cb_init("cb_publisher_product_manifest_allow_student_likes", "cb_allow_student_likes");			
			$("#open_edit_allow_student_likes").click(function(){
	    		$("#show_allow_student_likes, #open_edit_allow_student_likes").fadeOut(300, function(){
	    			$("#show_allow_student_likes").addClass("hidden");
	    			$("#open_edit_allow_student_likes").addClass("visibility-hidden");
	    			// $("#open_edit_allow_student_likes").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_allow_student_likes").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_allow_student_likes").fadeIn(1300).removeClass("hidden");
	    		});
		  	});
    		$("#submit_allow_student_likes").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_allow_student_likes").click();
    		});		
    		$("#cancel_allow_student_likes").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_allow_student_likes").click();
    		});		
			$("#cancel_allow_student_likes").on('click', function() {
				show_control("allow_student_likes");
				// show_edit_control("allow_student_likes", "right");
			});
			$("#close_info_allow_student_likes").click(function(){
		    	$("#form_info_allow_student_likes_a").fadeOut(700, function(){ $("#form_info_allow_student_likes").slideUp(400) });
		  	});
		  	$("#open_info_allow_student_likes").click(function(){
		    	$("#form_info_allow_student_likes").slideDown(400, function(){ $("#form_info_allow_student_likes_a").fadeIn( 2000 ) });
		  	});	    		
			$("#cb_container_allow_student_likes").on('click', function() {
				// cb_publisher_product_manifest_allow_student_likes
				set_cb("cb_publisher_product_manifest_allow_student_likes", "cb_allow_student_likes");
			});
			$("#submit_allow_student_likes").on('click', function() {
				var cb_publisher_product_manifest_allow_student_likes = $("#cb_publisher_product_manifest_allow_student_likes").is(':checked');
				if( cb_publisher_product_manifest_allow_student_likes !== gon_allow_student_likes ) {
					gon_allow_student_likes = cb_publisher_product_manifest_allow_student_likes;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "allow_student_likes":' + cb_publisher_product_manifest_allow_student_likes + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_allow_student_likes',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							gon_allow_student_likes = data.allow_student_likes;
							set_allow_student_likes(gon_allow_student_likes);
							show_control("allow_student_likes");										
							// $("#render_allow_student_likes").addClass("check-affirm");
							// $("#focus_21").focus();
							// set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
		  		else {
		  			$("#render_allow_student_likes").removeClass("check-affirm");
		  			$("#render_allow_student_likes").removeClass("check-required");
		  		}
			});





			var gon_allow_comments = gon.allow_comments;
			set_allow_comments(gon_allow_comments);
			$("#cb_publisher_product_manifest_allow_comments").attr('checked', gon_allow_comments);
			set_cb_init("cb_publisher_product_manifest_allow_comments", "cb_allow_comments");			
			$("#open_edit_allow_comments").click(function(){
	    		$("#show_allow_comments, #open_edit_allow_comments").fadeOut(300, function(){
	    			$("#show_allow_comments").addClass("hidden");
	    			$("#open_edit_allow_comments").addClass("visibility-hidden");
	    			// $("#open_edit_allow_comments").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_allow_comments").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_allow_comments").fadeIn(1300).removeClass("hidden");
	    		});
		  	});
    		$("#submit_allow_comments").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_allow_comments").click();
    		});		
    		$("#cancel_allow_comments").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_allow_comments").click();
    		});		
			$("#cancel_allow_comments").on('click', function() {
				show_control("allow_comments");
				// show_edit_control("allow_comments", "right");
			});
			$("#close_info_allow_comments").click(function(){
		    	$("#form_info_allow_comments_a").fadeOut(700, function(){ $("#form_info_allow_comments").slideUp(400) });
		  	});
		  	$("#open_info_allow_comments").click(function(){
		    	$("#form_info_allow_comments").slideDown(400, function(){ $("#form_info_allow_comments_a").fadeIn( 2000 ) });
		  	});	    		
			$("#cb_container_allow_comments").on('click', function() {
				// cb_publisher_product_manifest_allow_comments
				set_cb("cb_publisher_product_manifest_allow_comments", "cb_allow_comments");
			});
			$("#submit_allow_comments").on('click', function() {
				var cb_publisher_product_manifest_allow_comments = $("#cb_publisher_product_manifest_allow_comments").is(':checked');
				if( cb_publisher_product_manifest_allow_comments !== gon_allow_comments ) {
					gon_allow_comments = cb_publisher_product_manifest_allow_comments;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "allow_comments":' + cb_publisher_product_manifest_allow_comments + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_allow_comments',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							gon_allow_comments = data.allow_comments;
							set_allow_comments(gon_allow_comments);
							show_control("allow_comments");										
							// $("#render_allow_comments").addClass("check-affirm");
							// $("#focus_21").focus();
							// set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
		  		else {
		  			$("#render_allow_comments").removeClass("check-affirm");
		  			$("#render_allow_comments").removeClass("check-required");
		  		}
			});



			var gon_poster_print_purchase = gon.poster_print_purchase;
			set_poster_print_purchase(gon_poster_print_purchase);
			$("#cb_publisher_product_manifest_poster_print_purchase").attr('checked', gon_poster_print_purchase);
			set_cb_init("cb_publisher_product_manifest_poster_print_purchase", "cb_poster_print_purchase");			
			$("#open_edit_poster_print_purchase").click(function(){
	    		$("#show_poster_print_purchase, #open_edit_poster_print_purchase").fadeOut(300, function(){
	    			$("#show_poster_print_purchase").addClass("hidden");
	    			$("#open_edit_poster_print_purchase").addClass("visibility-hidden");
	    			// $("#open_edit_poster_print_purchase").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_poster_print_purchase").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_poster_print_purchase").fadeIn(1300).removeClass("hidden");
	    		});
		  	});
    		$("#submit_poster_print_purchase").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_poster_print_purchase").click();
    		});		
    		$("#cancel_poster_print_purchase").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_poster_print_purchase").click();
    		});		
			$("#cancel_poster_print_purchase").on('click', function() {
				show_control("poster_print_purchase");
				// show_edit_control("poster_print_purchase", "right");
			});
			$("#close_info_poster_print_purchase").click(function(){
		    	$("#form_info_poster_print_purchase_a").fadeOut(700, function(){ $("#form_info_poster_print_purchase").slideUp(400) });
		  	});
		  	$("#open_info_poster_print_purchase").click(function(){
		    	$("#form_info_poster_print_purchase").slideDown(400, function(){ $("#form_info_poster_print_purchase_a").fadeIn( 2000 ) });
		  	});	    		
			$("#cb_container_poster_print_purchase").on('click', function() {
				// cb_publisher_product_manifest_poster_print_purchase
				set_cb("cb_publisher_product_manifest_poster_print_purchase", "cb_poster_print_purchase");
			});
			$("#submit_poster_print_purchase").on('click', function() {
				var cb_publisher_product_manifest_poster_print_purchase = $("#cb_publisher_product_manifest_poster_print_purchase").is(':checked');
				if( cb_publisher_product_manifest_poster_print_purchase !== gon_poster_print_purchase ) {
					gon_poster_print_purchase = cb_publisher_product_manifest_poster_print_purchase;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "poster_print_purchase":' + cb_publisher_product_manifest_poster_print_purchase + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_poster_print_purchase',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							gon_poster_print_purchase = data.poster_print_purchase;
							set_poster_print_purchase(gon_poster_print_purchase);
							show_control("poster_print_purchase");										
							// $("#render_poster_print_purchase").addClass("check-affirm");
							// $("#focus_21").focus();
							// set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
		  		else {
		  			$("#render_poster_print_purchase").removeClass("check-affirm");
		  			$("#render_poster_print_purchase").removeClass("check-required");
		  		}
			});



			var gon_poster_pin_web = gon.poster_pin_web;
			set_poster_pin_web(gon_poster_pin_web);
			$("#cb_publisher_product_manifest_poster_pin_web").attr('checked', gon_poster_pin_web);
			set_cb_init("cb_publisher_product_manifest_poster_pin_web", "cb_poster_pin_web");			
			$("#open_edit_poster_pin_web").click(function(){
	    		$("#show_poster_pin_web, #open_edit_poster_pin_web").fadeOut(300, function(){
	    			$("#show_poster_pin_web").addClass("hidden");
	    			$("#open_edit_poster_pin_web").addClass("visibility-hidden");
	    			// $("#open_edit_poster_pin_web").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_poster_pin_web").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_poster_pin_web").fadeIn(1300).removeClass("hidden");
	    		});
		  	});
    		$("#submit_poster_pin_web").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_poster_pin_web").click();
    		});		
    		$("#cancel_poster_pin_web").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_poster_pin_web").click();
    		});		
			$("#cancel_poster_pin_web").on('click', function() {
				show_control("poster_pin_web");
				// show_edit_control("poster_pin_web", "right");
			});
			$("#close_info_poster_pin_web").click(function(){
		    	$("#form_info_poster_pin_web_a").fadeOut(700, function(){ $("#form_info_poster_pin_web").slideUp(400) });
		  	});
		  	$("#open_info_poster_pin_web").click(function(){
		    	$("#form_info_poster_pin_web").slideDown(400, function(){ $("#form_info_poster_pin_web_a").fadeIn( 2000 ) });
		  	});	    		
			$("#cb_container_poster_pin_web").on('click', function() {
				// cb_publisher_product_manifest_poster_pin_web
				set_cb("cb_publisher_product_manifest_poster_pin_web", "cb_poster_pin_web");
			});
			$("#submit_poster_pin_web").on('click', function() {
				var cb_publisher_product_manifest_poster_pin_web = $("#cb_publisher_product_manifest_poster_pin_web").is(':checked');
				if( cb_publisher_product_manifest_poster_pin_web !== gon_poster_pin_web ) {
					gon_poster_pin_web = cb_publisher_product_manifest_poster_pin_web;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "poster_pin_web":' + cb_publisher_product_manifest_poster_pin_web + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_poster_pin_web',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							gon_poster_pin_web = data.poster_pin_web;
							set_poster_pin_web(gon_poster_pin_web);
							show_control("poster_pin_web");										
							// $("#render_poster_pin_web").addClass("check-affirm");
							// $("#focus_21").focus();
							// set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
		  		else {
		  			$("#render_poster_pin_web").removeClass("check-affirm");
		  			$("#render_poster_pin_web").removeClass("check-required");
		  		}
			});



			var gon_poster_pin_purchase = gon.poster_pin_purchase;
			set_poster_pin_purchase(gon_poster_pin_purchase);
			$("#cb_publisher_product_manifest_poster_pin_purchase").attr('checked', gon_poster_pin_purchase);
			set_cb_init("cb_publisher_product_manifest_poster_pin_purchase", "cb_poster_pin_purchase");			
			$("#open_edit_poster_pin_purchase").click(function(){
	    		$("#show_poster_pin_purchase, #open_edit_poster_pin_purchase").fadeOut(300, function(){
	    			$("#show_poster_pin_purchase").addClass("hidden");
	    			$("#open_edit_poster_pin_purchase").addClass("visibility-hidden");
	    			// $("#open_edit_poster_pin_purchase").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank").addClass("visibility-hidden");
	    			// $("#open_edit_poster_pin_purchase").removeClass("edit-icon-right").removeClass("pop-info").removeClass("tip").addClass("edit-icon-blank");
	    			$("#edit_poster_pin_purchase").fadeIn(1300).removeClass("hidden");
	    		});
		  	});
    		$("#submit_poster_pin_purchase").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_poster_pin_purchase").click();
    		});		
    		$("#cancel_poster_pin_purchase").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_poster_pin_purchase").click();
    		});		
			$("#cancel_poster_pin_purchase").on('click', function() {
				show_control("poster_pin_purchase");
				// show_edit_control("poster_pin_purchase", "right");
			});
			$("#close_info_poster_pin_purchase").click(function(){
		    	$("#form_info_poster_pin_purchase_a").fadeOut(700, function(){ $("#form_info_poster_pin_purchase").slideUp(400) });
		  	});
		  	$("#open_info_poster_pin_purchase").click(function(){
		    	$("#form_info_poster_pin_purchase").slideDown(400, function(){ $("#form_info_poster_pin_purchase_a").fadeIn( 2000 ) });
		  	});	    		
			$("#cb_container_poster_pin_purchase").on('click', function() {
				// cb_publisher_product_manifest_poster_pin_purchase
				set_cb("cb_publisher_product_manifest_poster_pin_purchase", "cb_poster_pin_purchase");
			});
			$("#submit_poster_pin_purchase").on('click', function() {
				var cb_publisher_product_manifest_poster_pin_purchase = $("#cb_publisher_product_manifest_poster_pin_purchase").is(':checked');
				if( cb_publisher_product_manifest_poster_pin_purchase !== gon_poster_pin_purchase ) {
					gon_poster_pin_purchase = cb_publisher_product_manifest_poster_pin_purchase;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "poster_pin_purchase":' + cb_publisher_product_manifest_poster_pin_purchase + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_poster_pin_purchase',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							gon_poster_pin_purchase = data.poster_pin_purchase;
							set_poster_pin_purchase(gon_poster_pin_purchase);
							show_control("poster_pin_purchase");										
							// $("#render_poster_pin_purchase").addClass("check-affirm");
							// $("#focus_21").focus();
							// set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
		  		else {
		  			$("#render_poster_pin_purchase").removeClass("check-affirm");
		  			$("#render_poster_pin_purchase").removeClass("check-required");
		  		}
			});





			// set_control_span("corporate_logo_url", gon.corporate_logo_url, gon.b_corporate_logo_url);
			// set_control_required("corporate_logo_url", gon.b_required_corporate_logo_url);
			// // if(<#%= @b_corporate_logo_url %#>) {
				// // $("#render_corporate_logo_url").html("");
			// // }
			// // else {
				// // $("#render_corporate_logo_url").addClass("check-required");
			// // }
    		// $("#submit_corporate_logo_url").keypress(function(e){
      			// if(e.keyCode==13)
      			// $("#submit_corporate_logo_url").click();
    		// });
    		// $("#cancel_corporate_logo_url").keypress(function(e){
      			// if(e.keyCode==13)
      			// $("#cancel_corporate_logo_url").click();
    		// });
			// $("#open_edit_corporate_logo_url").click(function(){
	    		// $("#show_corporate_logo_url, #open_edit_corporate_logo_url").fadeOut(300, function(){
	    			// $("#show_corporate_logo_url").addClass("hidden");
	    			// $("#open_edit_corporate_logo_url").addClass("visibility-hidden");
	    			// $("#edit_corporate_logo_url").fadeIn(1300).removeClass("hidden");
	    		// });
		  	// });
			// $("#cancel_corporate_logo_url").on('click', function() {
				// show_control("corporate_logo_url");
			// });
			// $("#close_info_corporate_logo_url").click(function(){
		    	// $("#form_info_corporate_logo_url_a").fadeOut(700, function(){ $("#form_info_corporate_logo_url").slideUp(400) });
		  	// });
		  	// $("#open_info_corporate_logo_url").click(function(){
		    	// $("#form_info_corporate_logo_url").slideDown(400, function(){ $("#form_info_corporate_logo_url_a").fadeIn( 2000 ) });
		  	// });	    								
			// $("#submit_corporate_logo_url").on('click', function() {
				// var input_publisher_product_manifest_corporate_logo_url = $("#publisher_product_manifest_corporate_logo_url").val();
				// var obj_list = '{ "publisher_product_id":' + <#%= @publisher_product_id %#> + 
							   // ', "corporate_logo_url":"' + input_publisher_product_manifest_corporate_logo_url + 
							   // '"}';      
			  	// var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	// $.ajax({
			    	// type: 'POST',
			    	// // data : JSON.stringify(obj),
			    	// data : obj,
			    	// url: '/publisher_product_manifests/update_corporate_logo_url',			    	
			    	// dataType: "json",
			    	// contentType: "application/json",
			    	// processData: false,
			    	// beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	// statusCode: {
	            	// },
	            	// success: function(data) {
						// set_control_span("corporate_logo_url", data.corporate_logo_url, data.b_corporate_logo_url);
						// // set_control_required("corporate_logo_url", data.b_required);
						// show_control("corporate_logo_url");				
						// // $("#focus_12").focus();
						// // set_updated(data.updated);	
	            	// },
	            	// error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	// });
		  		// return false;
			// });





			$("#submit_research").on('click', function() {
				var input_publisher_product_manifest_research = $("#publisher_product_manifest_research").val();
				
				// alert(input_publisher_product_manifest_research);
				
				var ar_publisher_product_manifest_research = [];
				for( var i = 1; i < 3; i++ ) {
					if( $.inArray( i.toString(), input_publisher_product_manifest_research) !== -1 ) {
						ar_publisher_product_manifest_research.push(true);
					}
					else {
						ar_publisher_product_manifest_research.push(false);
					}
				}
				
				alert("ar_publisher_product_manifest_research = " + ar_publisher_product_manifest_research);
				alert("gon_research = " + gon_research);
				
				if(!arraysAreIdentical(ar_publisher_product_manifest_research, gon_research)) {
					gon_research = ar_publisher_product_manifest_research;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "research":"' + input_publisher_product_manifest_research + 
								   '"}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_research',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							$("#render_research").addClass("check-affirm");
							// $("#focus_21").focus();
							set_research(data.research);
							set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
		  		else {
		  			alert("identical");
		  			$("#render_research").removeClass("check-affirm");
		  			$("#render_research").removeClass("check-required");
		  		}
			});


			$("#submit_public_relations").on('click', function() {
				var ch_publisher_product_manifest_pr_updates_1 = $("#ch_publisher_product_manifest_pr_updates_1").is(':checked');
				var ch_publisher_product_manifest_pr_updates_2 = $("#ch_publisher_product_manifest_pr_updates_2").is(':checked');
				var ch_publisher_product_manifest_pr_updates_3 = $("#ch_publisher_product_manifest_pr_updates_3").is(':checked');
				
				var b_changed = false;
				var b_pr_updates_1_changed = false;
				var b_pr_updates_2_changed = false;
				var b_pr_updates_3_changed = false;

				var ar_public_relations = [];
				ar_public_relations[0] = ch_publisher_product_manifest_pr_updates_1;
				ar_public_relations[1] = ch_publisher_product_manifest_pr_updates_2;
				ar_public_relations[2] = ch_publisher_product_manifest_pr_updates_3;
				
				// alert(ch_publisher_product_manifest_pr_updates_1);
				// alert(gon_public_relations[0]);
				
				if( ch_publisher_product_manifest_pr_updates_1 !== gon_public_relations[0] ) {
					b_pr_updates_1_changed = true;
				}
				if( ch_publisher_product_manifest_pr_updates_2 !== gon_public_relations[1] ) {
					b_pr_updates_2_changed = true;
				}
				if( ch_publisher_product_manifest_pr_updates_3 !== gon_public_relations[2] ) {
					b_pr_updates_3_changed = true;
				}
				
				// if( b_pr_updates_1_changed ||
					// b_pr_updates_2_changed ||
					// b_pr_updates_3_changed ) {
					// b_changed = true;
				// }				
				
				if(!arraysAreIdentical(ar_public_relations, gon_public_relations)) {
					gon_public_relations = ar_public_relations;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "pr_updates_1":' + ch_publisher_product_manifest_pr_updates_1 + 
								   ', "pr_updates_2":' + ch_publisher_product_manifest_pr_updates_2 + 
								   ', "pr_updates_3":' + ch_publisher_product_manifest_pr_updates_3 + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_public_relations',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							if ( b_pr_updates_1_changed ) {
								$("#render_pr_updates_1").addClass("check-affirm");
							}
							if ( b_pr_updates_2_changed ) {
								$("#render_pr_updates_2").addClass("check-affirm");
							}
							if ( b_pr_updates_3_changed ) {
								$("#render_pr_updates_3").addClass("check-affirm");
							}
							gon_public_relations = data.public_relations;
							set_public_relations(data.public_relations);
							// $("#focus_21").focus();
							set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
		  		else {
		  			var ss = "";
		  			for( var i = 1; i < 4; i++ ) {
		  				ss = "#render_pr_updates_" + i.toString();
			  			$(ss).removeClass("check-affirm");
			  			$(ss).removeClass("check-required");
		  			}
		  		}
			});


			$("#submit_metrics").on('click', function() {
				var ch_publisher_product_manifest_metrics_1 = $("#ch_publisher_product_manifest_metrics_1").is(':checked');
				var ch_publisher_product_manifest_metrics_2 = $("#ch_publisher_product_manifest_metrics_2").is(':checked');
				var ch_publisher_product_manifest_metrics_3 = $("#ch_publisher_product_manifest_metrics_3").is(':checked');
				var ch_publisher_product_manifest_metrics_4 = $("#ch_publisher_product_manifest_metrics_4").is(':checked');
				var ch_publisher_product_manifest_metrics_5 = $("#ch_publisher_product_manifest_metrics_5").is(':checked');
				
				var b_changed = false;
				var b_metrics_1_changed = false;
				var b_metrics_2_changed = false;
				var b_metrics_3_changed = false;
				var b_metrics_4_changed = false;
				var b_metrics_5_changed = false;

				var ar_metrics = [];
				ar_metrics[0] = ch_publisher_product_manifest_metrics_1;
				ar_metrics[1] = ch_publisher_product_manifest_metrics_2;
				ar_metrics[2] = ch_publisher_product_manifest_metrics_3;
				ar_metrics[3] = ch_publisher_product_manifest_metrics_4;
				ar_metrics[4] = ch_publisher_product_manifest_metrics_5;
				
				// alert(ch_publisher_product_manifest_metrics_1);
				// alert(gon_metrics[0]);
				
				if( ch_publisher_product_manifest_metrics_1 !== gon_metrics[0] ) {
					b_metrics_1_changed = true;
				}
				if( ch_publisher_product_manifest_metrics_2 !== gon_metrics[1] ) {
					b_metrics_2_changed = true;
				}
				if( ch_publisher_product_manifest_metrics_3 !== gon_metrics[2] ) {
					b_metrics_3_changed = true;
				}
				if( ch_publisher_product_manifest_metrics_4 !== gon_metrics[3] ) {
					b_metrics_4_changed = true;
				}
				if( ch_publisher_product_manifest_metrics_5 !== gon_metrics[4] ) {
					b_metrics_5_changed = true;
				}
				
				// if( b_metrics_1_changed ||
					// b_metrics_2_changed ||
					// b_metrics_3_changed ) {
					// b_changed = true;
				// }				
				
				if(!arraysAreIdentical(ar_metrics, gon_metrics)) {
					// gon_metrics = ar_metrics;
					var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
								   ', "metrics_1":' + ch_publisher_product_manifest_metrics_1 + 
								   ', "metrics_2":' + ch_publisher_product_manifest_metrics_2 + 
								   ', "metrics_3":' + ch_publisher_product_manifest_metrics_3 + 
								   ', "metrics_4":' + ch_publisher_product_manifest_metrics_4 + 
								   ', "metrics_5":' + ch_publisher_product_manifest_metrics_5 + 
								   '}';      
				  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
				  	$.ajax({
				    	type: 'POST',
				    	data : obj,
				    	url: '/publisher_product_manifests/update_metrics',			    	
				    	dataType: "json",
				    	contentType: "application/json",
				    	processData: false,
				    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		            	statusCode: {
		            	},
		            	success: function(data) {
							if ( b_metrics_1_changed ) {
								$("#render_metrics_1").addClass("check-affirm");
							}
							if ( b_metrics_2_changed ) {
								$("#render_metrics_2").addClass("check-affirm");
							}
							if ( b_metrics_3_changed ) {
								$("#render_metrics_3").addClass("check-affirm");
							}
							if ( b_metrics_4_changed ) {
								$("#render_metrics_4").addClass("check-affirm");
							}
							if ( b_metrics_5_changed ) {
								$("#render_metrics_5").addClass("check-affirm");
							}
							gon_metrics = data.metrics;
							set_metrics(data.metrics);
							// $("#focus_21").focus();
							set_updated(data.updated);												
		            	},
		            	error: function(xhr){  alert("error: " + xhr.statusText); }        
				  	});
			  		return false;
		  		}
		  		else {
		  			var ss = "";
		  			for( var i = 1; i < 6; i++ ) {
		  				ss = "#render_metrics_" + i.toString();
			  			$(ss).removeClass("check-affirm");
			  			$(ss).removeClass("check-required");
		  			}
		  		}
			});


	
			// $("#submit_word_description").on('click', function() {
				// var input_publisher_product_manifest_word_description = $("#publisher_product_manifest_word_description").val();
				// var obj_list = '{ "publisher_product_id":' + <#%= @publisher_product_id %#> + 
							   // ', "word_description":"' + input_publisher_product_manifest_word_description + 
							   // '"}';      
			  	// var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	// $.ajax({
			    	// type: 'POST',
			    	// data : obj,
			    	// url: '/publisher_product_manifests/update_word_description',			    	
			    	// dataType: "json",
			    	// contentType: "application/json",
			    	// processData: false,
			    	// beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	// statusCode: {
	            	// },
	            	// success: function(data) {
						// if (data.word_description.length > 0) {      		
							// $("#publisher_product_manifest_word_description").attr("value", data.word_description);
							// $("#render_word_description_1").removeClass("check-required");
							// $("#render_word_description_2").addClass("check-affirm");
						// }
						// else {
							// $("#publisher_product_manifest_word_description").attr("value", "");
							// $("#render_word_description_1").addClass("check-required");
							// $("#render_word_description_2").removeClass("check-affirm");
						// }							
						// $("#box_profile_general").focus();	
						// set_updated(data.updated);												
	            	// },
	            	// error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	// });
		  		// return false;
			// });

	
	  		// $("#publisher_product_enhancement").on('change', function(evt, params) {
  				// other_selected_enhancement(params.selected, params.deselected);
  			// });
			// var gon_enhancement = gon.enhancement;
			// set_enhancement(gon.enhancement, gon.has_enhancement_other);
			// var gon_enhancement_text = gon.enhancement_text;
			// set_enhancement_text(gon_enhancement_text, gon.has_enhancement_other, gon.enhancement_other);
			// set_control_required("enhancement", gon.b_required_enhancement);			
			// $("#open_edit_enhancement").click(function(){
		    	// $("#publisher_product_enhancement_chosen").css({
		    		// 'width':'314px'
		    	// });				
	    		// $("#show_enhancement, #open_edit_enhancement").fadeOut(300, function(){
	    			// $("#show_enhancement").addClass("hidden");
	    			// $("#open_edit_enhancement").addClass("visibility-hidden");
	    			// $("#edit_enhancement").fadeIn(1300).removeClass("hidden");
	    			// $("#publisher_product_enhancement").trigger("chosen:updated");
	    		// });
		  	// });
    		// $("#submit_enhancement").keypress(function(e){
      			// if(e.keyCode==13)
      			// $("#submit_enhancement").click();
    		// });			
			// $("#cancel_enhancement").on('click', function() {
				// show_control("enhancement");
			// });
    		// $("#cancel_enhancement").keypress(function(e){
      			// if(e.keyCode==13)
      			// $("#cancel_enhancement").click();
    		// });		
			// $("#close_info_enhancement").click(function(){
		    	// $("#form_info_enhancement_a").fadeOut(700, function(){ $("#form_info_enhancement").slideUp(400) });
		  	// });
		  	// $("#open_info_enhancement").click(function(){
		    	// $("#form_info_enhancement").slideDown(400, function(){ $("#form_info_enhancement_a").fadeIn( 2000 ) });
		  	// });	
			$("#btn_square_purchase").on('click', function() {
				// var input_amount = $("#amount").val();
				var input_amount = 23.45;
				var obj_list = '{ "publisher_product_id":' + <%= @publisher_product_id %> + 
							   ', "amount":' + input_amount + 
							   '}';      
			  	var obj = '{ "payment": [' +  obj_list + '] }';                  
			  	$.ajax({
			    	type: 'POST',
			    	data : obj,
			    	url: '/payments/payment',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
	            		alert(data.amount);
	            		// if (data.url) { window.location.href = data.url; }
	            		window.location.href = "/Purchase";
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});

	
		  // text_field_tag :name_pdf %> 
		  // file_field_tag :name_file, :class => 'input-upload'
		  // hidden_field_tag :publisher_product_id, @publisher_product_id
		  // hidden_field_tag :authenticity_token, form_authenticity_token
		  // submit_tag "Upload", :id => 'submit_pdf', :class => 'submit-upload' 
	
	
			// $("#submit_pdf").on('click', function() {
			// $("#upload_form_pdf").on('submit', function() {
// 
				// // var input_publisher_product_manifest_research = $("#publisher_product_manifest_research").val();
				// // var input_name_pdf = $("#name_pdf").val();
				// // var input_name_file = $("#name_file").val();
// 				
				// // alert(input_name_pdf);
				// alert('upload_form_pdf submit');
				// // input_name_pdf = "clyde was here";
				// // var obj_list = '{ "publisher_product_id":' + <#%= @publisher_product_id %#> + 
							   // // ', "name_pdf":"' + input_name_pdf + 
							   // // '"}';      
			  	// // var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  
			  	// // $.ajax({
			    	// // type: 'POST',
			    	// // data : obj,
			    	// // url: '/publisher_product_manifests/upload_pdf',			    	
			    	// // dataType: "json",
			    	// // contentType: "application/json",
			    	// // processData: false,
			    	// // beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	// // statusCode: {
	            	// // },
	            	// // success: function(data) {
						// // alert(data.name_pdf);
	            	// // },
	            	// // error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	// // });
		  		// return false;
			// });



			// $('#upload_form_pdf input').change(function(){
				// alert('upload_form_pdf input');
			 	// $(this).closest('form').ajaxSubmit({
			  		// beforeSubmit: function(a,f,o) {
			   			// o.dataType = 'json';
			  		// },
	        		// success: function(data) {
						// // alert(data.name_pdf);
						// alert('success');
	        		// },
	        		// error: function(xhr){  alert("error: " + xhr.statusText); },        
			  		// complete: function(XMLHttpRequest, textStatus) {
			   			// // XMLHttpRequest.responseText will contain the URL of the uploaded image.
			   			// // Put it in an image element you create, or do with it what you will.
			   			// // For example, if you have an image elemtn with id "my_image", then
			   			// //  $('#my_image').attr('src', XMLHttpRequest.responseText);
			   			// // Will set that image tag to display the uploaded image.
			  		// },
			 	// });
			// })


			$("#close_status").click(function(){
		    	$("#form_status").slideUp(400, function(){
		    		$("#close_status").addClass("hidden");
		    		$("#open_status").removeClass("hidden");
		    	});				
		  	});
		  	$("#open_status").click(function(){
		    	$("#form_status").slideDown(400, function(){
		    		$("#open_status").addClass("hidden");
		    		$("#close_status").removeClass("hidden");
		    	});
		  	});	
	
			$("#close_form1").click(function(){
		    	$("#form1a").fadeOut(700, function(){ $("#form1").slideUp(400) });
		  	});
		  	$("#open_form1").click(function(){
		    	$("#form1").slideDown(400, function(){ $("#form1a").fadeIn( 2000 ) });
		  	});	
	
			$("#close_form2").click(function(){
		    	$("#form2a").fadeOut(700, function(){ $("#form2").slideUp(400) });
		  	});
		  	$("#open_form2").click(function(){
		    	$("#form2").slideDown(400, function(){ $("#form2a").fadeIn( 2000 ) });
		  	});	

			$("#close_form3").click(function(){
		    	$("#form3a").fadeOut(700, function(){ $("#form3").slideUp(400) });
		  	});
		  	$("#open_form3").click(function(){
		    	$("#publisher_product_content_type_chosen").css({
		    		'width':'314px'
		    	});
		    	$("#publisher_product_category_subject_chosen").css({
		    		'width':'314px'
		    	});
		    	$("#publisher_product_platform_chosen").css({
		    		'width':'314px'
		    	});
		    	$("#publisher_product_file_type_chosen").css({
		    		'width':'314px'
		    	});
		    	$("#publisher_product_enhancement_chosen").css({
		    		'width':'314px'
		    	});

		    	$("#form3").slideDown(400, function(){ $("#form3a").fadeIn( 2000 ) });
		    	// $("#form3").slideDown(400);

		  	});	

			$("#close_form4").click(function(){
		    	$("#form4a").fadeOut(700, function(){ $("#form4").slideUp(400) });
		  	});
		  	$("#open_form4").click(function(){
		    	$("#form4").slideDown(400, function(){ $("#form4a").fadeIn( 2000 ) });
		  	});	

			$("#close_form8").click(function(){
		    	$("#form8a").fadeOut(700, function(){ $("#form8").slideUp(400) });
		  	});
		  	$("#open_form8").click(function(){
		    	$("#form8").slideDown(400, function(){ $("#form8a").fadeIn( 2000 ) });
		  	});	
	
			$("#close_form5").click(function(){
		    	$("#form5a").fadeOut(700, function(){ $("#form5").slideUp(400) });
		  	});
		  	$("#open_form5").click(function(){
		    	$("#form5").slideDown(400, function(){ $("#form5a").fadeIn( 2000 ) });
		  	});	

			$("#close_form6").click(function(){
		    	$("#form6a").fadeOut(700, function(){ $("#form6").slideUp(400) });
		  	});
		  	$("#open_form6").click(function(){
		    	$("#form6").slideDown(400, function(){ $("#form6a").fadeIn( 2000 ) });
		  	});	

			$("#close_form7").click(function(){
		    	$("#form7a").fadeOut(700, function(){ $("#form7").slideUp(400) });
		  	});
		  	$("#open_form7").click(function(){
		    	$("#form7").slideDown(400, function(){ $("#form7a").fadeIn( 2000 ) });
		  	});	

			$("#close_form9").click(function(){
		    	$("#form9a").fadeOut(700, function(){ $("#form9").slideUp(400) });
		  	});
		  	$("#open_form9").click(function(){
		    	$("#form9").slideDown(400, function(){ $("#form9a").fadeIn( 2000 ) });
		  	});	

			$("#close_form_price").click(function(){
		    	$("#form_price_a").fadeOut(700, function(){ $("#form_price").slideUp(400) });
		  	});
		  	$("#open_form_price").click(function(){
		    	$("#form_price").slideDown(400, function(){ $("#form_price_a").fadeIn( 2000 ) });
		  	});	
	



	
		});
	  
	</script>		


	<script>
		
		
		
		// *****
		// html textarea - description

		var savedRange_description,isInFocus_description;

 		function saveSelection_description()
		{
		    if(window.getSelection)//non IE Browsers
		    {
		        savedRange_description = window.getSelection().getRangeAt(0);
		    }
		    else if(document.selection)//IE
		    { 
		        savedRange_description = document.selection.createRange();  
		    } 
		}
		
		function restoreSelection_description()
		{
		    isInFocus_description = true;
		    document.getElementById("textarea_description_edit").focus();
		    if (savedRange_description != null) {
		        if (window.getSelection)//non IE and there is already a selection
		        {
		            var s = window.getSelection();
		            if (s.rangeCount > 0) 
		                s.removeAllRanges();
		            s.addRange(savedRange_description);
		        }
		        else if (document.createRange)//non IE and no selection
		        {
		            window.getSelection().addRange(savedRange_description);
		        }
		        else if (document.selection)//IE
		        {
		            savedRange_description.select();
		        }
		    }
		}
		
		//this part onwards is only needed if you want to restore selection onclick
		var isInFocus_description = false;
		function onDivBlur_description()
		{
		    isInFocus_description = false;
		}
		
		function cancelEvent_description(e)
		{
		    if (isInFocus_description == false && savedRange_description != null) {
		        if (e && e.preventDefault) {
		            //alert("FF");
		            e.stopPropagation(); // DOM style (return false doesn't always work in FF)
		            e.preventDefault();
		        }
		        else {
		            window.event.cancelBubble = true;//IE stopPropagation
		        }
		        restoreSelection_description();
		        return false; // false = IE style
		    }
		}
		
		function insertTextAtCursor_description(text) {
		    var sel, range, html;
		    if (window.getSelection) {
		        sel = window.getSelection();
		        if (sel.getRangeAt && sel.rangeCount) {
		            range = sel.getRangeAt(0);
		            range.deleteContents();
		            range.insertNode( document.createTextNode(text) );
		            range.collapse(false);
		        }
		    } else if (document.selection && document.selection.createRange) {
		        document.selection.createRange().text = text;
		    }
		}			  	

		function doGetCaretPosition (ctrl) {
			var CaretPos = 0;   // IE Support
			if (document.selection) {
				ctrl.focus ();
				var Sel = document.selection.createRange ();
				Sel.moveStart ('character', -ctrl.value.length);
				CaretPos = Sel.text.length;
			}
			// Firefox support
			else if (ctrl.selectionStart || ctrl.selectionStart == '0') {
				CaretPos = ctrl.selectionStart;
			}
			return (CaretPos);
		}
		
		// function setCaretPosition(ctrl, pos){
			// if(ctrl.setSelectionRange)
			// {
				// ctrl.focus();
				// ctrl.setSelectionRange(pos,pos);
			// }
			// else if (ctrl.createTextRange) {
				// var range = ctrl.createTextRange();
				// range.collapse(true);
				// range.moveEnd('character', pos);
				// range.moveStart('character', pos);
				// range.select();
			// }
		// }
		
		// function setCaretPosition(elemId, caretPos) {
		    // var elem = document.getElementById(elemId);
		    // if(elem != null) {
		        // if(elem.createTextRange) {
		            // var range = elem.createTextRange();
		            // range.move('character', caretPos);
		            // range.select();
		        // }
		        // else {
		            // if(elem.selectionStart) {
		                // elem.focus();
		                // elem.setSelectionRange(caretPos, caretPos);
		            // }
		            // else
		                // elem.focus();
		        // }
		    // }
		// }		

		
		// *****
		// story 2 description
		
		var story_2_description_html = null;
		
		function partial_init_render_story_2() {
			var v = $("#textarea_description").html();
			// var w = $("#render_description_image").html();
			var w = "";
			if ( ((v == "<br>") || (v == "")) && ((w == "<br>") || (w == "")) ) {
				$("#textarea_description").addClass("textarea-description-empty");
			}
			else {
				$("#textarea_description").removeClass("textarea-description-empty");
			}			
		}

		function partial_init_render_story_2_edit() {
			var v = $("#textarea_description_edit").html();
			var w = $("#render_description_image_edit").html();
			if ( ((v == "<br>") || (v == "")) && ((w == "<br>") || (w == "")) ) {
				$("#textarea_description_edit").addClass("textarea-description-empty");
			}
			else {
				$("#textarea_description_edit").removeClass("textarea-description-empty");
			}			
		}

		// function init_render_story_2_edit() {
			// partial_init_render_story_2_edit();
		// }
		
		function init_render_story_2() {
			$("#textarea_description").html(story_2_description_html);
			partial_init_render_story_2();
		}


	  	function showEditStory2_1() {
	  		var textarea_html = $("#textarea_description").html();
    			$("#textarea_description_edit").html(textarea_html);
	  			$("#textarea_description_edit").focus();								
		}

	  	function showEditStory2() {
	  		// var textarea_html = $("#textarea_description").html();
			$("#open_edit_story_2, .show-story-2").fadeOut(200, function(){    			
				$("#open_edit_story_2").addClass("hidden");
				$("#close_edit_story_2").fadeIn(200).removeClass("hidden");
    			$(".show-story-2").addClass("hidden");
    			$(".edit-story-2").fadeIn(300).removeClass("hidden");    	
    			// $("#textarea_description_edit").html(textarea_html);
				$(".btn-textarea-description-story-2-container").removeClass("hidden");
				// // init_render_story_2_edit();
	  			// $("#textarea_description_edit").focus();
	  			showEditStory2_1();								
    		});
	  	}
	  	function cancelEditStory2() {
	  		// $("#render_description_image").html(""); Must call db delete on image
	  		// $("#textarea_description").html("");
			init_render_story_2();
			hideEditStory2();	
	  	}
		function closeEditStory2() {
			$("#submit_story_2_loader").addClass("hidden");
			$("#submit_story_2_text").removeClass("hidden");
			cancelEditStory2();		
		}
		function hideEditStory2() {
	  		$(".edit-story-2").fadeOut(200, function(){
    			$(".edit-story-2").addClass("hidden");
    			$(".show-story-2").removeClass("hidden").fadeIn(300);
				$("#open_edit_story_2").removeClass("hidden").fadeIn(200);
				$("#close_edit_story_2").addClass("hidden");
			});			
		}
		
		// var b_edit_description = false;
		// var description_id_delete = null;
		
		// function edit_textarea_description() {
			// b_edit_description = true;
			// $("#textarea_description").removeClass("textarea-description-inactive").addClass("textarea-description-active");
			// // $(".btn-textarea-description-story-2-container").removeClass("hidden");
		// }		
		// function reset_textarea_description() {
			// $("#render_description_image").html("");
			// $("#textarea_description").html("<br>");
			// $(".btn-textarea-description-story-2-container").addClass("hidden");
			// $("#textarea_description").removeClass("textarea-description-active").addClass("textarea-description-inactive");
			// b_edit_description = false;
		// }
		
		// function delete_description(id) {
			// var formData = {description_id:id};
		  	// $.ajax({
		    	// type: 'POST',
		    	// data : formData,
		    	// url: '/publisher_users/destroy_description',			    	
		    	// dataType: "script",
		    	// beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	// statusCode: {
            	// },
            	// success: function(data) {
            	// },
            	// error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	// });
		// }
		// function cancel_description() {
		  	// $.ajax({
		    	// type: 'POST',
		    	// url: '/publisher_users/cancel_description',			    	
		    	// dataType: "script",
		    	// beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	// statusCode: {
            	// },
            	// success: function(data) {
            	// },
            	// error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	// });
		// }
		// function cancel_description_on_close() {
			// var w = $("#render_description_image").html();
			// if ( !( (w == "<br>") || (w == "") ) ) {
				// $.ajax({
					// type: 'POST',
					// url: '/publisher_users/cancel_description_on_close',			    	
					// dataType: "script",
					// async: false,
					// beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))} // ,
				// });
			// }
		// }
		
		var drop_story_2_attach_visible = false;
		var btn_1_drop_description_image_clicked = false;

		function drop_story_2_attach_show() {
			$("#drop_story_2_attach").addClass('drop');
			$("#container_drop_story_2_attach").removeClass('hidden');
			$("#drop_story_2_attach div div.dropdownContain div.dropOut").fadeIn(200, function() {
				$(this).css({ 
					'margin-top' : 10
				});
			});
			$("#caret_story_2_attach").removeClass("nav-caret-down").addClass("nav-caret-up");
			drop_story_2_attach_visible = true;			
		}	
		function drop_story_2_attach_hide() {
			$("#drop_story_2_attach").removeClass('drop');
			$("#container_drop_story_2_attach").addClass('hidden');
			drop_story_2_attach_visible = false;			
			$("#drop_story_2_attach div div.dropdownContain div.dropOut").css({
				'margin-top' : 0
			});
			$("#caret_story_2_attach").removeClass("nav-caret-up").addClass("nav-caret-down");
			
			if( btn_1_drop_description_image_clicked == true ) {
				btn_1_drop_description_image_clicked = false;
				$("form#new_description_image input#new_description_image_image").click();
			}
		}	
		function drop_toggle_story_2_attach() {
			if (drop_story_2_attach_visible) {
				drop_story_2_attach_hide();
			}
			else {
				drop_story_2_attach_show();
			}
		}	
		
		
		
		
		
		// $(window).load( function() {
		$(document).ready(function () {				


			// *****
			// story 2 description

			document.body.setAttribute('spellcheck', false);

			story_2_description_html = "<%= @publisher_product_description_description_text.html_safe %>";
			init_render_story_2();
			
		  	$("#open_edit_story_2").click(function(){
				showEditStory2();
		  	});	
		  	$("#close_edit_story_2").click(function(){
				cancelEditStory2();
		  	});			
    		$("#cancel_edit_story_2").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_edit_story_2").click();
    		});
			$("#cancel_edit_story_2").on('click', function() {
				cancelEditStory2();
			});

			
			// onblur="onDivBlur();" 
			// onmousedown="return cancelEvent(event);" 
			// onclick="return cancelEvent(event);" 
			// contentEditable="true" 
			// onmouseup="saveSelection();" 
			// onkeyup="saveSelection();" 
			// onfocus="restoreSelection();"

		    $("#textarea_description_edit").on ('blur', function (e) {
				onDivBlur_description();
		    });
		    $("#textarea_description_edit").on ('mousedown', function (e) {
				return cancelEvent_description(e);
		    });
		    $("#textarea_description_edit").on ('click', function (e) {
				return cancelEvent_description(e);
		    });
		    $("#textarea_description_edit").on ('mouseup', function (e) {
				saveSelection_description();
		    });
		    $("#textarea_description_edit").on ('keyup', function (e) {
				saveSelection_description();
		    });
		    $("#textarea_description_edit").on ('focus', function (e) {
				restoreSelection_description();
		    });
		    $("#textarea_description_edit").on ('keydown', function (e) {
		    	if( e.keyCode == 9) {
		    		e.preventDefault();
					insertTextAtCursor_description("\t");
		    	}
		    });
		
		
		
    		$("#submit_story_2").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_story_2").click();
    		});
			$("#submit_story_2").on('click', function() {
				// var c = $("#textarea_description_edit").html().replace(/\t/g, '        ');
				var c = $("#textarea_description_edit").html(); 
				$("form#new_publisher_product_description #publisher_product_description_description_text").val(c);	
				$("#submit_story_2_text").addClass("hidden");						
				$("#submit_story_2_loader").removeClass("hidden");
				$("#submit_story_2_hidden").click();
			});

    		$("#cancel_story_2").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_story_2").click();
    		});
			$("#cancel_story_2").on('click', function() {
				cancelEditStory2();
			});
			
			// story 2 description
			// *****


		});
		
				
	</script>

	<script>
		
	  	function showEditStory1() {
			$("#open_edit_story_1, .show-story-1").fadeOut(200, function(){    			
				$("#open_edit_story_1").addClass("hidden");
				$("#close_edit_story_1").fadeIn(200).removeClass("hidden");
				
    			$(".show-story-1").addClass("hidden");
    			$(".edit-story-1").fadeIn(300).removeClass("hidden");
    			
				// $("#btns_edit_story_1").fadeIn(200).removeClass("hidden");
				$("#btns_edit_story_1").fadeIn(200).removeClass("visibility-hidden");
    			
				$(".edit-image").fadeIn(200).removeClass("hidden");
				$(".container-figure-image-1 figure").removeClass("cursor-pointer");
				$(".drop-1-container").removeClass("hidden");
				$(".container-figure-image-2 figure").removeClass("cursor-pointer");
				$(".drop-2-container").removeClass("hidden");
				$(".container-figure-image-3 figure").removeClass("cursor-pointer");
				$(".drop-3-container").removeClass("hidden");
    			
				$(".container-figure-image-1").removeClass("container-figure-image-border").addClass("container-figure-image-border-edit");
				$(".container-figure-image-2").removeClass("container-figure-image-border").addClass("container-figure-image-border-edit");
				$(".container-figure-image-3").removeClass("container-figure-image-border").addClass("container-figure-image-border-edit");
				    			
				showEditTextareaStory1();				    			
				    			
				// $(".edit-image").fadeIn(200).removeClass("hidden");
				// $(".container-figure figure").removeClass("cursor-pointer");
				// $(".container-figure-logo figure").removeClass("cursor-pointer");
				// // $("#drop_container_user_image_primary").addClass("drop");
				// // $("#drop_container_logo_image").addClass("drop");
				// // $(".container-menu .dropdownContain").removeClass("hidden");
				
				// $(".drop-1-container").removeClass("hidden");
				// $(".drop-2-container").removeClass("hidden");
				
				// showEditImage1();
								
    			$("#publisher_name_company").focus();
				
    		});
	  	}
	  
	  	function cancelEditStory1() {
	  		$(".edit-story-1").fadeOut(200, function(){
    			$(".edit-story-1").addClass("hidden");
    			$(".show-story-1").removeClass("hidden").fadeIn(300);

				$("#open_edit_story_1").removeClass("hidden").fadeIn(200);
				$("#close_edit_story_1").addClass("hidden");

				// $("#btns_edit_story_1").removeAttr("style");
				// $("#btns_edit_story_1").addClass("hidden");
				$("#btns_edit_story_1").addClass("visibility-hidden");

				$(".edit-image").removeAttr("style");				
				$(".edit-image").fadeIn(200).addClass("hidden");
				$(".dialog-11-figure").addClass("cursor-pointer");
				$(".dialog-21-figure").addClass("cursor-pointer");
				$(".dialog-31-figure").addClass("cursor-pointer");
				
				$(".drop-1-container").addClass("hidden");				
				$(".drop-2-container").addClass("hidden");				
				$(".drop-3-container").addClass("hidden");				

				$(".container-figure-image-1").removeClass("container-figure-image-border-edit").addClass("container-figure-image-border");
				$(".container-figure-image-2").removeClass("container-figure-image-border-edit").addClass("container-figure-image-border");
				$(".container-figure-image-3").removeClass("container-figure-image-border-edit").addClass("container-figure-image-border");

				cancelEditTextareaStory1();
				
				// cancelEditImage1();
				
				// $(".edit-image").removeAttr("style");				
				// $(".edit-image").fadeIn(200).addClass("hidden");
				// $(".dialog-11-figure").addClass("cursor-pointer");
				// $(".dialog-21-figure").addClass("cursor-pointer");
				
				// $(".drop-1-container").addClass("hidden");				
				// $(".drop-2-container").addClass("hidden");				

				// $(".container-menu .dropdownContain").addClass("hidden");
				// $("#drop_container_user_image_primary").removeClass("drop");
				// $("#drop_container_logo_image").removeClass("drop");
			});
	  	}


		function partialInitRenderTextareaStory1() {
			var v = $("#textarea_description").html();
			// var w = $("#render_description_image").html();
			var w = "";
			if ( ((v == "<br>") || (v == "")) && ((w == "<br>") || (w == "")) ) {
				$("#textarea_description").addClass("textarea-description-empty");
			}
			else {
				$("#textarea_description").removeClass("textarea-description-empty");
			}			
		}

		function partialInitRenderTextareaStory2Edit() {
			var v = $("#textarea_description_edit").html();
			// var w = $("#render_description_image_edit").html();
			var w = "";
			if ( ((v == "<br>") || (v == "")) && ((w == "<br>") || (w == "")) ) {
				$("#textarea_description_edit").addClass("textarea-description-empty");
			}
			else {
				$("#textarea_description_edit").removeClass("textarea-description-empty");
			}			
		}

		// function init_render_story_2_edit() {
			// partial_init_render_story_2_edit();
		// }
		
		function initRenderTextareaStory1() {
			$("#textarea_description").html(story_1_description_html);
			partialInitRenderTextareaStory1();
		}


	  	function showEditTextareaStory1_1() {
	  		var textarea_html = $("#textarea_description").html();
    			$("#textarea_description_edit").html(textarea_html);
	  			$("#textarea_description_edit").focus();								
		}

	  	function showEditTextareaStory1() {
			// $("#open_edit_story_2, .show-story-2").fadeOut(200, function(){    			
				// $("#open_edit_story_2").addClass("hidden");
				// $("#close_edit_story_2").fadeIn(200).removeClass("hidden");
    			// $(".show-story-2").addClass("hidden");
    			// $(".edit-story-2").fadeIn(300).removeClass("hidden");    	
    			// $("#textarea_description_edit").html(textarea_html);
				// $(".btn-textarea-description-story-2-container").removeClass("hidden");
				// // init_render_story_2_edit();
	  			// $("#textarea_description_edit").focus();
	  			showEditTextareaStory1_1();								
    		// });
	  	}
	  	function cancelEditTextareaStory1() {
	  		// $("#render_description_image").html(""); Must call db delete on image
	  		// $("#textarea_description").html("");
			initRenderTextareaStory1();
			// hideEditTextareaStory1();	
	  	}
		function closeEditStory2() {
			$("#submit_story_2_loader").addClass("hidden");
			$("#submit_story_2_text").removeClass("hidden");
			cancelEditStory2();		
		}
		function hideEditStory1() {
	  		$(".edit-story-2").fadeOut(200, function(){
    			$(".edit-story-2").addClass("hidden");
    			$(".show-story-2").removeClass("hidden").fadeIn(300);
				$("#open_edit_story_2").removeClass("hidden").fadeIn(200);
				$("#close_edit_story_2").addClass("hidden");
			});			
		}



		// function set_listing_name_product(name_product, b_name_product) {
			// if( b_name_product ) {
				// $("#listing_name_product").removeClass("color-no-record").addClass("color-record");
			// }
			// else {
				// $("#listing_name_product").removeClass("color-record").addClass("color-no-record");
			// }
			// $("#listing_name_product").html(name_product);
		// }
		// function set_listing_product_tagline(product_tagline, b_product_tagline) {
			// if( b_product_tagline ) {
				// $("#listing_product_tagline").removeClass("color-no-record").addClass("color-record");
			// }
			// else {
				// $("#listing_product_tagline").removeClass("color-record").addClass("color-no-record");
			// }
			// $("#listing_product_tagline").html(product_tagline);
		// }
		// function set_listing_versions(versions, b_versions) {
			// if( b_versions ) {
				// $("#listing_versions").removeClass("color-no-record").addClass("color-record");
			// }
			// else {
				// $("#listing_versions").removeClass("color-record").addClass("color-no-record");
			// }
			// $("#listing_versions").html(versions);
		// }
		



		var story_1_description_html = null;

		// $(window).load( function() {
		$(document).ready(function () {				

			document.body.setAttribute('spellcheck', false);
			
			story_1_description_html = "<%= @publisher_product_description_description_text.html_safe %>";
			initRenderTextareaStory1();
			
		  	$("#open_edit_story_1").click(function(){
				showEditStory1();
		  	});	
		  	$("#close_edit_story_1").click(function(){
				cancelEditStory1();
		  	});	
		
    		$("#cancel_edit_story_1").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_edit_story_1").click();
    		});
			$("#cancel_edit_story_1").on('click', function() {
				cancelEditStory1();
			});

    		$("#submit_edit_story_1").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_edit_story_1").click();
    		});

			var obj_list = '{"publisher_product_gen_id":' + <%= @publisher_product_gen_id %> + 
						   '}';      

			// set_control_span("name_company", gon.name_company, gon.b_name_company);
			// set_control_span("address1", gon.address1, gon.b_address1);
			// set_control_span("address2", gon.address2, gon.b_address2);
			$("#submit_edit_story_1").on('click', function() {
				var input_publisher_product_manifest_name_product = $("#publisher_product_manifest_name_product").val();
				var input_publisher_product_manifest_product_tagline = $("#publisher_product_manifest_product_tagline").val();
				var input_publisher_product_manifest_versions = $("#publisher_product_manifest_versions").val();
				var input_publisher_product_description = $("#textarea_description_edit").html().replace(/\t/g, '\\t');
				// var input_publisher_product_description = "line 12345";
				// alert(input_publisher_product_description);
				var obj_list = '{  "publisher_product_id":' + <%= @publisher_product_id %> +  
							   ',  "name_product":"' + input_publisher_product_manifest_name_product +
							   '", "product_tagline":"' + input_publisher_product_manifest_product_tagline +
							   '", "versions":"' + input_publisher_product_manifest_versions +
							   '", "description":"' + input_publisher_product_description +
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';       
			  	$.ajax({
			    	type: 'POST',
			    	// data : JSON.stringify(obj),
			    	data : obj,
			    	url: '/publisher_product_manifests/update_story_1',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	                	// 200:function() { alert("200"); },
	                	// 202:function() { alert("202"); }
	            	},
	            	success: function(data) {
						// alert(data.name_first);
						set_control_span("name_product", data.name_product, data.b_name_product);
						set_control_span("product_tagline", data.product_tagline, data.b_product_tagline);
						set_control_span("versions", data.versions, data.b_versions);
						story_1_description_html = data.description;
						initRenderTextareaStory1();
						renderListingPreview("story_1");
						cancelEditStory1();
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});


		});
		
		
	</script>

	<script>

		// *****
		// section image_1
		
		var id_image_1 = null;
		
		function closeAddImage1() {
			$("#dvLoading_12").addClass("dvLoading-display-none");
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form12").trigger('click');
			$("form#new_image_1 input#new_image_1_image").val('');
		};	  

		function closeChangeImage1() {
			$("#dvLoading_13").addClass("dvLoading-display-none");
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form13").trigger('click');
			$("form#change_image_1 input#change_image_1_image").val('');
		};	  

		function closeDeleteImage1() {			
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form14").trigger('click');
		};	  

		function closeCropImage1() {
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form15").trigger('click');
		};	  

		function deleteImage1(id_image) {
			var formData = {id:id_image};
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publisher_product_manifests/destroy_image_1',			    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		function cropImage1() {
			// var input_image_id = $("#image_id_logo").val();
			var input_image_id = $("#cropbox_image_1").val();
			var input_crop_x = $("#id_crop_x_image_1").val();
			var input_crop_y = $("#id_crop_y_image_1").val();
			var input_crop_w = $("#id_crop_w_image_1").val();
			var input_crop_h = $("#id_crop_h_image_1").val();
			var formData = { image_id: input_image_id,
							 publisher_product_id: <%= @publisher_product_id %>, 
							 crop_x: input_crop_x, 
							 crop_y: input_crop_y,
							 crop_w: input_crop_w, 
							 crop_h: input_crop_h 
						   };
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publisher_product_manifests/crop_image_1',	
		    	// cache: false,		    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful crop");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
	  		// return false;
		}

		// $(window).load( function() {
		$(document).ready(function () {				

			// *****
			// section image_1
			
			id_image_1 = gon.id_image_1;

			$(document).on("click", "#btn_image_1_new", function() {				
				$("form#new_image_1 input#new_image_1_image").val('');
				$("#dialog_12").jqmShow();
				$("#btn_dlg_12_submit").focus();
			});		
			$(document).on("click", "#figcaption_image_1_generic", function() {
				$("form#new_image_1 input#new_image_1_image").val('');
				$("#dialog_12").jqmShow();
			});		
			$(document).on("click", "#btn_dlg_12_submit", function() {
				$("form#new_image_1 input#new_image_1_image").click();
			});	
			$(document).on("click", "#btn_dlg_12_cancel", function() {
				$("#close_form12").trigger('click');
			});
			$(document).on("change", "form#new_image_1 input#new_image_1_image", function() {
				$("#dvLoading_12").removeClass("dvLoading-display-none");
				// $("form#new_image_1 input#btn_submit_dialog_12").click();
				$("form#new_image_1 input#btn_submit_image_1_new").click();
			});

			$(document).on("click", "#btn_image_1_change", function() {				
				$("form#change_image_1 input#change_image_1_image").val('');
				$("#dialog_13").jqmShow();
				$("#btn_dlg_13_submit").focus();
			});		
			$(document).on("click", "#btn_dlg_13_submit", function() {
				$("form#change_image_1 input#change_image_1_image").click();
			});	
			$(document).on("change", "form#change_image_1 input#change_image_1_image", function() {
				$("#dvLoading_13").removeClass("dvLoading-display-none");
				$("form#change_image_1 input#btn_submit_image_1_change").click();
			});
			$(document).on("click", "#btn_dlg_13_cancel", function() {
				$("#close_form13").trigger('click');
			});

			$(document).on("click", "#btn_dlg_14_submit", function() {
				deleteImage1(id_image_1);
			});
			$(document).on("click", "#btn_dlg_14_cancel", function() {
				$("#close_form14").trigger('click');
			});
			$(document).on("click", "#btn_image_1_delete", function() {
				$("#dialog_14").jqmShow();
				$("#btn_dlg_14_cancel").focus();
			});			

			$(document).on("click", "#btn_image_1_crop", function() {
				$("#dialog_15").jqmShow();
			});
			$(document).on("click", "#btn_dlg_submit_crop_image_1", function() {
				cropImage1();
			});
			$(document).on("click", "#btn_dlg_cancel_crop_image_1", function() {
				$("#close_form15").trigger('click');
			});
			
			// section image_1
			// *****

		});
		

	</script>

	<script>

		// *****
		// section image_2
		
		var id_image_2 = null;
		
		function closeAddImage2() {
			$("#dvLoading_22").addClass("dvLoading-display-none");
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form22").trigger('click');
			$("form#new_image_2 input#new_image_2_image").val('');
		};	  

		function closeChangeImage2() {
			$("#dvLoading_23").addClass("dvLoading-display-none");
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form23").trigger('click');
			$("form#change_image_2 input#change_image_2_image").val('');
		};	  

		function closeDeleteImage2() {			
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form24").trigger('click');
		};	  

		function closeCropImage2() {
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form25").trigger('click');
		};	  

		function deleteImage2(id_image) {
			var formData = {id:id_image};
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publisher_product_manifests/destroy_image_2',			    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		function cropImage2() {
			var input_image_id = $("#image_id_logo").val();
			var input_crop_x = $("#id_crop_x_logo").val();
			var input_crop_y = $("#id_crop_y_logo").val();
			var input_crop_w = $("#id_crop_w_logo").val();
			var input_crop_h = $("#id_crop_h_logo").val();
			var formData = { image_id: input_image_id, 
							 crop_x: input_crop_x, 
							 crop_y: input_crop_y,
							 crop_w: input_crop_w, 
							 crop_h: input_crop_h 
						   };
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publisher_product_manifests/crop_image_2',	
		    	// cache: false,		    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful crop");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
	  		// return false;
		}

		// $(window).load( function() {
		$(document).ready(function () {				

			// *****
			// section image_2
			
			id_image_2 = gon.id_image_2;

			$(document).on("click", "#btn_image_2_new", function() {				
				$("form#new_image_2 input#new_image_2_image").val('');
				$("#dialog_22").jqmShow();
			});		
			$(document).on("click", "#figcaption_image_2_generic", function() {
				$("form#new_image_2 input#new_image_2_image").val('');
				$("#dialog_22").jqmShow();
			});		
			$(document).on("click", "#btn_dlg_22_submit", function() {
				$("form#new_image_2 input#new_image_2_image").click();
			});	
			$(document).on("click", "#btn_dlg_22_cancel", function() {
				$("#close_form22").trigger('click');
			});
			$(document).on("change", "form#new_image_2 input#new_image_2_image", function() {
				$("#dvLoading_22").removeClass("dvLoading-display-none");
				$("form#new_image_2 input#btn_submit_image_2_new").click();
			});
			
			$(document).on("click", "#btn_image_2_change", function() {				
				$("form#change_image_2 input#change_image_2_image").val('');
				$("#dialog_23").jqmShow();
				$("#btn_dlg_23_submit").focus();
			});		
			$(document).on("click", "#btn_dlg_23_submit", function() {
				$("form#change_image_2 input#change_image_2_image").click();
			});	
			$(document).on("change", "form#change_image_2 input#change_image_2_image", function() {
				$("#dvLoading_23").removeClass("dvLoading-display-none");
				$("form#change_image_2 input#btn_submit_image_2_change").click();
			});
			$(document).on("click", "#btn_dlg_23_cancel", function() {
				$("#close_form23").trigger('click');
			});

			$(document).on("click", "#btn_dlg_24_submit", function() {
				deleteImage2(id_image_2);
			});
			$(document).on("click", "#btn_dlg_24_cancel", function() {
				$("#close_form24").trigger('click');
			});
			$(document).on("click", "#btn_image_2_delete", function() {
				$("#dialog_24").jqmShow();
				$("#btn_dlg_24_cancel").focus();
			});			

			$(document).on("click", "#btn_image_2_crop", function() {
				$("#dialog_25").jqmShow();
			});
			$(document).on("click", "#btn_dlg_submit_crop_image_2", function() {
				cropImage2();
			});
			$(document).on("click", "#btn_dlg_cancel_crop_image_2", function() {
				$("#close_form25").trigger('click');
			});
			
			// section image_2
			// *****

		});
		

	</script>

	<script>

		// *****
		// section image_3
		
		var id_image_3 = null;
		
		function closeAddImage3() {
			$("#dvLoading_32").addClass("dvLoading-display-none");
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form32").trigger('click');
			$("form#new_image_3 input#new_image_3_image").val('');
		};	  

		function closeChangeImage3() {
			$("#dvLoading_33").addClass("dvLoading-display-none");
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form33").trigger('click');
			$("form#change_image_3 input#change_image_3_image").val('');
		};	  

		function closeDeleteImage3() {			
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form34").trigger('click');
		};	  

		function closeCropImage3() {
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form35").trigger('click');
		};	  

		function deleteImage3(id_image) {
			var formData = {id:id_image};
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publisher_product_manifests/destroy_image_3',			    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		function cropImage3() {
			var input_image_id = $("#image_id_logo").val();
			var input_crop_x = $("#id_crop_x_logo").val();
			var input_crop_y = $("#id_crop_y_logo").val();
			var input_crop_w = $("#id_crop_w_logo").val();
			var input_crop_h = $("#id_crop_h_logo").val();
			var formData = { image_id: input_image_id, 
							 crop_x: input_crop_x, 
							 crop_y: input_crop_y,
							 crop_w: input_crop_w, 
							 crop_h: input_crop_h 
						   };
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publisher_product_manifests/crop_image_3',	
		    	// cache: false,		    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful crop");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
	  		// return false;
		}

		// $(window).load( function() {
		$(document).ready(function () {				

			// *****
			// section image_3
			
			id_image_3 = gon.id_image_3;

			$(document).on("click", "#btn_image_3_new", function() {				
				$("form#new_image_3 input#new_image_3_image").val('');
				$("#dialog_32").jqmShow();
			});		
			$(document).on("click", "#figcaption_image_3_generic", function() {
				$("form#new_image_3 input#new_image_3_image").val('');
				$("#dialog_32").jqmShow();
			});		
			$(document).on("click", "#btn_dlg_32_submit", function() {
				$("form#new_image_3 input#new_image_3_image").click();
			});	
			$(document).on("click", "#btn_dlg_32_cancel", function() {
				$("#close_form32").trigger('click');
			});
			$(document).on("change", "form#new_image_3 input#new_image_3_image", function() {
				$("#dvLoading_32").removeClass("dvLoading-display-none");
				$("form#new_image_3 input#btn_submit_image_3_new").click();
			});

			$(document).on("click", "#btn_image_3_change", function() {				
				$("form#change_image_3 input#change_image_3_image").val('');
				$("#dialog_33").jqmShow();
				$("#btn_dlg_33_submit").focus();
			});		
			$(document).on("click", "#btn_dlg_33_submit", function() {
				$("form#change_image_3 input#change_image_3_image").click();
			});	
			$(document).on("change", "form#change_image_3 input#change_image_3_image", function() {
				$("#dvLoading_33").removeClass("dvLoading-display-none");
				$("form#change_image_3 input#btn_submit_image_3_change").click();
			});
			$(document).on("click", "#btn_dlg_33_cancel", function() {
				$("#close_form33").trigger('click');
			});

			$(document).on("click", "#btn_dlg_34_submit", function() {
				deleteImage3(id_image_3);
			});
			$(document).on("click", "#btn_dlg_34_cancel", function() {
				$("#close_form34").trigger('click');
			});
			$(document).on("click", "#btn_image_3_delete", function() {
				$("#dialog_34").jqmShow();
				$("#btn_dlg_34_cancel").focus();
			});			

			$(document).on("click", "#btn_image_3_crop", function() {
				$("#dialog_35").jqmShow();
			});
			$(document).on("click", "#btn_dlg_submit_crop_image_3", function() {
				cropImage3();
			});
			$(document).on("click", "#btn_dlg_cancel_crop_image_3", function() {
				$("#close_form35").trigger('click');
			});
			
			// section image_3
			// *****

		});
		

	</script>

	<script>
		
	  	function showEditStory4() {
			$("#open_edit_story_4, .show-story-4").fadeOut(200, function(){    			
				$("#open_edit_story_4").addClass("hidden");
				$("#close_edit_story_4").fadeIn(200).removeClass("hidden");
				
    			$(".show-story-4").addClass("hidden");
    			$(".edit-story-4").fadeIn(300).removeClass("hidden");
    			
				$("#btns_edit_story_4").fadeIn(200).removeClass("visibility-hidden");
    			
				$(".edit-image").fadeIn(200).removeClass("hidden");
				$(".container-figure-image-4 figure").removeClass("cursor-pointer");
				$(".drop-4-container").removeClass("hidden");
    			
				$(".container-figure-image-4").removeClass("container-figure-image-border").addClass("container-figure-image-border-edit");
				    			
				// showEditTextareaStory4();				    			
				    			
    			$("#publisher_corporate_logo_url").focus();
    		});
	  	}
	  
	  	function cancelEditStory4() {
	  		$(".edit-story-4").fadeOut(200, function(){
    			$(".edit-story-4").addClass("hidden");
    			$(".show-story-4").removeClass("hidden").fadeIn(300);

				$("#open_edit_story_4").removeClass("hidden").fadeIn(200);
				$("#close_edit_story_4").addClass("hidden");

				$("#btns_edit_story_4").addClass("visibility-hidden");

				$(".edit-image").removeAttr("style");				
				$(".edit-image").fadeIn(200).addClass("hidden");
				$(".dialog-41-figure").addClass("cursor-pointer");
				
				$(".drop-4-container").addClass("hidden");				

				$(".container-figure-image-4").removeClass("container-figure-image-border-edit").addClass("container-figure-image-border");

				// cancelEditTextareaStory4();
			});
	  	}


		// $(window).load( function() {
		$(document).ready(function () {				

			
		  	$("#open_edit_story_4").click(function(){
				showEditStory4();
		  	});	
		  	$("#close_edit_story_4").click(function(){
				cancelEditStory4();
		  	});	
		
    		$("#cancel_edit_story_4").keypress(function(e){
      			if(e.keyCode==13)
      			$("#cancel_edit_story_4").click();
    		});
			$("#cancel_edit_story_4").on('click', function() {
				cancelEditStory4();
			});

    		$("#submit_edit_story_4").keypress(function(e){
      			if(e.keyCode==13)
      			$("#submit_edit_story_4").click();
    		});

			set_control_span("corporate_logo_url", gon.corporate_logo_url, gon.b_corporate_logo_url);
			// set_control_required("corporate_logo_url", gon.b_required_corporate_logo_url);
			
			$("#submit_edit_story_4").on('click', function() {
				var input_publisher_product_manifest_corporate_logo_url = $("#publisher_product_manifest_corporate_logo_url").val();
				var obj_list = '{  "publisher_product_id":' + <%= @publisher_product_id %> +  					
							   ',  "corporate_logo_url":"' + input_publisher_product_manifest_corporate_logo_url +
							   '"}';      
			  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';       
			  	$.ajax({
			    	type: 'POST',
			    	// data : JSON.stringify(obj),
			    	data : obj,
			    	url: '/publisher_product_manifests/update_story_4',			    	
			    	dataType: "json",
			    	contentType: "application/json",
			    	processData: false,
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	                	// 200:function() { alert("200"); },
	                	// 202:function() { alert("202"); }
	            	},
	            	success: function(data) {
						// alert(data.name_first);
						set_control_span("corporate_logo_url", data.corporate_logo_url, data.b_corporate_logo_url);
						cancelEditStory4();
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		return false;
			});


		});
		
		
	</script>

	<script>

		// *****
		// section image_4
		
		var id_image_4 = null;
		
		function closeAddImage4() {
			$("#dvLoading_42").addClass("dvLoading-display-none");
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form42").trigger('click');
			$("form#new_image_4 input#new_image_4_image").val('');
		};	  

		function closeChangeImage4() {
			$("#dvLoading_43").addClass("dvLoading-display-none");
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form43").trigger('click');
			$("form#change_image_4 input#change_image_4_image").val('');
		};	  

		function closeDeleteImage4() {			
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form44").trigger('click');
		};	  

		function closeCropImage4() {
			$(".edit-image").fadeIn(200).removeClass("hidden");
			$("#close_form45").trigger('click');
		};	  

		function deleteImage4(id_image) {
			var formData = {id:id_image};
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publisher_product_manifests/destroy_image_4',			    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
		}

		function cropImage4() {
			var input_image_id = $("#image_id_logo").val();
			var input_crop_x = $("#id_crop_x_logo").val();
			var input_crop_y = $("#id_crop_y_logo").val();
			var input_crop_w = $("#id_crop_w_logo").val();
			var input_crop_h = $("#id_crop_h_logo").val();
			var formData = { image_id: input_image_id, 
							 crop_x: input_crop_x, 
							 crop_y: input_crop_y,
							 crop_w: input_crop_w, 
							 crop_h: input_crop_h 
						   };
		  	$.ajax({
		    	type: 'POST',
		    	data : formData,
		    	url: '/publisher_product_manifests/crop_image_4',	
		    	// cache: false,		    	
		    	dataType: "script",
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	statusCode: {
                	// 200:function() { alert("200"); },
                	// 202:function() { alert("202"); }
            	},
            	success: function(data) {
					// alert("successful crop");
            	},
            	error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	});
	  		// return false;
		}

		// $(window).load( function() {
		$(document).ready(function () {				

			// *****
			// section image_4
			
			id_image_4 = gon.id_image_4;

			$(document).on("click", "#btn_image_4_new", function() {				
				$("form#new_image_4 input#new_image_4_image").val('');
				$("#dialog_42").jqmShow();
			});		
			$(document).on("click", "#figcaption_image_4_generic", function() {
				$("form#new_image_4 input#new_image_4_image").val('');
				$("#dialog_42").jqmShow();
			});		
			$(document).on("click", "#btn_dlg_42_submit", function() {
				$("form#new_image_4 input#new_image_4_image").click();
			});	
			$(document).on("click", "#btn_dlg_42_cancel", function() {
				$("#close_form42").trigger('click');
			});
			$(document).on("change", "form#new_image_4 input#new_image_4_image", function() {
				$("#dvLoading_42").removeClass("dvLoading-display-none");
				// $("form#new_image_4 input#btn_submit_dialog_42").click();
				$("form#new_image_4 input#btn_submit_image_4_new").click();
			});
			
			$(document).on("click", "#btn_image_4_change", function() {				
				$("form#change_image_4 input#change_image_4_image").val('');
				$("#dialog_43").jqmShow();
				$("#btn_dlg_43_submit").focus();
			});		
			$(document).on("click", "#btn_dlg_43_submit", function() {
				$("form#change_image_4 input#change_image_4_image").click();
			});	
			$(document).on("change", "form#change_image_4 input#change_image_4_image", function() {
				$("#dvLoading_43").removeClass("dvLoading-display-none");
				$("form#change_image_4 input#btn_submit_image_4_change").click();
			});
			$(document).on("click", "#btn_dlg_43_cancel", function() {
				$("#close_form43").trigger('click');
			});

			$(document).on("click", "#btn_dlg_44_submit", function() {
				deleteImage4(id_image_4);
			});
			$(document).on("click", "#btn_dlg_44_cancel", function() {
				$("#close_form44").trigger('click');
			});
			$(document).on("click", "#btn_image_4_delete", function() {
				$("#dialog_44").jqmShow();
				$("#btn_dlg_44_cancel").focus();
			});			

			$(document).on("click", "#btn_image_4_crop", function() {
				$("#dialog_45").jqmShow();
			});
			$(document).on("click", "#btn_dlg_submit_crop_image_4", function() {
				cropImage4();
			});
			$(document).on("click", "#btn_dlg_cancel_crop_image_4", function() {
				$("#close_form45").trigger('click');
			});
			
			// section image_4
			// *****

		});
		

	</script>

	<script>

	 	// *****
	 	// section validate / validation
		
		function validatePDFFiles(inputFile) {
		  var maxExceededMessage = "This file exceeds the maximum allowed file size (5 MB)";
		  var extErrorMessage = "Only PDF file with extension: .pdf is allowed";
		  var allowedExtension = ["pdf"];
		  
		  var extName;
		  var maxFileSize = $(inputFile).data('max-file-size');
		  var sizeExceeded = false;
		  var extError = false;
		  
		  $.each(inputFile.files, function() {
		    if (this.size && maxFileSize && this.size > parseInt(maxFileSize)) {sizeExceeded=true;};
		    extName = this.name.split('.').pop();
		    if ($.inArray(extName, allowedExtension) == -1) {extError=true;};
		  });
		  if (sizeExceeded) {
		    window.alert(maxExceededMessage);
		    $(inputFile).val('');
		  };
		  
		  if (extError) {
		    window.alert(extErrorMessage);
		    $(inputFile).val('');
		  };
		}
		
		function validateImageFiles(inputFile) {
		  var maxExceededMessage = "This file exceeds the maximum allowed file size (5 MB)";
		  var extErrorMessage = "Only image file with extension: .jpg, .jpeg, .gif or .png is allowed";
		  var allowedExtension = ["jpg", "jpeg", "gif", "png"];
		  
		  var extName;
		  var maxFileSize = $(inputFile).data('max-file-size');
		  var sizeExceeded = false;
		  var extError = false;
		  
		  $.each(inputFile.files, function() {
		    if (this.size && maxFileSize && this.size > parseInt(maxFileSize)) {sizeExceeded=true;};
		    extName = this.name.split('.').pop();
		    if ($.inArray(extName, allowedExtension) == -1) {extError=true;};
		  });
		  if (sizeExceeded) {
		    window.alert(maxExceededMessage);
		    $(inputFile).val('');
		  };
		  
		  if (extError) {
		    window.alert(extErrorMessage);
		    $(inputFile).val('');
		  };
		}
		
		

	</script>

	<script>

	 	// *****
	 	// section pdf

		function set_publisher_product_pdf_id(pdf_id) {
			alert('set_publisher_product_pdf_id(pdf_id)');
    		document.getElementById("id_publisher_product_pdf").value = pdf_id
			$("#form8").slideDown(400, function(){ $("#form8a").fadeIn( 2000 ) });
		}

		// function set_publisher_product_pdfs_obj(pdfs) {
    		// document.getElementById("publisher_product_pdfs_hidden").value = pdfs
		// }

		function closeAddPdf() {
			$("#close_form52").trigger('click');
		};	  

		function closeAddPdfImage() {
			$("#dvLoading_51").addClass("dvLoading-display-none");
			$("#close_form51").trigger('click');
		};	  

		function closeDeletePdfImage() {
			$("#dvLoading_53").addClass("dvLoading-display-none");
			$("#close_form55").trigger('click');
		};	  

		function closeDeletePdf() {
			$("#close_form54").trigger('click');
		};	  

		function closeEditPDFs() {
			alert('closeEditPDFs()');
			$("#form4a").fadeOut(700, function(){ 
				$("#form4").slideUp(400); 
			});
		}

		function closeEditPDFimages() {
			alert('closeEditPDFimages()');
			$("#form8a").fadeOut(700, function(){ 
				$("#form8").slideUp(400);
			});
		}

		// var id_image_4 = null;
// 		
		// function closeAddImage4() {
			// $("#dvLoading_42").addClass("dvLoading-display-none");
			// $(".edit-image").fadeIn(200).removeClass("hidden");
			// $("#close_form42").trigger('click');
			// $("form#new_image_4 input#new_image_4_image").val('');
		// };	  
// 
		// function closeChangeImage4() {
			// $("#dvLoading_43").addClass("dvLoading-display-none");
			// $(".edit-image").fadeIn(200).removeClass("hidden");
			// $("#close_form43").trigger('click');
			// $("form#change_image_4 input#change_image_4_image").val('');
		// };	  
// 
		// function closeDeleteImage4() {			
			// $(".edit-image").fadeIn(200).removeClass("hidden");
			// $("#close_form44").trigger('click');
		// };	  
// 
		// function closeCropImage4() {
			// $(".edit-image").fadeIn(200).removeClass("hidden");
			// $("#close_form45").trigger('click');
		// };	  
// 
			function deletePDF(publisher_product_pdf_id) {
				var formData = { publisher_product_id: <%= @publisher_product_id %>, 
								 publisher_product_pdf_id: publisher_product_pdf_id 
							   };
			  	$.ajax({
			    	type: 'POST',
			    	data : formData,
			    	url: '/publisher_product_manifests/destroy_pdf',	
			    	// cache: false,		    	
			    	dataType: "script",
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		// return false;
			}

			function deletePDFImage(publisher_product_pdf_id) {
				var formData = { publisher_product_id: <%= @publisher_product_id %>, 
								 publisher_product_pdf_id: publisher_product_pdf_id 
							   };
			  	$.ajax({
			    	type: 'POST',
			    	data : formData,
			    	url: '/publisher_product_manifests/destroy_pdf_image',	
			    	// cache: false,		    	
			    	dataType: "script",
			    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	            	statusCode: {
	            	},
	            	success: function(data) {
	            	},
	            	error: function(xhr){  alert("error: " + xhr.statusText); }        
			  	});
		  		// return false;
			}

		// function cropImage4() {
			// var input_image_id = $("#image_id_logo").val();
			// var input_crop_x = $("#id_crop_x_logo").val();
			// var input_crop_y = $("#id_crop_y_logo").val();
			// var input_crop_w = $("#id_crop_w_logo").val();
			// var input_crop_h = $("#id_crop_h_logo").val();
			// var formData = { image_id: input_image_id, 
							 // crop_x: input_crop_x, 
							 // crop_y: input_crop_y,
							 // crop_w: input_crop_w, 
							 // crop_h: input_crop_h 
						   // };
		  	// $.ajax({
		    	// type: 'POST',
		    	// data : formData,
		    	// url: '/publisher_product_manifests/crop_image_4',	
		    	// // cache: false,		    	
		    	// dataType: "script",
		    	// beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
            	// statusCode: {
                	// // 200:function() { alert("200"); },
                	// // 202:function() { alert("202"); }
            	// },
            	// success: function(data) {
					// // alert("successful crop");
            	// },
            	// error: function(xhr){  alert("error: " + xhr.statusText); }        
		  	// });
	  		// // return false;
		// }

		// $(window).load( function() {
		$(document).ready(function () {				


			$(".figure-pdf-image-generic").on('click', function() {
				$(".dialog-51").trigger('click');
			});			
			$(".dialog-51").on('click', function() {
				var s_id = $(this).attr("name");
				// alert("s_id = " + s_id.toString());
				// $("#publisher_product_pdf_image_publisher_product_pdf_id").val(s_id);
				$("#publisher_product_pdf_id").val(s_id);
				$("#dialog_51").jqmShow();
			});
			$('#dialog_51').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_51').animate(
						{bottom:'-=220', top:'+=220'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_51').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
							// $('#dl_email').focus();
						}
					);
				}
			}); 		

			// $('#dialog_51').jqm({
				// onShow: function(hash) {
					// hash.o.prependTo('body');
					// hash.w.css('top', '-740px');
					// hash.w.css('opacity', 1.0).fadeIn(200);
					// // hash.w.show();
					// $('#dialog_51').animate(
						// {bottom:'-=800', top:'+=800'}, 
						// 500, 
						// 'easeInOutCirc', 
						// function() {
							// $('#dialog_51').animate(
								// {bottom:'+=4', top:'-=4'}, 
								// 100, 
								// 'easeInBounce', 
								// function() {
								// }
							// );
							// // $('#dl_email').focus();
						// }
					// );
				// }
			// }); 		

			$("#title_pdfs").on('click', function() {
				$("#dialog_52").jqmShow();
			});
			// $(".dialog-52").on('click', function() {
				// $("#dialog_52").jqmShow();
			// });
			$('#dialog_52').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_52').animate(
						{bottom:'-=220', top:'+=220'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_52').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
							// $('#dl_email').focus();
						}
					);
				}
			}); 		

			$('#dialog_53').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_53').animate(
						{bottom:'-=220', top:'+=220'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_53').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
							// $('#dl_email').focus();
						}
					);
				}
			}); 		

			$('#dialog_54').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_54').animate(
						{bottom:'-=220', top:'+=220'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_54').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
							// $('#dl_email').focus();
						}
					);
				}
			}); 		

			$('#dialog_55').jqm({
				onShow: function(hash) {
					hash.o.prependTo('body');
					hash.w.css('top', '-200px');
					hash.w.css('opacity', 1.0).fadeIn(200);
					// hash.w.show();
					$('#dialog_55').animate(
						{bottom:'-=220', top:'+=220'}, 
						500, 
						'easeInOutCirc', 
						function() {
							$('#dialog_55').animate(
								{bottom:'+=4', top:'-=4'}, 
								100, 
								'easeInBounce', 
								function() {
								}
							);
							// $('#dl_email').focus();
						}
					);
				}
			}); 		

			
			var id_pdf_51 = null;
			$(document).on("click", ".figcaption-image-5-generic", function() {
				// figcaption-hidden
				id_pdf_51 = $(this).attr("data-id");
				$("#dialog_51").jqmShow();
			});	
			$(document).on("click", ".btn-image-5-new", function() {
				id_pdf_51 = $(this).attr("name");
				$("#dialog_51").jqmShow();
			});	
			$(document).on("click", "#btn_dlg_51_submit", function() {
				$("#dvLoading_51").removeClass("dvLoading-display-none");
				$("form#new_publisher_product_pdf_image input#new_pdf_image_image").click();
			});	
			$(document).on("change", "form#new_publisher_product_pdf_image input#new_pdf_image_image", function() {
				// alert(id_pdf_51);
				$("form#new_publisher_product_pdf_image input#publisher_product_pdf_id").val(id_pdf_51);
				$("#dvLoading_51").removeClass("dvLoading-display-none");
				// validatePDFFiles(this);
				$("form#new_publisher_product_pdf_image input#btn_submit_51").click();
			});
			$(document).on("click", "#btn_dlg_51_cancel", function() {
				$("#close_form51").trigger('click');
			});
					
			$(document).on("click", "#btn_dlg_52_submit", function() {
				$("form#new_publisher_product_pdf input#name_file").click();
			});	
			$(document).on("click", "#btn_dlg_52_cancel", function() {
				$("#close_form52").trigger('click');
			});
			$(document).on("change", "form#new_publisher_product_pdf input#name_file", function() {
				$("#dvLoading_52").removeClass("dvLoading-display-none");
				// validatePDFFiles(this);
				$("form#new_publisher_product_pdf input#btn_submit_52").click();
			});

			var id_pdf_53 = null;
			$(document).on("click", ".btn-image-5-change", function() {
				id_pdf_53 = $(this).attr("name");
				$("#dialog_53").jqmShow();
				// alert("btn-image-5-change");
			});	
			$(document).on("click", "#btn_dlg_53_submit", function() {
				// alert("submit 53");
				$("#dvLoading_53").removeClass("dvLoading-display-none");
				$("form#change_publisher_product_pdf_image input#change_pdf_image_image").click();
			});	
			$(document).on("change", "form#change_publisher_product_pdf_image input#change_pdf_image_image", function() {
				$("form#change_publisher_product_pdf_image input#publisher_product_pdf_id").val(id_pdf_53);
				$("#dvLoading_53").removeClass("dvLoading-display-none");
				// validatePDFFiles(this);
				$("form#change_publisher_product_pdf_image input#btn_submit_53").click();
			});
			$(document).on("click", "#btn_dlg_53_cancel", function() {
				$("#close_form53").trigger('click');
			});

			var id_pdf_54 = null;
			$(document).on("click", ".btn-pdf-delete", function() {
				id_pdf_54 = $(this).attr("name");
				$("#dialog_54").jqmShow();
			});	
			$(document).on("click", "#btn_dlg_54_submit", function() {
				deletePDF(id_pdf_54);
			});	
			$(document).on("click", "#btn_dlg_54_cancel", function() {
				$("#close_form54").trigger('click');
			});
			
			// $(".close-info-name-pdf").click(function(){
			$(document).on("click", ".close-info-name-pdf", function() {				
				var n_name = $(this).attr("name");
		  		var s_id = "#form_info_name_pdf";
				var s_id_a = "#form_info_name_pdf_a";
		    	$(s_id_a).fadeOut(700, function(){ $(s_id).slideUp(400) });
		  	});
		  	// $(".open-info-name-pdf").click(function(){
		  	$(document).on("click", ".open-info-name-pdf", function() {
		  		var n_name = $(this).attr("name");
		  		var s_id = "#form_info_name_pdf";
		  		var s_id_a = "#form_info_name_pdf_a"; 
		    	$(s_id).slideDown(400, function(){ $(s_id_a).fadeIn( 2000 ) });
		  	});	    					

			var id_pdf_55 = null;
			$(document).on("click", ".btn-image-5-delete", function() {
				id_pdf_55 = $(this).attr("name");
				$("#dialog_55").jqmShow();
				// alert("btn-image-5-delete");
			});	
			$(document).on("click", "#btn_dlg_55_submit", function() {
				// alert("submit 55");
				deletePDFImage(id_pdf_55);
			});	
			$(document).on("click", "#btn_dlg_55_cancel", function() {
				$("#close_form55").trigger('click');
			});	
			
			
// 			
// 
			// $(document).on("click", "#btn_dlg_submit_upload_image_4_change", function() {
				// $("form#change_image_4 input#change_image_4_image").click();
			// });	
			// $(document).on("change", "form#change_image_4 input#change_image_4_image", function() {
				// $("#dvLoading_43").removeClass("dvLoading-display-none");
				// $("form#change_image_4 input#btn_submit_dialog_43").click();
			// });
			// $(document).on("click", "#btn_image_4_change", function() {				
				// $("form#change_image_4 input#change_image_4_image").val('');
				// $("#dialog_43").jqmShow();
				// $("#btn_dlg_submit_upload_image_4_change").focus();
			// });		
			// $(document).on("click", "#btn_dlg_cancel_upload_image_4_change", function() {
				// $("#close_form43").trigger('click');
			// });
// 
// 
			// $(document).on("click", "#btn_dlg_44_submit", function() {
				// deleteImage4(id_image_4);
			// });
			// $(document).on("click", "#btn_dlg_44_cancel", function() {
				// $("#close_form44").trigger('click');
			// });
			// $(document).on("click", "#btn_image_4_delete", function() {
				// $("#dialog_44").jqmShow();
				// $("#btn_dlg_44_cancel").focus();
			// });			
// 
// 
			// $(document).on("click", "#btn_image_4_crop", function() {
				// $("#dialog_45").jqmShow();
			// });
			// $(document).on("click", "#btn_dlg_submit_crop_image_4", function() {
				// cropImage4();
			// });
			// $(document).on("click", "#btn_dlg_cancel_crop_image_4", function() {
				// $("#close_form45").trigger('click');
			// });
// 			
			// // section image_4
			// // *****

		});
		

	</script>

	<script>

		function reset_current_publisher_product() {

			var obj_list = '{"publisher_product_gen_id":' + <%= @publisher_product_gen_id %> + 
						   '}';      
		  	var obj = '{ "publisher_product_manifest": [' +  obj_list + '] }';                  

			$.ajax({
		    	type: 'POST',
		    	// data : JSON.stringify(obj),
		    	data : obj,
				url: '/publisher_product_manifests/reset_current_publisher_product',			    	
		    	dataType: "json",
		    	contentType: "application/json",
		    	processData: false,
		    	async: false,
		    	beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
	        	statusCode: {
	            	// 200:function() { alert("200"); },
	            	// 202:function() { alert("202"); }
	        	},
	        	success: function(data) {
	        	},
	        	error: function(xhr){  alert("error: " + xhr.statusText); }        
				
				// type: 'POST',
				// data : obj,				
				// url: '/publisher_product_manifests/reset_current_publisher_product',			    	
				// dataType: "script",
				// async: false,
				// beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))}
			});
		}

		// $(window).on('beforeunload', function(){
			// reset_current_publisher_product();
		// });
	  
		// // $(window).load( function() {
		// $(document).ready(function(){
			// <#% @from_grades.each do|from_grade| %#>
				// alert("from_grade.id = " + "<#%= from_grade.id %#>");
			// <#% end %#>
		// });		

	</script>

	<script>
		
		// *****
		// html textarea - topic

		var savedRange_topic,isInFocus_topic;

 		function saveSelection_topic()
		{
		    if(window.getSelection)//non IE Browsers
		    {
		        savedRange_topic = window.getSelection().getRangeAt(0);
		    }
		    else if(document.selection)//IE
		    { 
		        savedRange_topic = document.selection.createRange();  
		    } 
		}
		
		function restoreSelection_topic()
		{
		    isInFocus_topic = true;
		    document.getElementById("textarea_topic_edit").focus();
		    if (savedRange_topic != null) {
		        if (window.getSelection)//non IE and there is already a selection
		        {
		            var s = window.getSelection();
		            if (s.rangeCount > 0) 
		                s.removeAllRanges();
		            s.addRange(savedRange_topic);
		        }
		        else if (document.createRange)//non IE and no selection
		        {
		            window.getSelection().addRange(savedRange_topic);
		        }
		        else if (document.selection)//IE
		        {
		            savedRange_topic.select();
		        }
		    }
		}
		
		//this part onwards is only needed if you want to restore selection onclick
		var isInFocus_topic = false;
		function onDivBlur_topic()
		{
		    isInFocus_topic = false;
		}
		
		function cancelEvent_topic(e)
		{
		    if (isInFocus_topic == false && savedRange_topic != null) {
		        if (e && e.preventDefault) {
		            //alert("FF");
		            e.stopPropagation(); // DOM style (return false doesn't always work in FF)
		            e.preventDefault();
		        }
		        else {
		            window.event.cancelBubble = true;//IE stopPropagation
		        }
		        restoreSelection_topic();
		        return false; // false = IE style
		    }
		}
		
		function insertTextAtCursor_topic(text) {
		    var sel, range, html;
		    if (window.getSelection) {
		        sel = window.getSelection();
		        if (sel.getRangeAt && sel.rangeCount) {
		            range = sel.getRangeAt(0);
		            range.deleteContents();
		            range.insertNode( document.createTextNode(text) );
		            range.collapse(false);
		        }
		    } else if (document.selection && document.selection.createRange) {
		        document.selection.createRange().text = text;
		    }
		}			  	

		function doGetCaretPosition (ctrl) {
			var CaretPos = 0;   // IE Support
			if (document.selection) {
				ctrl.focus ();
				var Sel = document.selection.createRange ();
				Sel.moveStart ('character', -ctrl.value.length);
				CaretPos = Sel.text.length;
			}
			// Firefox support
			else if (ctrl.selectionStart || ctrl.selectionStart == '0') {
				CaretPos = ctrl.selectionStart;
			}
			return (CaretPos);
		}
		
		
		// *****
		// story 11 topic
		
		var story_11_topic_html = null;
		
		function partialInitRenderStory11() {
			var v = $("#textarea_topic").html();
			if ( (v == "<br>") || (v == "") ) {
				$("#textarea_topic").addClass("textarea-topic-empty");
			}
			else {
				$("#textarea_topic").removeClass("textarea-topic-empty");
			}			
		}

		function partialInitRenderStory11Edit() {
			var v = $("#textarea_topic_edit").html();
			if ( (v == "<br>") || (v == "") ) {
				$("#textarea_topic_edit").addClass("textarea-topic-empty");
			}
			else {
				$("#textarea_topic_edit").removeClass("textarea-topic-empty");
			}			
		}

		function initRenderTextareaStory11() {
			$("#textarea_topic").html(story_11_topic_html);
			// partial_init_render_story_11();
			partialInitRenderStory11();
		}

	  	function showEditStory11_1() {
	  		var textarea_html = $("#textarea_topic").html();
    			$("#textarea_topic_edit").html(textarea_html);
	  			$("#textarea_topic_edit").focus();								
		}

	  	function showEditStory11() {
	  		// var textarea_html = $("#textarea_topic").html();
			// $("#open_edit_story_11, .show-story-2").fadeOut(200, function(){    			
				// $("#open_edit_story_11").addClass("hidden");
				// $("#close_edit_story_11").fadeIn(200).removeClass("hidden");
    			// $(".show-story-11").addClass("hidden");
    			// $(".edit-story-11").fadeIn(300).removeClass("hidden");    	
				// $(".btn-textarea-topic-story-2-container").removeClass("hidden");
	  			showEditStory11_1();								
    		// });
	  	}
	  	function cancelEditStory11() {
			init_render_story_11();
			hideEditStory11();	
	  	}
		function closeEditStory11() {
			$("#submit_story_11_loader").addClass("hidden");
			$("#submit_story_11_text").removeClass("hidden");
			cancelEditStory11();		
		}
		function hideEditStory11() {
	  		$(".edit-story-2").fadeOut(200, function(){
    			$(".edit-story-2").addClass("hidden");
    			$(".show-story-2").removeClass("hidden").fadeIn(300);
				$("#open_edit_story_11").removeClass("hidden").fadeIn(200);
				$("#close_edit_story_11").addClass("hidden");
			});			
		}
		
		// $(window).load( function() {
		$(document).ready(function () {				


			// *****
			// story 11 topic

			document.body.setAttribute('spellcheck', false);

			story_11_topic_html = "<%= @publisher_product_topic_topic_text.html_safe %>";
			initRenderTextareaStory11();

		    $("#textarea_topic_edit").on ('blur', function (e) {
				onDivBlur_topic();
		    });
		    $("#textarea_topic_edit").on ('mousedown', function (e) {
				return cancelEvent_topic(e);
		    });
		    $("#textarea_topic_edit").on ('click', function (e) {
				return cancelEvent_topic(e);
		    });
		    $("#textarea_topic_edit").on ('mouseup', function (e) {
				saveSelection_topic();
		    });
		    $("#textarea_topic_edit").on ('keyup', function (e) {
				saveSelection_topic();
		    });
		    $("#textarea_topic_edit").on ('focus', function (e) {
				restoreSelection_topic();
		    });
		    $("#textarea_topic_edit").on ('keydown', function (e) {
		    	if( e.keyCode == 9) {
		    		e.preventDefault();
					insertTextAtCursor_topic("\t");
		    	}
		    });
		
			
			// story 11 topic
			// *****


		});
		
				
	</script>

	<script>
		
		// *****
		// html textarea - subject

		var savedRange_lesson_plan_subject,isInFocus_lesson_plan_subject;

 		function saveSelection_lesson_plan_subject()
		{
		    if(window.getSelection)//non IE Browsers
		    {
		        savedRange_lesson_plan_subject = window.getSelection().getRangeAt(0);
		    }
		    else if(document.selection)//IE
		    { 
		        savedRange_lesson_plan_subject = document.selection.createRange();  
		    } 
		}
		
		function restoreSelection_lesson_plan_subject()
		{
		    isInFocus_lesson_plan_subject = true;
		    document.getElementById("textarea_lesson_plan_subject_edit").focus();
		    if (savedRange_lesson_plan_subject != null) {
		        if (window.getSelection)//non IE and there is already a selection
		        {
		            var s = window.getSelection();
		            if (s.rangeCount > 0) 
		                s.removeAllRanges();
		            s.addRange(savedRange_lesson_plan_subject);
		        }
		        else if (document.createRange)//non IE and no selection
		        {
		            window.getSelection().addRange(savedRange_lesson_plan_subject);
		        }
		        else if (document.selection)//IE
		        {
		            savedRange_lesson_plan_subject.select();
		        }
		    }
		}
		
		//this part onwards is only needed if you want to restore selection onclick
		var isInFocus_lesson_plan_subject = false;
		function onDivBlur_lesson_plan_subject()
		{
		    isInFocus_lesson_plan_subject = false;
		}
		
		function cancelEvent_lesson_plan_subject(e)
		{
		    if (isInFocus_lesson_plan_subject == false && savedRange_lesson_plan_subject != null) {
		        if (e && e.preventDefault) {
		            //alert("FF");
		            e.stopPropagation(); // DOM style (return false doesn't always work in FF)
		            e.preventDefault();
		        }
		        else {
		            window.event.cancelBubble = true;//IE stopPropagation
		        }
		        restoreSelection_lesson_plan_subject();
		        return false; // false = IE style
		    }
		}
		
		function insertTextAtCursor_lesson_plan_subject(text) {
		    var sel, range, html;
		    if (window.getSelection) {
		        sel = window.getSelection();
		        if (sel.getRangeAt && sel.rangeCount) {
		            range = sel.getRangeAt(0);
		            range.deleteContents();
		            range.insertNode( document.createTextNode(text) );
		            range.collapse(false);
		        }
		    } else if (document.selection && document.selection.createRange) {
		        document.selection.createRange().text = text;
		    }
		}			  	

		function doGetCaretPosition (ctrl) {
			var CaretPos = 0;   // IE Support
			if (document.selection) {
				ctrl.focus ();
				var Sel = document.selection.createRange ();
				Sel.moveStart ('character', -ctrl.value.length);
				CaretPos = Sel.text.length;
			}
			// Firefox support
			else if (ctrl.selectionStart || ctrl.selectionStart == '0') {
				CaretPos = ctrl.selectionStart;
			}
			return (CaretPos);
		}
		
		
		// *****
		// story 12 lesson_plan_subject
		
		var story_12_lesson_plan_subject_html = null;
		
		function partialInitRenderStory12() {
			var v = $("#textarea_lesson_plan_subject").html();
			if ( (v == "<br>") || (v == "") ) {
				$("#textarea_lesson_plan_subject").addClass("textarea-subject-empty");
			}
			else {
				$("#textarea_lesson_plan_subject").removeClass("textarea-subject-empty");
			}			
		}

		function partialInitRenderStory12Edit() {
			var v = $("#textarea_lesson_plan_subject_edit").html();
			if ( (v == "<br>") || (v == "") ) {
				$("#textarea_lesson_plan_subject_edit").addClass("textarea-subject-empty");
			}
			else {
				$("#textarea_lesson_plan_subject_edit").removeClass("textarea-subject-empty");
			}			
		}

		function initRenderTextareaStory12() {
			$("#textarea_lesson_plan_subject").html(story_12_lesson_plan_subject_html);
			// partial_init_render_story_12();
			partialInitRenderStory12();
		}

	  	function showEditStory12_1() {
	  		var textarea_html = $("#textarea_lesson_plan_subject").html();
    		$("#textarea_lesson_plan_subject_edit").html(textarea_html);
	  		$("#textarea_lesson_plan_subject_edit").focus();								
		}

	  	function showEditStory12() {
	  		showEditStory12_1();								
	  	}
	  	// function cancelEditStory12() {
			// init_render_story_12();
			// hideEditStory12();	
	  	// }
		// function closeEditStory12() {
			// $("#submit_story_12_loader").addClass("hidden");
			// $("#submit_story_12_text").removeClass("hidden");
			// cancelEditStory12();		
		// }
		// function hideEditStory12() {
	  		// $(".edit-story-2").fadeOut(200, function(){
    			// $(".edit-story-2").addClass("hidden");
    			// $(".show-story-2").removeClass("hidden").fadeIn(300);
				// $("#open_edit_story_12").removeClass("hidden").fadeIn(200);
				// $("#close_edit_story_12").addClass("hidden");
			// });			
		// }
		
		// $(window).load( function() {
		$(document).ready(function () {				


			// *****
			// story 12 lesson_plan_subject

			document.body.setAttribute('spellcheck', false);

			story_12_lesson_plan_subject_html = "<%= @publisher_product_subject_subject_text.html_safe %>";
			initRenderTextareaStory12();

		    $("#textarea_lesson_plan_subject_edit").on ('blur', function (e) {
				onDivBlur_lesson_plan_subject();
		    });
		    $("#textarea_lesson_plan_subject_edit").on ('mousedown', function (e) {
				return cancelEvent_lesson_plan_subject(e);
		    });
		    $("#textarea_lesson_plan_subject_edit").on ('click', function (e) {
				return cancelEvent_lesson_plan_subject(e);
		    });
		    $("#textarea_lesson_plan_subject_edit").on ('mouseup', function (e) {
				saveSelection_lesson_plan_subject();
		    });
		    $("#textarea_lesson_plan_subject_edit").on ('keyup', function (e) {
				saveSelection_lesson_plan_subject();
		    });
		    $("#textarea_lesson_plan_subject_edit").on ('focus', function (e) {
				restoreSelection_lesson_plan_subject();
		    });
		    $("#textarea_lesson_plan_subject_edit").on ('keydown', function (e) {
		    	if( e.keyCode == 9) {
		    		e.preventDefault();
					insertTextAtCursor_lesson_plan_subject("\t");
		    	}
		    });
		
			
			// story 12 lesson_plan_subject
			// *****


		});
		
				
	</script>
